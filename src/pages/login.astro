---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getUser } from '../lib/auth';

const user = await getUser(Astro.cookies);

if (user) {
  return Astro.redirect('/');
}

const error = Astro.url.searchParams.get('error');
const message = Astro.url.searchParams.get('message');
---

<BaseLayout title="Login">
  <div class="card" style="max-width: 400px; margin: 60px auto;">
    <h1 style="margin-bottom: 20px; text-align: center;">Welcome Back</h1>
    
    {error && <div class="error">{error}</div>}
    {message && <div class="success">{message}</div>}
    
    <form method="post" action="/api/auth/signin" style="display: flex; flex-direction: column; gap: 15px;">
      <div>
        <label for="email" style="display: block; margin-bottom: 5px; font-weight: 500;">Email</label>
        <input type="email" id="email" name="email" required />
      </div>
      
      <div>
        <label for="password" style="display: block; margin-bottom: 5px; font-weight: 500;">Password</label>
        <input type="password" id="password" name="password" required />
      </div>
      
      <button type="submit" class="btn">Sign In</button>
    </form>
    
    <p style="text-align: center; margin-top: 20px; color: #666;">
      Don't have an account? <a href="/signup" style="color: #4A90E2;">Sign up</a>
    </p>
  </div>
</BaseLayout>
