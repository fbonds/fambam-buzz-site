import{j as L,b as J,g as ct}from"./client-auth.DpfHvIqg.js";import{r as $}from"./index.D55ewHcJ.js";const Ke=!1,Ve="fletcher-dev-id";function dt(S,R){return R.forEach((function(P){P&&typeof P!="string"&&!Array.isArray(P)&&Object.keys(P).forEach((function(u){if(u!=="default"&&!(u in S)){var e=Object.getOwnPropertyDescriptor(P,u);Object.defineProperty(S,u,e.get?e:{enumerable:!0,get:function(){return P[u]}})}}))})),Object.freeze(S)}function Xe(S,R){return new Promise((function(P,u){let e;return ut(S).then((function(t){try{return e=t,P(new Blob([R.slice(0,2),e,R.slice(2)],{type:"image/jpeg"}))}catch(l){return u(l)}}),u)}))}const ut=S=>new Promise(((R,P)=>{const u=new FileReader;u.addEventListener("load",(({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return P("not a valid JPEG");for(l+=2;;){const o=t.getUint16(l);if(o===65498)break;const g=t.getUint16(l+2);if(o===65505&&t.getUint32(l+4)===1165519206){const y=l+10;let n;switch(t.getUint16(y)){case 18761:n=!0;break;case 19789:n=!1;break;default:return P("TIFF header contains invalid endian")}if(t.getUint16(y+2,n)!==42)return P("TIFF header contains invalid version");const i=t.getUint32(y+4,n),r=y+i+2+12*t.getUint16(y+i,n);for(let a=y+i+2;a<r;a+=12)if(t.getUint16(a,n)==274){if(t.getUint16(a+2,n)!==3)return P("Orientation data type is invalid");if(t.getUint32(a+4,n)!==1)return P("Orientation data count is invalid");t.setUint16(a+8,1,n);break}return R(e.slice(l,l+2+g))}l+=2+g}return R(new Blob)})),u.readAsArrayBuffer(S)}));var Pe={},ht={get exports(){return Pe},set exports(S){Pe=S}};(function(S){var R,P,u={};ht.exports=u,u.parse=function(e,t){for(var l=u.bin.readUshort,o=u.bin.readUint,g=0,y={},n=new Uint8Array(e),i=n.length-4;o(n,i)!=101010256;)i--;g=i,g+=4;var r=l(n,g+=4);l(n,g+=2);var a=o(n,g+=2),h=o(n,g+=4);g+=4,g=h;for(var b=0;b<r;b++){o(n,g),g+=4,g+=4,g+=4,o(n,g+=4),a=o(n,g+=4);var _=o(n,g+=4),m=l(n,g+=4),I=l(n,g+2),j=l(n,g+4);g+=6;var U=o(n,g+=8);g+=4,g+=m+I+j,u._readLocal(n,U,y,a,_,t)}return y},u._readLocal=function(e,t,l,o,g,y){var n=u.bin.readUshort,i=u.bin.readUint;i(e,t),n(e,t+=4),n(e,t+=2);var r=n(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var a=n(e,t+=8),h=n(e,t+=2);t+=2;var b=u.bin.readUTF8(e,t,a);if(t+=a,t+=h,y)l[b]={size:g,csize:o};else{var _=new Uint8Array(e.buffer,t);if(r==0)l[b]=new Uint8Array(_.buffer.slice(t,t+o));else{if(r!=8)throw"unknown compression method: "+r;var m=new Uint8Array(g);u.inflateRaw(_,m),l[b]=m}}},u.inflateRaw=function(e,t){return u.F.inflate(e,t)},u.inflate=function(e,t){return e[0],e[1],u.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},u.deflate=function(e,t){t==null&&(t={level:6});var l=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[l]=120,o[l+1]=156,l+=2,l=u.F.deflateRaw(e,o,l,t.level);var g=u.adler(e,0,e.length);return o[l+0]=g>>>24&255,o[l+1]=g>>>16&255,o[l+2]=g>>>8&255,o[l+3]=g>>>0&255,new Uint8Array(o.buffer,0,l+4)},u.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),o=u.F.deflateRaw(e,l,o,t.level);return new Uint8Array(l.buffer,0,o)},u.encode=function(e,t){t==null&&(t=!1);var l=0,o=u.bin.writeUint,g=u.bin.writeUshort,y={};for(var n in e){var i=!u._noNeed(n)&&!t,r=e[n],a=u.crc.crc(r,0,r.length);y[n]={cpr:i,usize:r.length,crc:a,file:i?u.deflateRaw(r):r}}for(var n in y)l+=y[n].file.length+30+46+2*u.bin.sizeUTF8(n);l+=22;var h=new Uint8Array(l),b=0,_=[];for(var n in y){var m=y[n];_.push(b),b=u._writeHeader(h,b,n,m,0)}var I=0,j=b;for(var n in y)m=y[n],_.push(b),b=u._writeHeader(h,b,n,m,1,_[I++]);var U=b-j;return o(h,b,101010256),b+=4,g(h,b+=4,I),g(h,b+=2,I),o(h,b+=2,U),o(h,b+=4,j),b+=4,b+=2,h.buffer},u._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},u._writeHeader=function(e,t,l,o,g,y){var n=u.bin.writeUint,i=u.bin.writeUshort,r=o.file;return n(e,t,g==0?67324752:33639248),t+=4,g==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,o.cpr?8:0),n(e,t+=2,0),n(e,t+=4,o.crc),n(e,t+=4,r.length),n(e,t+=4,o.usize),i(e,t+=4,u.bin.sizeUTF8(l)),i(e,t+=2,0),t+=2,g==1&&(t+=2,t+=2,n(e,t+=6,y),t+=4),t+=u.bin.writeUTF8(e,t,l),g==0&&(e.set(r,t),t+=r.length),t},u.crc={table:(function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,o=0;o<8;o++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e})(),update:function(e,t,l,o){for(var g=0;g<o;g++)e=u.crc.table[255&(e^t[l+g])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^u.crc.update(4294967295,e,t,l)}},u.adler=function(e,t,l){for(var o=1,g=0,y=t,n=t+l;y<n;){for(var i=Math.min(y+5552,n);y<i;)g+=o+=e[y++];o%=65521,g%=65521}return g<<16|o},u.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var o="",g=0;g<l;g++)o+=String.fromCharCode(e[t+g]);return o},writeASCII:function(e,t,l){for(var o=0;o<l.length;o++)e[t+o]=l.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var o,g="",y=0;y<l;y++)g+="%"+u.bin.pad(e[t+y].toString(16));try{o=decodeURIComponent(g)}catch{return u.bin.readASCII(e,t,l)}return o},writeUTF8:function(e,t,l){for(var o=l.length,g=0,y=0;y<o;y++){var n=l.charCodeAt(y);if((4294967168&n)==0)e[t+g]=n,g++;else if((4294965248&n)==0)e[t+g]=192|n>>6,e[t+g+1]=128|n>>0&63,g+=2;else if((4294901760&n)==0)e[t+g]=224|n>>12,e[t+g+1]=128|n>>6&63,e[t+g+2]=128|n>>0&63,g+=3;else{if((4292870144&n)!=0)throw"e";e[t+g]=240|n>>18,e[t+g+1]=128|n>>12&63,e[t+g+2]=128|n>>6&63,e[t+g+3]=128|n>>0&63,g+=4}}return g},sizeUTF8:function(e){for(var t=e.length,l=0,o=0;o<t;o++){var g=e.charCodeAt(o);if((4294967168&g)==0)l++;else if((4294965248&g)==0)l+=2;else if((4294901760&g)==0)l+=3;else{if((4292870144&g)!=0)throw"e";l+=4}}return l}},u.F={},u.F.deflateRaw=function(e,t,l,o){var g=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],y=u.F.U,n=u.F._goodIndex;u.F._hash;var i=u.F._putsE,r=0,a=l<<3,h=0,b=e.length;if(o==0){for(;r<b;)i(t,a,r+(A=Math.min(65535,b-r))==b?1:0),a=u.F._copyExact(e,r,A,t,a+8),r+=A;return a>>>3}var _=y.lits,m=y.strt,I=y.prev,j=0,U=0,T=0,p=0,k=0,c=0;for(b>2&&(m[c=u.F._hash(e,0)]=0),r=0;r<b;r++){if(k=c,r+1<b-2){c=u.F._hash(e,r+1);var f=r+1&32767;I[f]=m[c],m[c]=f}if(h<=r){(j>14e3||U>26697)&&b-r>100&&(h<r&&(_[j]=r-h,j+=2,h=r),a=u.F._writeBlock(r==b-1||h==b?1:0,_,j,p,e,T,r-T,t,a),j=U=p=0,T=r);var x=0;r<b-2&&(x=u.F._bestMatch(e,r,I,k,Math.min(g[2],b-r),g[3]));var A=x>>>16,w=65535&x;if(x!=0){w=65535&x;var C=n(A=x>>>16,y.of0);y.lhst[257+C]++;var v=n(w,y.df0);y.dhst[v]++,p+=y.exb[C]+y.dxb[v],_[j]=A<<23|r-h,_[j+1]=w<<16|C<<8|v,j+=2,h=r+A}else y.lhst[e[r]]++;U++}}for(T==r&&e.length!=0||(h<r&&(_[j]=r-h,j+=2,h=r),a=u.F._writeBlock(1,_,j,p,e,T,r-T,t,a),j=0,U=0,j=U=p=0,T=r);(7&a)!=0;)a++;return a>>>3},u.F._bestMatch=function(e,t,l,o,g,y){var n=32767&t,i=l[n],r=n-i+32768&32767;if(i==n||o!=u.F._hash(e,t-r))return 0;for(var a=0,h=0,b=Math.min(32767,t);r<=b&&--y!=0&&i!=n;){if(a==0||e[t+a]==e[t+a-r]){var _=u.F._howLong(e,t,r);if(_>a){if(h=r,(a=_)>=g)break;r+2<_&&(_=r+2);for(var m=0,I=0;I<_-2;I++){var j=t-r+I+32768&32767,U=j-l[j]+32768&32767;U>m&&(m=U,i=j)}}}r+=(n=i)-(i=l[n])+32768&32767}return a<<16|h},u.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var o=t,g=Math.min(e.length,t+258);for(t+=3;t<g&&e[t]==e[t-l];)t++;return t-o},u.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},u.saved=0,u.F._writeBlock=function(e,t,l,o,g,y,n,i,r){var a,h,b,_,m,I,j,U,T,p=u.F.U,k=u.F._putsF,c=u.F._putsE;p.lhst[256]++,h=(a=u.F.getTrees())[0],b=a[1],_=a[2],m=a[3],I=a[4],j=a[5],U=a[6],T=a[7];var f=32+((r+3&7)==0?0:8-(r+3&7))+(n<<3),x=o+u.F.contSize(p.fltree,p.lhst)+u.F.contSize(p.fdtree,p.dhst),A=o+u.F.contSize(p.ltree,p.lhst)+u.F.contSize(p.dtree,p.dhst);A+=14+3*j+u.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var w=0;w<286;w++)p.lhst[w]=0;for(w=0;w<30;w++)p.dhst[w]=0;for(w=0;w<19;w++)p.ihst[w]=0;var C=f<x&&f<A?0:x<A?1:2;if(k(i,r,e),k(i,r+1,C),r+=3,C==0){for(;(7&r)!=0;)r++;r=u.F._copyExact(g,y,n,i,r)}else{var v,F;if(C==1&&(v=p.fltree,F=p.fdtree),C==2){u.F.makeCodes(p.ltree,h),u.F.revCodes(p.ltree,h),u.F.makeCodes(p.dtree,b),u.F.revCodes(p.dtree,b),u.F.makeCodes(p.itree,_),u.F.revCodes(p.itree,_),v=p.ltree,F=p.dtree,c(i,r,m-257),c(i,r+=5,I-1),c(i,r+=5,j-4),r+=4;for(var d=0;d<j;d++)c(i,r+3*d,p.itree[1+(p.ordr[d]<<1)]);r+=3*j,r=u.F._codeTiny(U,p.itree,i,r),r=u.F._codeTiny(T,p.itree,i,r)}for(var s=y,D=0;D<l;D+=2){for(var E=t[D],O=E>>>23,W=s+(8388607&E);s<W;)r=u.F._writeLit(g[s++],v,i,r);if(O!=0){var H=t[D+1],N=H>>16,z=H>>8&255,M=255&H;c(i,r=u.F._writeLit(257+z,v,i,r),O-p.of0[z]),r+=p.exb[z],k(i,r=u.F._writeLit(M,F,i,r),N-p.df0[M]),r+=p.dxb[M],s+=O}}r=u.F._writeLit(256,v,i,r)}return r},u.F._copyExact=function(e,t,l,o,g){var y=g>>>3;return o[y]=l,o[y+1]=l>>>8,o[y+2]=255-o[y],o[y+3]=255-o[y+1],y+=4,o.set(new Uint8Array(e.buffer,t,l),y),g+(l+4<<3)},u.F.getTrees=function(){for(var e=u.F.U,t=u.F._hufTree(e.lhst,e.ltree,15),l=u.F._hufTree(e.dhst,e.dtree,15),o=[],g=u.F._lenCodes(e.ltree,o),y=[],n=u.F._lenCodes(e.dtree,y),i=0;i<o.length;i+=2)e.ihst[o[i]]++;for(i=0;i<y.length;i+=2)e.ihst[y[i]]++;for(var r=u.F._hufTree(e.ihst,e.itree,7),a=19;a>4&&e.itree[1+(e.ordr[a-1]<<1)]==0;)a--;return[t,l,r,g,n,a,o,y]},u.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},u.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},u.F.contSize=function(e,t){for(var l=0,o=0;o<t.length;o++)l+=t[o]*e[1+(o<<1)];return l},u.F._codeTiny=function(e,t,l,o){for(var g=0;g<e.length;g+=2){var y=e[g],n=e[g+1];o=u.F._writeLit(y,t,l,o);var i=y==16?2:y==17?3:7;y>15&&(u.F._putsE(l,o,n,i),o+=i)}return o},u.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var o=0;o<l;o+=2){var g=e[o+1],y=o+3<l?e[o+3]:-1,n=o+5<l?e[o+5]:-1,i=o==0?-1:e[o-1];if(g==0&&y==g&&n==g){for(var r=o+5;r+2<l&&e[r+2]==g;)r+=2;(a=Math.min(r+1-o>>>1,138))<11?t.push(17,a-3):t.push(18,a-11),o+=2*a-2}else if(g==i&&y==g&&n==g){for(r=o+5;r+2<l&&e[r+2]==g;)r+=2;var a=Math.min(r+1-o>>>1,6);t.push(16,a-3),o+=2*a-2}else t.push(g,0)}return l>>>1},u.F._hufTree=function(e,t,l){var o=[],g=e.length,y=t.length,n=0;for(n=0;n<y;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<g;n++)e[n]!=0&&o.push({lit:n,f:e[n]});var i=o.length,r=o.slice(0);if(i==0)return 0;if(i==1){var a=o[0].lit;return r=a==0?1:0,t[1+(a<<1)]=1,t[1+(r<<1)]=1,1}o.sort((function(U,T){return U.f-T.f}));var h=o[0],b=o[1],_=0,m=1,I=2;for(o[0]={lit:-1,f:h.f+b.f,l:h,r:b,d:0};m!=i-1;)h=_!=m&&(I==i||o[_].f<o[I].f)?o[_++]:o[I++],b=_!=m&&(I==i||o[_].f<o[I].f)?o[_++]:o[I++],o[m++]={lit:-1,f:h.f+b.f,l:h,r:b};var j=u.F.setDepth(o[m-1],0);for(j>l&&(u.F.restrictDepth(r,l,j),j=l),n=0;n<i;n++)t[1+(r[n].lit<<1)]=r[n].d;return j},u.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(u.F.setDepth(e.l,t+1),u.F.setDepth(e.r,t+1))},u.F.restrictDepth=function(e,t,l){var o=0,g=1<<l-t,y=0;for(e.sort((function(i,r){return r.d==i.d?i.f-r.f:r.d-i.d})),o=0;o<e.length&&e[o].d>t;o++){var n=e[o].d;e[o].d=t,y+=g-(1<<l-n)}for(y>>>=l-t;y>0;)(n=e[o].d)<t?(e[o].d++,y-=1<<t-n-1):o++;for(;o>=0;o--)e[o].d==t&&y<0&&(e[o].d--,y++);y!=0&&console.log("debt left")},u.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},u.F._writeLit=function(e,t,l,o){return u.F._putsF(l,o,t[e<<1]),o+t[1+(e<<1)]},u.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var o=u.F,g=o._bitsF,y=o._bitsE,n=o._decodeTiny,i=o.makeCodes,r=o.codes2map,a=o._get17,h=o.U,b=t==null;b&&(t=new l(e.length>>>2<<3));for(var _,m,I=0,j=0,U=0,T=0,p=0,k=0,c=0,f=0,x=0;I==0;)if(I=g(e,x,1),j=g(e,x+1,2),x+=3,j!=0){if(b&&(t=u.F._check(t,f+(1<<17))),j==1&&(_=h.flmap,m=h.fdmap,k=511,c=31),j==2){U=y(e,x,5)+257,T=y(e,x+5,5)+1,p=y(e,x+10,4)+4,x+=14;for(var A=0;A<38;A+=2)h.itree[A]=0,h.itree[A+1]=0;var w=1;for(A=0;A<p;A++){var C=y(e,x+3*A,3);h.itree[1+(h.ordr[A]<<1)]=C,C>w&&(w=C)}x+=3*p,i(h.itree,w),r(h.itree,w,h.imap),_=h.lmap,m=h.dmap,x=n(h.imap,(1<<w)-1,U+T,e,x,h.ttree);var v=o._copyOut(h.ttree,0,U,h.ltree);k=(1<<v)-1;var F=o._copyOut(h.ttree,U,T,h.dtree);c=(1<<F)-1,i(h.ltree,v),r(h.ltree,v,_),i(h.dtree,F),r(h.dtree,F,m)}for(;;){var d=_[a(e,x)&k];x+=15&d;var s=d>>>4;if(!(s>>>8))t[f++]=s;else{if(s==256)break;var D=f+s-254;if(s>264){var E=h.ldef[s-257];D=f+(E>>>3)+y(e,x,7&E),x+=7&E}var O=m[a(e,x)&c];x+=15&O;var W=O>>>4,H=h.ddef[W],N=(H>>>4)+g(e,x,15&H);for(x+=15&H,b&&(t=u.F._check(t,f+(1<<17)));f<D;)t[f]=t[f++-N],t[f]=t[f++-N],t[f]=t[f++-N],t[f]=t[f++-N];f=D}}}else{(7&x)!=0&&(x+=8-(7&x));var z=4+(x>>>3),M=e[z-4]|e[z-3]<<8;b&&(t=u.F._check(t,f+M)),t.set(new l(e.buffer,e.byteOffset+z,M),f),x=z+M<<3,f+=M}return t.length==f?t:t.slice(0,f)},u.F._check=function(e,t){var l=e.length;if(t<=l)return e;var o=new Uint8Array(Math.max(l<<1,t));return o.set(e,0),o},u.F._decodeTiny=function(e,t,l,o,g,y){for(var n=u.F._bitsE,i=u.F._get17,r=0;r<l;){var a=e[i(o,g)&t];g+=15&a;var h=a>>>4;if(h<=15)y[r]=h,r++;else{var b=0,_=0;h==16?(_=3+n(o,g,2),g+=2,b=y[r-1]):h==17?(_=3+n(o,g,3),g+=3):h==18&&(_=11+n(o,g,7),g+=7);for(var m=r+_;r<m;)y[r]=b,r++}}return g},u.F._copyOut=function(e,t,l,o){for(var g=0,y=0,n=o.length>>>1;y<l;){var i=e[y+t];o[y<<1]=0,o[1+(y<<1)]=i,i>g&&(g=i),y++}for(;y<n;)o[y<<1]=0,o[1+(y<<1)]=0,y++;return g},u.F.makeCodes=function(e,t){for(var l,o,g,y,n=u.F.U,i=e.length,r=n.bl_count,a=0;a<=t;a++)r[a]=0;for(a=1;a<i;a+=2)r[e[a]]++;var h=n.next_code;for(l=0,r[0]=0,o=1;o<=t;o++)l=l+r[o-1]<<1,h[o]=l;for(g=0;g<i;g+=2)(y=e[g+1])!=0&&(e[g]=h[y],h[y]++)},u.F.codes2map=function(e,t,l){for(var o=e.length,g=u.F.U.rev15,y=0;y<o;y+=2)if(e[y+1]!=0)for(var n=y>>1,i=e[y+1],r=n<<4|i,a=t-i,h=e[y]<<a,b=h+(1<<a);h!=b;)l[g[h]>>>15-t]=r,h++},u.F.revCodes=function(e,t){for(var l=u.F.U.rev15,o=15-t,g=0;g<e.length;g+=2){var y=e[g]<<t-e[g+1];e[g]=l[y]>>>o}},u.F._putsE=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8},u.F._putsF=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8,e[o+2]|=l>>>16},u.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},u.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},u.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},u.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},u.F.U=(R=Uint16Array,P=Uint32Array,{next_code:new R(16),bl_count:new R(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new R(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new P(32),flmap:new R(512),fltree:[],fdmap:new R(32),fdtree:[],lmap:new R(32768),ltree:[],ttree:[],dmap:new R(32768),dtree:[],imap:new R(512),itree:[],rev15:new R(32768),lhst:new P(286),dhst:new P(30),ihst:new P(19),lits:new P(15e3),strt:new R(65536),prev:new R(32768)}),(function(){for(var e=u.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function o(g,y,n){for(;y--!=0;)g.push(0,n)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),u.F.makeCodes(e.fltree,9),u.F.codes2map(e.fltree,9,e.flmap),u.F.revCodes(e.fltree,9),o(e.fdtree,32,5),u.F.makeCodes(e.fdtree,5),u.F.codes2map(e.fdtree,5,e.fdmap),u.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)})()})();var pt=dt({__proto__:null,default:Pe},[Pe]);const ge=(function(){var S={nextZero(n,i){for(;n[i]!=0;)i++;return i},readUshort:(n,i)=>n[i]<<8|n[i+1],writeUshort(n,i,r){n[i]=r>>8&255,n[i+1]=255&r},readUint:(n,i)=>16777216*n[i]+(n[i+1]<<16|n[i+2]<<8|n[i+3]),writeUint(n,i,r){n[i]=r>>24&255,n[i+1]=r>>16&255,n[i+2]=r>>8&255,n[i+3]=255&r},readASCII(n,i,r){let a="";for(let h=0;h<r;h++)a+=String.fromCharCode(n[i+h]);return a},writeASCII(n,i,r){for(let a=0;a<r.length;a++)n[i+a]=r.charCodeAt(a)},readBytes(n,i,r){const a=[];for(let h=0;h<r;h++)a.push(n[i+h]);return a},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,i,r){let a,h="";for(let b=0;b<r;b++)h+=`%${S.pad(n[i+b].toString(16))}`;try{a=decodeURIComponent(h)}catch{return S.readASCII(n,i,r)}return a}};function R(n,i,r,a){const h=i*r,b=t(a),_=Math.ceil(i*b/8),m=new Uint8Array(4*h),I=new Uint32Array(m.buffer),{ctype:j}=a,{depth:U}=a,T=S.readUshort;if(j==6){const E=h<<2;if(U==8)for(var p=0;p<E;p+=4)m[p]=n[p],m[p+1]=n[p+1],m[p+2]=n[p+2],m[p+3]=n[p+3];if(U==16)for(p=0;p<E;p++)m[p]=n[p<<1]}else if(j==2){const E=a.tabs.tRNS;if(E==null){if(U==8)for(p=0;p<h;p++){var k=3*p;I[p]=255<<24|n[k+2]<<16|n[k+1]<<8|n[k]}if(U==16)for(p=0;p<h;p++)k=6*p,I[p]=255<<24|n[k+4]<<16|n[k+2]<<8|n[k]}else{var c=E[0];const O=E[1],W=E[2];if(U==8)for(p=0;p<h;p++){var f=p<<2;k=3*p,I[p]=255<<24|n[k+2]<<16|n[k+1]<<8|n[k],n[k]==c&&n[k+1]==O&&n[k+2]==W&&(m[f+3]=0)}if(U==16)for(p=0;p<h;p++)f=p<<2,k=6*p,I[p]=255<<24|n[k+4]<<16|n[k+2]<<8|n[k],T(n,k)==c&&T(n,k+2)==O&&T(n,k+4)==W&&(m[f+3]=0)}}else if(j==3){const E=a.tabs.PLTE,O=a.tabs.tRNS,W=O?O.length:0;if(U==1)for(var x=0;x<r;x++){var A=x*_,w=x*i;for(p=0;p<i;p++){f=w+p<<2;var C=3*(v=n[A+(p>>3)]>>7-((7&p)<<0)&1);m[f]=E[C],m[f+1]=E[C+1],m[f+2]=E[C+2],m[f+3]=v<W?O[v]:255}}if(U==2)for(x=0;x<r;x++)for(A=x*_,w=x*i,p=0;p<i;p++)f=w+p<<2,C=3*(v=n[A+(p>>2)]>>6-((3&p)<<1)&3),m[f]=E[C],m[f+1]=E[C+1],m[f+2]=E[C+2],m[f+3]=v<W?O[v]:255;if(U==4)for(x=0;x<r;x++)for(A=x*_,w=x*i,p=0;p<i;p++)f=w+p<<2,C=3*(v=n[A+(p>>1)]>>4-((1&p)<<2)&15),m[f]=E[C],m[f+1]=E[C+1],m[f+2]=E[C+2],m[f+3]=v<W?O[v]:255;if(U==8)for(p=0;p<h;p++){var v;f=p<<2,C=3*(v=n[p]),m[f]=E[C],m[f+1]=E[C+1],m[f+2]=E[C+2],m[f+3]=v<W?O[v]:255}}else if(j==4){if(U==8)for(p=0;p<h;p++){f=p<<2;var F=n[d=p<<1];m[f]=F,m[f+1]=F,m[f+2]=F,m[f+3]=n[d+1]}if(U==16)for(p=0;p<h;p++){var d;f=p<<2,F=n[d=p<<2],m[f]=F,m[f+1]=F,m[f+2]=F,m[f+3]=n[d+2]}}else if(j==0)for(c=a.tabs.tRNS?a.tabs.tRNS:-1,x=0;x<r;x++){const E=x*_,O=x*i;if(U==1)for(var s=0;s<i;s++){var D=(F=255*(n[E+(s>>>3)]>>>7-(7&s)&1))==255*c?0:255;I[O+s]=D<<24|F<<16|F<<8|F}else if(U==2)for(s=0;s<i;s++)D=(F=85*(n[E+(s>>>2)]>>>6-((3&s)<<1)&3))==85*c?0:255,I[O+s]=D<<24|F<<16|F<<8|F;else if(U==4)for(s=0;s<i;s++)D=(F=17*(n[E+(s>>>1)]>>>4-((1&s)<<2)&15))==17*c?0:255,I[O+s]=D<<24|F<<16|F<<8|F;else if(U==8)for(s=0;s<i;s++)D=(F=n[E+s])==c?0:255,I[O+s]=D<<24|F<<16|F<<8|F;else if(U==16)for(s=0;s<i;s++)F=n[E+(s<<1)],D=T(n,E+(s<<1))==c?0:255,I[O+s]=D<<24|F<<16|F<<8|F}return m}function P(n,i,r,a){const h=t(n),b=Math.ceil(r*h/8),_=new Uint8Array((b+1+n.interlace)*a);return i=n.tabs.CgBI?e(i,_):u(i,_),n.interlace==0?i=l(i,n,0,r,a):n.interlace==1&&(i=(function(I,j){const U=j.width,T=j.height,p=t(j),k=p>>3,c=Math.ceil(U*p/8),f=new Uint8Array(T*c);let x=0;const A=[0,0,4,0,2,0,1],w=[0,4,0,2,0,1,0],C=[8,8,8,4,4,2,2],v=[8,8,4,4,2,2,1];let F=0;for(;F<7;){const s=C[F],D=v[F];let E=0,O=0,W=A[F];for(;W<T;)W+=s,O++;let H=w[F];for(;H<U;)H+=D,E++;const N=Math.ceil(E*p/8);l(I,j,x,E,O);let z=0,M=A[F];for(;M<T;){let B=w[F],Z=x+z*N<<3;for(;B<U;){var d;if(p==1&&(d=(d=I[Z>>3])>>7-(7&Z)&1,f[M*c+(B>>3)]|=d<<7-((7&B)<<0)),p==2&&(d=(d=I[Z>>3])>>6-(7&Z)&3,f[M*c+(B>>2)]|=d<<6-((3&B)<<1)),p==4&&(d=(d=I[Z>>3])>>4-(7&Z)&15,f[M*c+(B>>1)]|=d<<4-((1&B)<<2)),p>=8){const q=M*c+B*k;for(let Q=0;Q<k;Q++)f[q+Q]=I[(Z>>3)+Q]}Z+=p,B+=D}z++,M+=s}E*O!=0&&(x+=O*(1+N)),F+=1}return f})(i,n)),i}function u(n,i){return e(new Uint8Array(n.buffer,2,n.length-6),i)}var e=(function(){const n={H:{}};return n.H.N=function(i,r){const a=Uint8Array;let h,b,_=0,m=0,I=0,j=0,U=0,T=0,p=0,k=0,c=0;if(i[0]==3&&i[1]==0)return r||new a(0);const f=n.H,x=f.b,A=f.e,w=f.R,C=f.n,v=f.A,F=f.Z,d=f.m,s=r==null;for(s&&(r=new a(i.length>>>2<<5));_==0;)if(_=x(i,c,1),m=x(i,c+1,2),c+=3,m!=0){if(s&&(r=n.H.W(r,k+(1<<17))),m==1&&(h=d.J,b=d.h,T=511,p=31),m==2){I=A(i,c,5)+257,j=A(i,c+5,5)+1,U=A(i,c+10,4)+4,c+=14;let E=1;for(var D=0;D<38;D+=2)d.Q[D]=0,d.Q[D+1]=0;for(D=0;D<U;D++){const H=A(i,c+3*D,3);d.Q[1+(d.X[D]<<1)]=H,H>E&&(E=H)}c+=3*U,C(d.Q,E),v(d.Q,E,d.u),h=d.w,b=d.d,c=w(d.u,(1<<E)-1,I+j,i,c,d.v);const O=f.V(d.v,0,I,d.C);T=(1<<O)-1;const W=f.V(d.v,I,j,d.D);p=(1<<W)-1,C(d.C,O),v(d.C,O,h),C(d.D,W),v(d.D,W,b)}for(;;){const E=h[F(i,c)&T];c+=15&E;const O=E>>>4;if(!(O>>>8))r[k++]=O;else{if(O==256)break;{let W=k+O-254;if(O>264){const B=d.q[O-257];W=k+(B>>>3)+A(i,c,7&B),c+=7&B}const H=b[F(i,c)&p];c+=15&H;const N=H>>>4,z=d.c[N],M=(z>>>4)+x(i,c,15&z);for(c+=15&z;k<W;)r[k]=r[k++-M],r[k]=r[k++-M],r[k]=r[k++-M],r[k]=r[k++-M];k=W}}}}else{(7&c)!=0&&(c+=8-(7&c));const E=4+(c>>>3),O=i[E-4]|i[E-3]<<8;s&&(r=n.H.W(r,k+O)),r.set(new a(i.buffer,i.byteOffset+E,O),k),c=E+O<<3,k+=O}return r.length==k?r:r.slice(0,k)},n.H.W=function(i,r){const a=i.length;if(r<=a)return i;const h=new Uint8Array(a<<1);return h.set(i,0),h},n.H.R=function(i,r,a,h,b,_){const m=n.H.e,I=n.H.Z;let j=0;for(;j<a;){const U=i[I(h,b)&r];b+=15&U;const T=U>>>4;if(T<=15)_[j]=T,j++;else{let p=0,k=0;T==16?(k=3+m(h,b,2),b+=2,p=_[j-1]):T==17?(k=3+m(h,b,3),b+=3):T==18&&(k=11+m(h,b,7),b+=7);const c=j+k;for(;j<c;)_[j]=p,j++}}return b},n.H.V=function(i,r,a,h){let b=0,_=0;const m=h.length>>>1;for(;_<a;){const I=i[_+r];h[_<<1]=0,h[1+(_<<1)]=I,I>b&&(b=I),_++}for(;_<m;)h[_<<1]=0,h[1+(_<<1)]=0,_++;return b},n.H.n=function(i,r){const a=n.H.m,h=i.length;let b,_,m,I;const j=a.j;for(var U=0;U<=r;U++)j[U]=0;for(U=1;U<h;U+=2)j[i[U]]++;const T=a.K;for(b=0,j[0]=0,_=1;_<=r;_++)b=b+j[_-1]<<1,T[_]=b;for(m=0;m<h;m+=2)I=i[m+1],I!=0&&(i[m]=T[I],T[I]++)},n.H.A=function(i,r,a){const h=i.length,b=n.H.m.r;for(let _=0;_<h;_+=2)if(i[_+1]!=0){const m=_>>1,I=i[_+1],j=m<<4|I,U=r-I;let T=i[_]<<U;const p=T+(1<<U);for(;T!=p;)a[b[T]>>>15-r]=j,T++}},n.H.l=function(i,r){const a=n.H.m.r,h=15-r;for(let b=0;b<i.length;b+=2){const _=i[b]<<r-i[b+1];i[b]=a[_]>>>h}},n.H.M=function(i,r,a){a<<=7&r;const h=r>>>3;i[h]|=a,i[h+1]|=a>>>8},n.H.I=function(i,r,a){a<<=7&r;const h=r>>>3;i[h]|=a,i[h+1]|=a>>>8,i[h+2]|=a>>>16},n.H.e=function(i,r,a){return(i[r>>>3]|i[1+(r>>>3)]<<8)>>>(7&r)&(1<<a)-1},n.H.b=function(i,r,a){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)&(1<<a)-1},n.H.Z=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16|i[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=(function(){const i=Uint16Array,r=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=n.H.m;for(var r=0;r<32768;r++){let h=r;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[r]=(h>>>16|h<<16)>>>17}function a(h,b,_){for(;b--!=0;)h.push(0,_)}for(r=0;r<32;r++)i.q[r]=i.S[r]<<3|i.T[r],i.c[r]=i.p[r]<<4|i.z[r];a(i._,144,8),a(i._,112,9),a(i._,24,7),a(i._,8,8),n.H.n(i._,9),n.H.A(i._,9,i.J),n.H.l(i._,9),a(i.$,32,5),n.H.n(i.$,5),n.H.A(i.$,5,i.h),n.H.l(i.$,5),a(i.Q,19,0),a(i.C,286,0),a(i.D,30,0),a(i.v,320,0)})(),n.H.N})();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function l(n,i,r,a,h){let b=t(i);const _=Math.ceil(a*b/8);let m,I;b=Math.ceil(b/8);let j=n[r],U=0;if(j>1&&(n[r]=[0,0,1][j-2]),j==3)for(U=b;U<_;U++)n[U+1]=n[U+1]+(n[U+1-b]>>>1)&255;for(let T=0;T<h;T++)if(m=r+T*_,I=m+T+1,j=n[I-1],U=0,j==0)for(;U<_;U++)n[m+U]=n[I+U];else if(j==1){for(;U<b;U++)n[m+U]=n[I+U];for(;U<_;U++)n[m+U]=n[I+U]+n[m+U-b]}else if(j==2)for(;U<_;U++)n[m+U]=n[I+U]+n[m+U-_];else if(j==3){for(;U<b;U++)n[m+U]=n[I+U]+(n[m+U-_]>>>1);for(;U<_;U++)n[m+U]=n[I+U]+(n[m+U-_]+n[m+U-b]>>>1)}else{for(;U<b;U++)n[m+U]=n[I+U]+o(0,n[m+U-_],0);for(;U<_;U++)n[m+U]=n[I+U]+o(n[m+U-b],n[m+U-_],n[m+U-b-_])}return n}function o(n,i,r){const a=n+i-r,h=a-n,b=a-i,_=a-r;return h*h<=b*b&&h*h<=_*_?n:b*b<=_*_?i:r}function g(n,i,r){r.width=S.readUint(n,i),i+=4,r.height=S.readUint(n,i),i+=4,r.depth=n[i],i++,r.ctype=n[i],i++,r.compress=n[i],i++,r.filter=n[i],i++,r.interlace=n[i],i++}function y(n,i,r,a,h,b,_,m,I){const j=Math.min(i,h),U=Math.min(r,b);let T=0,p=0;for(let F=0;F<U;F++)for(let d=0;d<j;d++)if(_>=0&&m>=0?(T=F*i+d<<2,p=(m+F)*h+_+d<<2):(T=(-m+F)*i-_+d<<2,p=F*h+d<<2),I==0)a[p]=n[T],a[p+1]=n[T+1],a[p+2]=n[T+2],a[p+3]=n[T+3];else if(I==1){var k=n[T+3]*.00392156862745098,c=n[T]*k,f=n[T+1]*k,x=n[T+2]*k,A=a[p+3]*(1/255),w=a[p]*A,C=a[p+1]*A,v=a[p+2]*A;const s=1-k,D=k+A*s,E=D==0?0:1/D;a[p+3]=255*D,a[p+0]=(c+w*s)*E,a[p+1]=(f+C*s)*E,a[p+2]=(x+v*s)*E}else if(I==2)k=n[T+3],c=n[T],f=n[T+1],x=n[T+2],A=a[p+3],w=a[p],C=a[p+1],v=a[p+2],k==A&&c==w&&f==C&&x==v?(a[p]=0,a[p+1]=0,a[p+2]=0,a[p+3]=0):(a[p]=c,a[p+1]=f,a[p+2]=x,a[p+3]=k);else if(I==3){if(k=n[T+3],c=n[T],f=n[T+1],x=n[T+2],A=a[p+3],w=a[p],C=a[p+1],v=a[p+2],k==A&&c==w&&f==C&&x==v)continue;if(k<220&&A>20)return!1}return!0}return{decode:function(i){const r=new Uint8Array(i);let a=8;const h=S,b=h.readUshort,_=h.readUint,m={tabs:{},frames:[]},I=new Uint8Array(r.length);let j,U=0,T=0;const p=[137,80,78,71,13,10,26,10];for(var k=0;k<8;k++)if(r[k]!=p[k])throw"The input is not a PNG file!";for(;a<r.length;){const F=h.readUint(r,a);a+=4;const d=h.readASCII(r,a,4);if(a+=4,d=="IHDR")g(r,a,m);else if(d=="iCCP"){for(var c=a;r[c]!=0;)c++;h.readASCII(r,a,c-a),r[c+1];const s=r.slice(c+2,a+F);let D=null;try{D=u(s)}catch{D=e(s)}m.tabs[d]=D}else if(d=="CgBI")m.tabs[d]=r.slice(a,a+4);else if(d=="IDAT"){for(k=0;k<F;k++)I[U+k]=r[a+k];U+=F}else if(d=="acTL")m.tabs[d]={num_frames:_(r,a),num_plays:_(r,a+4)},j=new Uint8Array(r.length);else if(d=="fcTL"){T!=0&&((v=m.frames[m.frames.length-1]).data=P(m,j.slice(0,T),v.rect.width,v.rect.height),T=0);const s={x:_(r,a+12),y:_(r,a+16),width:_(r,a+4),height:_(r,a+8)};let D=b(r,a+22);D=b(r,a+20)/(D==0?100:D);const E={rect:s,delay:Math.round(1e3*D),dispose:r[a+24],blend:r[a+25]};m.frames.push(E)}else if(d=="fdAT"){for(k=0;k<F-4;k++)j[T+k]=r[a+k+4];T+=F-4}else if(d=="pHYs")m.tabs[d]=[h.readUint(r,a),h.readUint(r,a+4),r[a+8]];else if(d=="cHRM")for(m.tabs[d]=[],k=0;k<8;k++)m.tabs[d].push(h.readUint(r,a+4*k));else if(d=="tEXt"||d=="zTXt"){m.tabs[d]==null&&(m.tabs[d]={});var f=h.nextZero(r,a),x=h.readASCII(r,a,f-a),A=a+F-f-1;if(d=="tEXt")C=h.readASCII(r,f+1,A);else{var w=u(r.slice(f+2,f+2+A));C=h.readUTF8(w,0,w.length)}m.tabs[d][x]=C}else if(d=="iTXt"){m.tabs[d]==null&&(m.tabs[d]={}),f=0,c=a,f=h.nextZero(r,c),x=h.readASCII(r,c,f-c);const s=r[c=f+1];var C;r[c+1],c+=2,f=h.nextZero(r,c),h.readASCII(r,c,f-c),c=f+1,f=h.nextZero(r,c),h.readUTF8(r,c,f-c),A=F-((c=f+1)-a),s==0?C=h.readUTF8(r,c,A):(w=u(r.slice(c,c+A)),C=h.readUTF8(w,0,w.length)),m.tabs[d][x]=C}else if(d=="PLTE")m.tabs[d]=h.readBytes(r,a,F);else if(d=="hIST"){const s=m.tabs.PLTE.length/3;for(m.tabs[d]=[],k=0;k<s;k++)m.tabs[d].push(b(r,a+2*k))}else if(d=="tRNS")m.ctype==3?m.tabs[d]=h.readBytes(r,a,F):m.ctype==0?m.tabs[d]=b(r,a):m.ctype==2&&(m.tabs[d]=[b(r,a),b(r,a+2),b(r,a+4)]);else if(d=="gAMA")m.tabs[d]=h.readUint(r,a)/1e5;else if(d=="sRGB")m.tabs[d]=r[a];else if(d=="bKGD")m.ctype==0||m.ctype==4?m.tabs[d]=[b(r,a)]:m.ctype==2||m.ctype==6?m.tabs[d]=[b(r,a),b(r,a+2),b(r,a+4)]:m.ctype==3&&(m.tabs[d]=r[a]);else if(d=="IEND")break;a+=F,h.readUint(r,a),a+=4}var v;return T!=0&&((v=m.frames[m.frames.length-1]).data=P(m,j.slice(0,T),v.rect.width,v.rect.height)),m.data=P(m,I,m.width,m.height),delete m.compress,delete m.interlace,delete m.filter,m},toRGBA8:function(i){const r=i.width,a=i.height;if(i.tabs.acTL==null)return[R(i.data,r,a,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const b=r*a*4,_=new Uint8Array(b),m=new Uint8Array(b),I=new Uint8Array(b);for(let U=0;U<i.frames.length;U++){const T=i.frames[U],p=T.rect.x,k=T.rect.y,c=T.rect.width,f=T.rect.height,x=R(T.data,c,f,i);if(U!=0)for(var j=0;j<b;j++)I[j]=_[j];if(T.blend==0?y(x,c,f,_,r,a,p,k,0):T.blend==1&&y(x,c,f,_,r,a,p,k,1),h.push(_.buffer.slice(0)),T.dispose!=0){if(T.dispose==1)y(m,c,f,_,r,a,p,k,0);else if(T.dispose==2)for(j=0;j<b;j++)_[j]=I[j]}}return h},_paeth:o,_copyTile:y,_bin:S}})();(function(){const{_copyTile:S}=ge,{_bin:R}=ge,P=ge._paeth;var u={table:(function(){const c=new Uint32Array(256);for(let f=0;f<256;f++){let x=f;for(let A=0;A<8;A++)1&x?x=3988292384^x>>>1:x>>>=1;c[f]=x}return c})(),update(c,f,x,A){for(let w=0;w<A;w++)c=u.table[255&(c^f[x+w])]^c>>>8;return c},crc:(c,f,x)=>4294967295^u.update(4294967295,c,f,x)};function e(c,f,x,A){f[x]+=c[0]*A>>4,f[x+1]+=c[1]*A>>4,f[x+2]+=c[2]*A>>4,f[x+3]+=c[3]*A>>4}function t(c){return Math.max(0,Math.min(255,c))}function l(c,f){const x=c[0]-f[0],A=c[1]-f[1],w=c[2]-f[2],C=c[3]-f[3];return x*x+A*A+w*w+C*C}function o(c,f,x,A,w,C,v){v==null&&(v=1);const F=A.length,d=[];for(var s=0;s<F;s++){const M=A[s];d.push([M>>>0&255,M>>>8&255,M>>>16&255,M>>>24&255])}for(s=0;s<F;s++){let M=4294967295;for(var D=0,E=0;E<F;E++){var O=l(d[s],d[E]);E!=s&&O<M&&(M=O,D=E)}}const W=new Uint32Array(w.buffer),H=new Int16Array(f*x*4),N=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(s=0;s<N.length;s++)N[s]=255*((N[s]+.5)/16-.5);for(let M=0;M<x;M++)for(let B=0;B<f;B++){var z;s=4*(M*f+B),v!=2?z=[t(c[s]+H[s]),t(c[s+1]+H[s+1]),t(c[s+2]+H[s+2]),t(c[s+3]+H[s+3])]:(O=N[4*(3&M)+(3&B)],z=[t(c[s]+O),t(c[s+1]+O),t(c[s+2]+O),t(c[s+3]+O)]),D=0;let Z=16777215;for(E=0;E<F;E++){const G=l(z,d[E]);G<Z&&(Z=G,D=E)}const q=d[D],Q=[z[0]-q[0],z[1]-q[1],z[2]-q[2],z[3]-q[3]];v==1&&(B!=f-1&&e(Q,H,s+4,7),M!=x-1&&(B!=0&&e(Q,H,s+4*f-4,3),e(Q,H,s+4*f,5),B!=f-1&&e(Q,H,s+4*f+4,1))),C[s>>2]=D,W[s>>2]=A[D]}}function g(c,f,x,A,w){w==null&&(w={});const{crc:C}=u,v=R.writeUint,F=R.writeUshort,d=R.writeASCII;let s=8;const D=c.frames.length>1;let E,O=!1,W=33+(D?20:0);if(w.sRGB!=null&&(W+=13),w.pHYs!=null&&(W+=21),w.iCCP!=null&&(E=pako.deflate(w.iCCP),W+=21+E.length+4),c.ctype==3){for(var H=c.plte.length,N=0;N<H;N++)c.plte[N]>>>24!=255&&(O=!0);W+=8+3*H+4+(O?8+1*H+4:0)}for(var z=0;z<c.frames.length;z++)D&&(W+=38),W+=(q=c.frames[z]).cimg.length+12,z!=0&&(W+=4);W+=12;const M=new Uint8Array(W),B=[137,80,78,71,13,10,26,10];for(N=0;N<8;N++)M[N]=B[N];if(v(M,s,13),s+=4,d(M,s,"IHDR"),s+=4,v(M,s,f),s+=4,v(M,s,x),s+=4,M[s]=c.depth,s++,M[s]=c.ctype,s++,M[s]=0,s++,M[s]=0,s++,M[s]=0,s++,v(M,s,C(M,s-17,17)),s+=4,w.sRGB!=null&&(v(M,s,1),s+=4,d(M,s,"sRGB"),s+=4,M[s]=w.sRGB,s++,v(M,s,C(M,s-5,5)),s+=4),w.iCCP!=null){const Q=13+E.length;v(M,s,Q),s+=4,d(M,s,"iCCP"),s+=4,d(M,s,"ICC profile"),s+=11,s+=2,M.set(E,s),s+=E.length,v(M,s,C(M,s-(Q+4),Q+4)),s+=4}if(w.pHYs!=null&&(v(M,s,9),s+=4,d(M,s,"pHYs"),s+=4,v(M,s,w.pHYs[0]),s+=4,v(M,s,w.pHYs[1]),s+=4,M[s]=w.pHYs[2],s++,v(M,s,C(M,s-13,13)),s+=4),D&&(v(M,s,8),s+=4,d(M,s,"acTL"),s+=4,v(M,s,c.frames.length),s+=4,v(M,s,w.loop!=null?w.loop:0),s+=4,v(M,s,C(M,s-12,12)),s+=4),c.ctype==3){for(v(M,s,3*(H=c.plte.length)),s+=4,d(M,s,"PLTE"),s+=4,N=0;N<H;N++){const Q=3*N,G=c.plte[N],ee=255&G,re=G>>>8&255,_e=G>>>16&255;M[s+Q+0]=ee,M[s+Q+1]=re,M[s+Q+2]=_e}if(s+=3*H,v(M,s,C(M,s-3*H-4,3*H+4)),s+=4,O){for(v(M,s,H),s+=4,d(M,s,"tRNS"),s+=4,N=0;N<H;N++)M[s+N]=c.plte[N]>>>24&255;s+=H,v(M,s,C(M,s-H-4,H+4)),s+=4}}let Z=0;for(z=0;z<c.frames.length;z++){var q=c.frames[z];D&&(v(M,s,26),s+=4,d(M,s,"fcTL"),s+=4,v(M,s,Z++),s+=4,v(M,s,q.rect.width),s+=4,v(M,s,q.rect.height),s+=4,v(M,s,q.rect.x),s+=4,v(M,s,q.rect.y),s+=4,F(M,s,A[z]),s+=2,F(M,s,1e3),s+=2,M[s]=q.dispose,s++,M[s]=q.blend,s++,v(M,s,C(M,s-30,30)),s+=4);const Q=q.cimg;v(M,s,(H=Q.length)+(z==0?0:4)),s+=4;const G=s;d(M,s,z==0?"IDAT":"fdAT"),s+=4,z!=0&&(v(M,s,Z++),s+=4),M.set(Q,s),s+=H,v(M,s,C(M,G,s-G)),s+=4}return v(M,s,0),s+=4,d(M,s,"IEND"),s+=4,v(M,s,C(M,s-4,4)),s+=4,M.buffer}function y(c,f,x){for(let A=0;A<c.frames.length;A++){const w=c.frames[A];w.rect.width;const C=w.rect.height,v=new Uint8Array(C*w.bpl+C);w.cimg=a(w.img,C,w.bpp,w.bpl,v,f,x)}}function n(c,f,x,A,w){const C=w[0],v=w[1],F=w[2],d=w[3],s=w[4],D=w[5];let E=6,O=8,W=255;for(var H=0;H<c.length;H++){const oe=new Uint8Array(c[H]);for(var N=oe.length,z=0;z<N;z+=4)W&=oe[z+3]}const M=W!=255,B=(function(X,K,ie,le,te,de){const ne=[];for(var V=0;V<X.length;V++){const fe=new Uint8Array(X[V]),pe=new Uint32Array(fe.buffer);var ue;let he=0,ve=0,be=K,Ce=ie,He=le?1:0;if(V!=0){const lt=de||le||V==1||ne[V-2].dispose!=0?1:2;let Ne=0,$e=1e9;for(let ke=0;ke<lt;ke++){var xe=new Uint8Array(X[V-1-ke]);const ft=new Uint32Array(X[V-1-ke]);let we=K,Ae=ie,je=-1,Ie=-1;for(let Se=0;Se<ie;Se++)for(let Ee=0;Ee<K;Ee++)pe[ae=Se*K+Ee]!=ft[ae]&&(Ee<we&&(we=Ee),Ee>je&&(je=Ee),Se<Ae&&(Ae=Se),Se>Ie&&(Ie=Se));je==-1&&(we=Ae=je=Ie=0),te&&((1&we)==1&&we--,(1&Ae)==1&&Ae--);const Ge=(je-we+1)*(Ie-Ae+1);Ge<$e&&($e=Ge,Ne=ke,he=we,ve=Ae,be=je-we+1,Ce=Ie-Ae+1)}xe=new Uint8Array(X[V-1-Ne]),Ne==1&&(ne[V-1].dispose=2),ue=new Uint8Array(be*Ce*4),S(xe,K,ie,ue,be,Ce,-he,-ve,0),He=S(fe,K,ie,ue,be,Ce,-he,-ve,3)?1:0,He==1?r(fe,K,ie,ue,{x:he,y:ve,width:be,height:Ce}):S(fe,K,ie,ue,be,Ce,-he,-ve,0)}else ue=fe.slice(0);ne.push({rect:{x:he,y:ve,width:be,height:Ce},img:ue,blend:He,dispose:0})}if(le)for(V=0;V<ne.length;V++){if((Ue=ne[V]).blend==1)continue;const fe=Ue.rect,pe=ne[V-1].rect,he=Math.min(fe.x,pe.x),ve=Math.min(fe.y,pe.y),be={x:he,y:ve,width:Math.max(fe.x+fe.width,pe.x+pe.width)-he,height:Math.max(fe.y+fe.height,pe.y+pe.height)-ve};ne[V-1].dispose=1,V-1!=0&&i(X,K,ie,ne,V-1,be,te),i(X,K,ie,ne,V,be,te)}let Me=0;if(X.length!=1)for(var ae=0;ae<ne.length;ae++){var Ue;Me+=(Ue=ne[ae]).rect.width*Ue.rect.height}return ne})(c,f,x,C,v,F),Z={},q=[],Q=[];if(A!=0){const oe=[];for(z=0;z<B.length;z++)oe.push(B[z].img.buffer);const X=(function(te){let de=0;for(var ne=0;ne<te.length;ne++)de+=te[ne].byteLength;const V=new Uint8Array(de);let ue=0;for(ne=0;ne<te.length;ne++){const xe=new Uint8Array(te[ne]),Me=xe.length;for(let ae=0;ae<Me;ae+=4){let Ue=xe[ae],fe=xe[ae+1],pe=xe[ae+2];const he=xe[ae+3];he==0&&(Ue=fe=pe=0),V[ue+ae]=Ue,V[ue+ae+1]=fe,V[ue+ae+2]=pe,V[ue+ae+3]=he}ue+=Me}return V.buffer})(oe),K=b(X,A);for(z=0;z<K.plte.length;z++)q.push(K.plte[z].est.rgba);let ie=0;for(z=0;z<B.length;z++){const le=(ee=B[z]).img.length;var G=new Uint8Array(K.inds.buffer,ie>>2,le>>2);Q.push(G);const te=new Uint8Array(K.abuf,ie,le);D&&o(ee.img,ee.rect.width,ee.rect.height,q,te,G),ee.img.set(te),ie+=le}}else for(H=0;H<B.length;H++){var ee=B[H];const oe=new Uint32Array(ee.img.buffer);var re=ee.rect.width;for(N=oe.length,G=new Uint8Array(N),Q.push(G),z=0;z<N;z++){const X=oe[z];if(z!=0&&X==oe[z-1])G[z]=G[z-1];else if(z>re&&X==oe[z-re])G[z]=G[z-re];else{let K=Z[X];if(K==null&&(Z[X]=K=q.length,q.push(X),q.length>=300))break;G[z]=K}}}const _e=q.length;for(_e<=256&&s==0&&(O=_e<=2?1:_e<=4?2:_e<=16?4:8,O=Math.max(O,d)),H=0;H<B.length;H++){(ee=B[H]).rect.x,ee.rect.y,re=ee.rect.width;const oe=ee.rect.height;let X=ee.img;new Uint32Array(X.buffer);let K=4*re,ie=4;if(_e<=256&&s==0){K=Math.ceil(O*re/8);var me=new Uint8Array(K*oe);const le=Q[H];for(let te=0;te<oe;te++){z=te*K;const de=te*re;if(O==8)for(var Y=0;Y<re;Y++)me[z+Y]=le[de+Y];else if(O==4)for(Y=0;Y<re;Y++)me[z+(Y>>1)]|=le[de+Y]<<4-4*(1&Y);else if(O==2)for(Y=0;Y<re;Y++)me[z+(Y>>2)]|=le[de+Y]<<6-2*(3&Y);else if(O==1)for(Y=0;Y<re;Y++)me[z+(Y>>3)]|=le[de+Y]<<7-1*(7&Y)}X=me,E=3,ie=1}else if(M==0&&B.length==1){me=new Uint8Array(re*oe*3);const le=re*oe;for(z=0;z<le;z++){const te=3*z,de=4*z;me[te]=X[de],me[te+1]=X[de+1],me[te+2]=X[de+2]}X=me,E=2,ie=3,K=3*re}ee.img=X,ee.bpl=K,ee.bpp=ie}return{ctype:E,depth:O,plte:q,frames:B}}function i(c,f,x,A,w,C,v){const F=Uint8Array,d=Uint32Array,s=new F(c[w-1]),D=new d(c[w-1]),E=w+1<c.length?new F(c[w+1]):null,O=new F(c[w]),W=new d(O.buffer);let H=f,N=x,z=-1,M=-1;for(let Z=0;Z<C.height;Z++)for(let q=0;q<C.width;q++){const Q=C.x+q,G=C.y+Z,ee=G*f+Q,re=W[ee];re==0||A[w-1].dispose==0&&D[ee]==re&&(E==null||E[4*ee+3]!=0)||(Q<H&&(H=Q),Q>z&&(z=Q),G<N&&(N=G),G>M&&(M=G))}z==-1&&(H=N=z=M=0),v&&((1&H)==1&&H--,(1&N)==1&&N--),C={x:H,y:N,width:z-H+1,height:M-N+1};const B=A[w];B.rect=C,B.blend=1,B.img=new Uint8Array(C.width*C.height*4),A[w-1].dispose==0?(S(s,f,x,B.img,C.width,C.height,-C.x,-C.y,0),r(O,f,x,B.img,C)):S(O,f,x,B.img,C.width,C.height,-C.x,-C.y,0)}function r(c,f,x,A,w){S(c,f,x,A,w.width,w.height,-w.x,-w.y,2)}function a(c,f,x,A,w,C,v){const F=[];let d,s=[0,1,2,3,4];C!=-1?s=[C]:(f*A>5e5||x==1)&&(s=[0]),v&&(d={level:0});const D=pt;for(var E=0;E<s.length;E++){for(let H=0;H<f;H++)h(w,c,H,A,x,s[E]);F.push(D.deflate(w,d))}let O,W=1e9;for(E=0;E<F.length;E++)F[E].length<W&&(O=E,W=F[E].length);return F[O]}function h(c,f,x,A,w,C){const v=x*A;let F=v+x;if(c[F]=C,F++,C==0)if(A<500)for(var d=0;d<A;d++)c[F+d]=f[v+d];else c.set(new Uint8Array(f.buffer,v,A),F);else if(C==1){for(d=0;d<w;d++)c[F+d]=f[v+d];for(d=w;d<A;d++)c[F+d]=f[v+d]-f[v+d-w]+256&255}else if(x==0){for(d=0;d<w;d++)c[F+d]=f[v+d];if(C==2)for(d=w;d<A;d++)c[F+d]=f[v+d];if(C==3)for(d=w;d<A;d++)c[F+d]=f[v+d]-(f[v+d-w]>>1)+256&255;if(C==4)for(d=w;d<A;d++)c[F+d]=f[v+d]-P(f[v+d-w],0,0)+256&255}else{if(C==2)for(d=0;d<A;d++)c[F+d]=f[v+d]+256-f[v+d-A]&255;if(C==3){for(d=0;d<w;d++)c[F+d]=f[v+d]+256-(f[v+d-A]>>1)&255;for(d=w;d<A;d++)c[F+d]=f[v+d]+256-(f[v+d-A]+f[v+d-w]>>1)&255}if(C==4){for(d=0;d<w;d++)c[F+d]=f[v+d]+256-P(0,f[v+d-A],0)&255;for(d=w;d<A;d++)c[F+d]=f[v+d]+256-P(f[v+d-w],f[v+d-A],f[v+d-w-A])&255}}}function b(c,f){const x=new Uint8Array(c),A=x.slice(0),w=new Uint32Array(A.buffer),C=_(A,f),v=C[0],F=C[1],d=x.length,s=new Uint8Array(d>>2);let D;if(x.length<2e7)for(var E=0;E<d;E+=4)D=m(v,O=x[E]*(1/255),W=x[E+1]*(1/255),H=x[E+2]*(1/255),N=x[E+3]*(1/255)),s[E>>2]=D.ind,w[E>>2]=D.est.rgba;else for(E=0;E<d;E+=4){var O=x[E]*.00392156862745098,W=x[E+1]*(1/255),H=x[E+2]*(1/255),N=x[E+3]*(1/255);for(D=v;D.left;)D=I(D.est,O,W,H,N)<=0?D.left:D.right;s[E>>2]=D.ind,w[E>>2]=D.est.rgba}return{abuf:A.buffer,inds:s,plte:F}}function _(c,f,x){x==null&&(x=1e-4);const A=new Uint32Array(c.buffer),w={i0:0,i1:c.length,bst:null,est:null,tdst:0,left:null,right:null};w.bst=T(c,w.i0,w.i1),w.est=p(w.bst);const C=[w];for(;C.length<f;){let F=0,d=0;for(var v=0;v<C.length;v++)C[v].est.L>F&&(F=C[v].est.L,d=v);if(F<x)break;const s=C[d],D=j(c,A,s.i0,s.i1,s.est.e,s.est.eMq255);if(s.i0>=D||s.i1<=D){s.est.L=0;continue}const E={i0:s.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};E.bst=T(c,E.i0,E.i1),E.est=p(E.bst);const O={i0:D,i1:s.i1,bst:null,est:null,tdst:0,left:null,right:null};for(O.bst={R:[],m:[],N:s.bst.N-E.bst.N},v=0;v<16;v++)O.bst.R[v]=s.bst.R[v]-E.bst.R[v];for(v=0;v<4;v++)O.bst.m[v]=s.bst.m[v]-E.bst.m[v];O.est=p(O.bst),s.left=E,s.right=O,C[d]=E,C.push(O)}for(C.sort(((F,d)=>d.bst.N-F.bst.N)),v=0;v<C.length;v++)C[v].ind=v;return[w,C]}function m(c,f,x,A,w){if(c.left==null)return c.tdst=(function(E,O,W,H,N){const z=O-E[0],M=W-E[1],B=H-E[2],Z=N-E[3];return z*z+M*M+B*B+Z*Z})(c.est.q,f,x,A,w),c;const C=I(c.est,f,x,A,w);let v=c.left,F=c.right;C>0&&(v=c.right,F=c.left);const d=m(v,f,x,A,w);if(d.tdst<=C*C)return d;const s=m(F,f,x,A,w);return s.tdst<d.tdst?s:d}function I(c,f,x,A,w){const{e:C}=c;return C[0]*f+C[1]*x+C[2]*A+C[3]*w-c.eMq}function j(c,f,x,A,w,C){for(A-=4;x<A;){for(;U(c,x,w)<=C;)x+=4;for(;U(c,A,w)>C;)A-=4;if(x>=A)break;const v=f[x>>2];f[x>>2]=f[A>>2],f[A>>2]=v,x+=4,A-=4}for(;U(c,x,w)>C;)x-=4;return x+4}function U(c,f,x){return c[f]*x[0]+c[f+1]*x[1]+c[f+2]*x[2]+c[f+3]*x[3]}function T(c,f,x){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=[0,0,0,0],C=x-f>>2;for(let v=f;v<x;v+=4){const F=c[v]*.00392156862745098,d=c[v+1]*(1/255),s=c[v+2]*(1/255),D=c[v+3]*(1/255);w[0]+=F,w[1]+=d,w[2]+=s,w[3]+=D,A[0]+=F*F,A[1]+=F*d,A[2]+=F*s,A[3]+=F*D,A[5]+=d*d,A[6]+=d*s,A[7]+=d*D,A[10]+=s*s,A[11]+=s*D,A[15]+=D*D}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:w,N:C}}function p(c){const{R:f}=c,{m:x}=c,{N:A}=c,w=x[0],C=x[1],v=x[2],F=x[3],d=A==0?0:1/A,s=[f[0]-w*w*d,f[1]-w*C*d,f[2]-w*v*d,f[3]-w*F*d,f[4]-C*w*d,f[5]-C*C*d,f[6]-C*v*d,f[7]-C*F*d,f[8]-v*w*d,f[9]-v*C*d,f[10]-v*v*d,f[11]-v*F*d,f[12]-F*w*d,f[13]-F*C*d,f[14]-F*v*d,f[15]-F*F*d],D=s,E=k;let O=[Math.random(),Math.random(),Math.random(),Math.random()],W=0,H=0;if(A!=0)for(let z=0;z<16&&(O=E.multVec(D,O),H=Math.sqrt(E.dot(O,O)),O=E.sml(1/H,O),!(z!=0&&Math.abs(H-W)<1e-9));z++)W=H;const N=[w*d,C*d,v*d,F*d];return{Cov:s,q:N,e:O,L:W,eMq255:E.dot(E.sml(255,N),O),eMq:E.dot(O,N),rgba:(Math.round(255*N[3])<<24|Math.round(255*N[2])<<16|Math.round(255*N[1])<<8|Math.round(255*N[0])<<0)>>>0}}var k={multVec:(c,f)=>[c[0]*f[0]+c[1]*f[1]+c[2]*f[2]+c[3]*f[3],c[4]*f[0]+c[5]*f[1]+c[6]*f[2]+c[7]*f[3],c[8]*f[0]+c[9]*f[1]+c[10]*f[2]+c[11]*f[3],c[12]*f[0]+c[13]*f[1]+c[14]*f[2]+c[15]*f[3]],dot:(c,f)=>c[0]*f[0]+c[1]*f[1]+c[2]*f[2]+c[3]*f[3],sml:(c,f)=>[c*f[0],c*f[1],c*f[2],c*f[3]]};ge.encode=function(f,x,A,w,C,v,F){w==null&&(w=0),F==null&&(F=!1);const d=n(f,x,A,w,[!1,!1,!1,0,F,!1]);return y(d,-1),g(d,x,A,C,v)},ge.encodeLL=function(f,x,A,w,C,v,F,d){const s={ctype:0+(w==1?0:2)+(C==0?0:4),depth:v,frames:[]},D=(w+C)*v,E=D*x;for(let O=0;O<f.length;O++)s.frames.push({rect:{x:0,y:0,width:x,height:A},img:new Uint8Array(f[O]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil(E/8)});return y(s,0,!0),g(s,x,A,F,d)},ge.encode.compress=n,ge.encode.dither=o,ge.quantize=b,ge.quantize.getKDtree=_,ge.quantize.getNearest=m})();const Ye={toArrayBuffer(S,R){const P=S.width,u=S.height,e=P<<2,t=S.getContext("2d").getImageData(0,0,P,u),l=new Uint32Array(t.data.buffer),o=(32*P+31)/32<<2,g=o*u,y=122+g,n=new ArrayBuffer(y),i=new DataView(n),r=1<<20;let a,h,b,_,m=r,I=0,j=0,U=0;function T(c){i.setUint16(j,c,!0),j+=2}function p(c){i.setUint32(j,c,!0),j+=4}function k(c){j+=c}T(19778),p(y),k(4),p(122),p(108),p(P),p(-u>>>0),T(1),T(32),p(3),p(g),p(2835),p(2835),k(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),(function c(){for(;I<u&&m>0;){for(_=122+I*o,a=0;a<e;)m--,h=l[U++],b=h>>>24,i.setUint32(_+a,h<<8|b),a+=4;I++}U<l.length?(m=r,setTimeout(c,Ye._dly)):R(n)})()},toBlob(S,R){this.toArrayBuffer(S,(P=>{R(new Blob([P],{type:"image/bmp"}))}))},_dly:9};var ce={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gt={[ce.CHROME]:16384,[ce.FIREFOX]:11180,[ce.DESKTOP_SAFARI]:16384,[ce.IE]:8192,[ce.IOS]:4096,[ce.ETC]:8192};const Qe=typeof window<"u",Je=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,De=Qe&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),mt=(Qe||Je)&&(De&&De.getOriginalSymbol(window,"File")||typeof File<"u"&&File),et=(Qe||Je)&&(De&&De.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function qe(S,R,P=Date.now()){return new Promise((u=>{const e=S.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let o=l.length;const g=new Uint8Array(o);for(;o--;)g[o]=l.charCodeAt(o);const y=new Blob([g],{type:t});y.name=R,y.lastModified=P,u(y)}))}function tt(S){return new Promise(((R,P)=>{const u=new et;u.onload=()=>R(u.result),u.onerror=e=>P(e),u.readAsDataURL(S)}))}function nt(S){return new Promise(((R,P)=>{const u=new Image;u.onload=()=>R(u),u.onerror=e=>P(e),u.src=S}))}function Fe(){if(Fe.cachedResult!==void 0)return Fe.cachedResult;let S=ce.ETC;const{userAgent:R}=navigator;return/Chrom(e|ium)/i.test(R)?S=ce.CHROME:/iP(ad|od|hone)/i.test(R)&&/WebKit/i.test(R)?S=ce.IOS:/Safari/i.test(R)?S=ce.DESKTOP_SAFARI:/Firefox/i.test(R)?S=ce.FIREFOX:(/MSIE/i.test(R)||document.documentMode)&&(S=ce.IE),Fe.cachedResult=S,Fe.cachedResult}function rt(S,R){const P=Fe(),u=gt[P];let e=S,t=R,l=e*t;const o=e>t?t/e:e/t;for(;l>u*u;){const g=(u+e)/2,y=(u+t)/2;g<y?(t=y,e=y*o):(t=g*o,e=g),l=e*t}return{width:e,height:t}}function Le(S,R){let P,u;try{if(P=new OffscreenCanvas(S,R),u=P.getContext("2d"),u===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{P=document.createElement("canvas"),u=P.getContext("2d")}return P.width=S,P.height=R,[P,u]}function it(S,R){const{width:P,height:u}=rt(S.width,S.height),[e,t]=Le(P,u);return R&&/jpe?g/.test(R)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(S,0,0,e.width,e.height),e}function Te(){return Te.cachedResult!==void 0||(Te.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Te.cachedResult}function Oe(S,R={}){return new Promise((function(P,u){let e,t;var l=function(){try{return t=it(e,R.fileType||S.type),P([e,t])}catch(g){return u(g)}},o=function(g){try{var y=function(n){try{throw n}catch(i){return u(i)}};try{let n;return tt(S).then((function(i){try{return n=i,nt(n).then((function(r){try{return e=r,(function(){try{return l()}catch(a){return u(a)}})()}catch(a){return y(a)}}),y)}catch(r){return y(r)}}),y)}catch(n){y(n)}}catch(n){return u(n)}};try{if(Te()||[ce.DESKTOP_SAFARI,ce.MOBILE_SAFARI].includes(Fe()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(S).then((function(g){try{return e=g,l()}catch{return o()}}),o)}catch{o()}}))}function ze(S,R,P,u,e=1){return new Promise((function(t,l){let o;if(R==="image/png"){let y,n,i;return y=S.getContext("2d"),{data:n}=y.getImageData(0,0,S.width,S.height),i=ge.encode([n.buffer],S.width,S.height,4096*e),o=new Blob([i],{type:R}),o.name=P,o.lastModified=u,g.call(this)}{let y=function(){return g.call(this)};if(R==="image/bmp")return new Promise((n=>Ye.toBlob(S,n))).then(function(n){try{return o=n,o.name=P,o.lastModified=u,y.call(this)}catch(i){return l(i)}}.bind(this),l);{let n=function(){return y.call(this)};if(typeof OffscreenCanvas=="function"&&S instanceof OffscreenCanvas)return S.convertToBlob({type:R,quality:e}).then(function(i){try{return o=i,o.name=P,o.lastModified=u,n.call(this)}catch(r){return l(r)}}.bind(this),l);{let i;return i=S.toDataURL(R,e),qe(i,P,u).then(function(r){try{return o=r,n.call(this)}catch(a){return l(a)}}.bind(this),l)}}}function g(){return t(o)}}))}function ye(S){S.width=0,S.height=0}function Re(){return new Promise((function(S,R){let P,u,e,t;return Re.cachedResult!==void 0?S(Re.cachedResult):qe("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(l){try{return P=l,Oe(P).then((function(o){try{return u=o[1],ze(u,P.type,P.name,P.lastModified).then((function(g){try{return e=g,ye(u),Oe(e).then((function(y){try{return t=y[0],Re.cachedResult=t.width===1&&t.height===2,S(Re.cachedResult)}catch(n){return R(n)}}),R)}catch(y){return R(y)}}),R)}catch(g){return R(g)}}),R)}catch(o){return R(o)}}),R)}))}function ot(S){return new Promise(((R,P)=>{const u=new et;u.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return R(-2);const l=t.byteLength;let o=2;for(;o<l;){if(t.getUint16(o+2,!1)<=8)return R(-1);const g=t.getUint16(o,!1);if(o+=2,g==65505){if(t.getUint32(o+=2,!1)!=1165519206)return R(-1);const y=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,y);const n=t.getUint16(o,y);o+=2;for(let i=0;i<n;i++)if(t.getUint16(o+12*i,y)==274)return R(t.getUint16(o+12*i+8,y))}else{if((65280&g)!=65280)break;o+=t.getUint16(o,!1)}}return R(-1)},u.onerror=e=>P(e),u.readAsArrayBuffer(S)}))}function at(S,R){const{width:P}=S,{height:u}=S,{maxWidthOrHeight:e}=R;let t,l=S;return isFinite(e)&&(P>e||u>e)&&([l,t]=Le(P,u),P>u?(l.width=e,l.height=u/P*e):(l.width=P/u*e,l.height=e),t.drawImage(S,0,0,l.width,l.height),ye(S)),l}function st(S,R){const{width:P}=S,{height:u}=S,[e,t]=Le(P,u);switch(R>4&&R<9?(e.width=u,e.height=P):(e.width=P,e.height=u),R){case 2:t.transform(-1,0,0,1,P,0);break;case 3:t.transform(-1,0,0,-1,P,u);break;case 4:t.transform(1,0,0,-1,0,u);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,u,0);break;case 7:t.transform(0,-1,-1,0,u,P);break;case 8:t.transform(0,-1,1,0,0,P)}return t.drawImage(S,0,0,P,u),ye(S),e}function Ze(S,R,P=0){return new Promise((function(u,e){let t,l,o,g,y,n,i,r,a,h,b,_,m,I,j,U,T,p,k,c;function f(A=5){if(R.signal&&R.signal.aborted)throw R.signal.reason;t+=A,R.onProgress(Math.min(t,100))}function x(A){if(R.signal&&R.signal.aborted)throw R.signal.reason;t=Math.min(Math.max(A,t),100),R.onProgress(t)}return t=P,l=R.maxIteration||10,o=1024*R.maxSizeMB*1024,f(),Oe(S,R).then(function(A){try{return[,g]=A,f(),y=at(g,R),f(),new Promise((function(w,C){var v;if(!(v=R.exifOrientation))return ot(S).then(function(d){try{return v=d,F.call(this)}catch(s){return C(s)}}.bind(this),C);function F(){return w(v)}return F.call(this)})).then(function(w){try{return n=w,f(),Re().then(function(C){try{return i=C?y:st(y,n),f(),r=R.initialQuality||1,a=R.fileType||S.type,ze(i,a,S.name,S.lastModified,r).then(function(v){try{{let d=function(){if(l--&&(j>o||j>m)){let D,E;return D=c?.95*k.width:k.width,E=c?.95*k.height:k.height,[T,p]=Le(D,E),p.drawImage(k,0,0,D,E),r*=a==="image/png"?.85:.95,ze(T,a,S.name,S.lastModified,r).then((function(O){try{return U=O,ye(k),k=T,j=U.size,x(Math.min(99,Math.floor((I-j)/(I-o)*100))),d}catch(W){return e(W)}}),e)}return[1]},s=function(){return ye(k),ye(T),ye(y),ye(i),ye(g),x(100),u(U)};if(h=v,f(),b=h.size>o,_=h.size>S.size,!b&&!_)return x(100),u(h);var F;return m=S.size,I=h.size,j=I,k=i,c=!R.alwaysKeepResolution&&b,(F=function(D){for(;D;){if(D.then)return void D.then(F,e);try{if(D.pop){if(D.length)return D.pop()?s.call(this):D;D=d}else D=D.call(this)}catch(E){return e(E)}}}.bind(this))(d)}}catch(d){return e(d)}}.bind(this),e)}catch(v){return e(v)}}.bind(this),e)}catch(C){return e(C)}}.bind(this),e)}catch(w){return e(w)}}.bind(this),e)}))}const bt=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let We;function yt(S,R){return new Promise(((P,u)=>{We||(We=(function(l){const o=[];return o.push(l),URL.createObjectURL(new Blob(o))})(bt));const e=new Worker(We);e.addEventListener("message",(function(l){if(R.signal&&R.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return u(new Error(l.data.error)),void e.terminate();P(l.data.file),e.terminate()}else R.onProgress(l.data.progress)})),e.addEventListener("error",u),R.signal&&R.signal.addEventListener("abort",(()=>{u(R.signal.reason),e.terminate()})),e.postMessage({file:S,imageCompressionLibUrl:R.libURL,options:{...R,onProgress:void 0,signal:void 0}})}))}function se(S,R){return new Promise((function(P,u){let e,t,l,o,g,y;if(e={...R},l=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,g=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=a=>{l=a,typeof o=="function"&&o(l)},!(S instanceof Blob||S instanceof mt))return u(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(S.type))return u(new Error("The file given is not an image"));if(y=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!g||typeof Worker!="function"||y)return Ze(S,e).then(function(a){try{return t=a,r.call(this)}catch(h){return u(h)}}.bind(this),u);var n=function(){try{return r.call(this)}catch(a){return u(a)}}.bind(this),i=function(a){try{return Ze(S,e).then((function(h){try{return t=h,n()}catch(b){return u(b)}}),u)}catch(h){return u(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",yt(S,e).then((function(a){try{return t=a,n()}catch{return i()}}),i)}catch{i()}function r(){try{t.name=S.name,t.lastModified=S.lastModified}catch{}try{e.preserveExif&&S.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===S.type)&&(t=Xe(S,t))}catch{}return P(t)}}))}se.getDataUrlFromFile=tt,se.getFilefromDataUrl=qe,se.loadImage=nt,se.drawImageInCanvas=it,se.drawFileInCanvas=Oe,se.canvasToFile=ze,se.getExifOrientation=ot,se.handleMaxWidthOrHeight=at,se.followExifOrientation=st,se.cleanupCanvasMemory=ye,se.isAutoOrientationInBrowser=Re,se.approximateBelowMaximumCanvasSizeOfBrowser=rt,se.copyExifWithoutOrientation=Xe,se.getBrowserName=Fe,se.version="2.0.2";function vt({userId:S,userAvatar:R}){const[P,u]=$.useState(""),[e,t]=$.useState(!1),[l,o]=$.useState(!1),[g,y]=$.useState(""),[n,i]=$.useState([]),[r,a]=$.useState([]),h=async I=>{const j=Array.from(I.target.files||[]);if(j.length===0)return;if(j.length+n.length>4){y("Maximum 4 images per post");return}i([...n,...j]);const U=j.map(T=>URL.createObjectURL(T));a([...r,...U])},b=I=>{const j=n.filter((T,p)=>p!==I),U=r.filter((T,p)=>p!==I);URL.revokeObjectURL(r[I]),i(j),a(U)},_=async I=>{try{const U=await se(I,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),T=I.name.split(".").pop(),p=`${S}/${Date.now()}-${Math.random().toString(36).substring(7)}.${T}`,{data:k,error:c}=await J.storage.from("media").upload(p,U);if(c)throw c;const{data:{publicUrl:f}}=J.storage.from("media").getPublicUrl(k.path);return f}catch(j){throw console.error("Upload error:",j),new Error("Failed to upload image")}},m=async I=>{if(I.preventDefault(),!P.trim()&&n.length===0){y("Please write something or add an image");return}o(!0),y("");try{let j=[];n.length>0&&(t(!0),j=await Promise.all(n.map(_)),t(!1));const{error:U}=await J.from("posts").insert({user_id:S,content:P.trim(),media_urls:j.length>0?j:null});if(U)throw U;u(""),i([]),r.forEach(T=>URL.revokeObjectURL(T)),a([]),window.location.reload()}catch(j){y(j.message||"Failed to create post"),t(!1),o(!1)}};return L.jsxs("form",{onSubmit:m,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[L.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"start"},children:[R?L.jsx("img",{src:R,alt:"You",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):L.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:"?"}),L.jsx("textarea",{value:P,onChange:I=>u(I.target.value),placeholder:"What's on your mind?",rows:3,style:{flex:1,resize:"vertical",minHeight:"80px",fontSize:"16px"},disabled:l})]}),g&&L.jsx("div",{style:{background:"#fee",color:"#c33",padding:"10px",borderRadius:"6px",fontSize:"14px"},children:g}),r.length>0&&L.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:r.map((I,j)=>L.jsxs("div",{style:{position:"relative"},children:[L.jsx("img",{src:I,alt:`Preview ${j+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px"}}),L.jsx("button",{type:"button",onClick:()=>b(j),style:{position:"absolute",top:"5px",right:"5px",background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"16px",lineHeight:"1"},children:""})]},j))}),L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[L.jsxs("label",{style:{cursor:"pointer"},children:[L.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h,style:{display:"none"},disabled:l||n.length>=4}),L.jsxs("span",{style:{color:"#4A90E2",fontWeight:"500",fontSize:"14px"},children:[" Add Photos ",n.length>0&&`(${n.length}/4)`]})]}),L.jsx("button",{type:"submit",className:"btn",disabled:l||e,style:{opacity:l||e?.5:1},children:e?"Uploading...":l?"Posting...":"Post"})]})]})}const Be={like:"",love:"",laugh:"",celebrate:""};function xt({postId:S,currentUserId:R}){const[P,u]=$.useState([]),[e,t]=$.useState(null),[l,o]=$.useState(!1),[g,y]=$.useState(!1);$.useEffect(()=>{n(),i()},[S]);async function n(){const{data:_}=await J.from("post_reactions").select(`
        *,
        profile:profiles(display_name)
      `).eq("post_id",S);if(_){u(_);const m=_.find(I=>I.user_id===R);t(m?.reaction_type||null)}}function i(){const _=J.channel(`reactions-${S}`).on("postgres_changes",{event:"*",schema:"public",table:"post_reactions",filter:`post_id=eq.${S}`},()=>{n()}).subscribe();return()=>{J.removeChannel(_)}}async function r(_){if(!g){y(!0);try{e===_?(await J.from("post_reactions").delete().eq("post_id",S).eq("user_id",R),t(null)):e?(await J.from("post_reactions").update({reaction_type:_}).eq("post_id",S).eq("user_id",R),t(_)):(await J.from("post_reactions").insert({post_id:S,user_id:R,reaction_type:_}),t(_)),o(!1)}catch(m){console.error("Reaction error:",m)}finally{y(!1)}}}const a={};P.forEach(_=>{a[_.reaction_type]=(a[_.reaction_type]||0)+1});const h=P.length,b=P.slice(0,3).map(_=>_.profile?.display_name).filter(Boolean);return L.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[h>0&&L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",fontSize:"14px",color:"#666"},children:[L.jsx("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:Object.entries(a).map(([_,m])=>L.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[Be[_]," ",m]},_))}),b.length>0&&L.jsxs("div",{style:{fontSize:"13px"},children:[b.join(", "),P.length>3&&` +${P.length-3} more`]})]}),L.jsxs("div",{style:{display:"flex",gap:"10px",position:"relative"},children:[L.jsxs("button",{onClick:()=>e?r(e):o(!l),style:{background:e?"#e3f2fd":"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:e?"#4A90E2":"#666",fontWeight:e?600:400},children:[e?Be[e]:"",e?"Liked":"Like"]}),!e&&L.jsx("button",{onClick:()=>o(!l),style:{background:"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 10px",fontSize:"16px",cursor:"pointer"},title:"React",children:"+"}),l&&L.jsx("div",{style:{position:"absolute",bottom:"100%",left:0,marginBottom:"8px",background:"white",border:"1px solid #ddd",borderRadius:"24px",padding:"8px 12px",display:"flex",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10},children:Object.entries(Be).map(([_,m])=>L.jsx("button",{onClick:()=>r(_),style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",padding:"4px",borderRadius:"50%",transition:"transform 0.2s"},onMouseEnter:I=>I.currentTarget.style.transform="scale(1.3)",onMouseLeave:I=>I.currentTarget.style.transform="scale(1)",title:_,children:m},_))})]})]})}function wt({postId:S,currentUserId:R}){const[P,u]=$.useState([]),[e,t]=$.useState(""),[l,o]=$.useState(!1),[g,y]=$.useState(!1);$.useEffect(()=>{n(),i()},[S]);async function n(){const{data:b}=await J.from("comments").select(`
        *,
        profile:profiles(display_name, avatar_url)
      `).eq("post_id",S).order("created_at",{ascending:!0});b&&u(b)}function i(){const b=J.channel(`comments-${S}`).on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:`post_id=eq.${S}`},()=>{n()}).subscribe();return()=>{J.removeChannel(b)}}async function r(b){if(b.preventDefault(),!(!e.trim()||l)){o(!0);try{await J.from("comments").insert({post_id:S,user_id:R,content:e.trim()}),t(""),y(!0)}catch(_){console.error("Comment error:",_)}finally{o(!1)}}}async function a(b){if(confirm("Delete this comment?"))try{await J.from("comments").delete().eq("id",b)}catch(_){console.error("Delete error:",_)}}const h=b=>{const _=new Date(b),I=new Date().getTime()-_.getTime(),j=Math.floor(I/(1e3*60*60)),U=Math.floor(j/24);if(U>0)return`${U}d ago`;if(j>0)return`${j}h ago`;const T=Math.floor(I/(1e3*60));return T>0?`${T}m ago`:"Just now"};return L.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[L.jsxs("button",{onClick:()=>y(!g),style:{background:"transparent",border:"none",color:"#666",fontSize:"14px",cursor:"pointer",padding:"4px 0",fontWeight:500,display:"flex",alignItems:"center",gap:"6px"},children:[" ",P.length," ",P.length===1?"Comment":"Comments",L.jsx("span",{style:{fontSize:"12px"},children:g?"":""})]}),g&&L.jsxs("div",{style:{marginTop:"12px"},children:[P.map(b=>L.jsx("div",{style:{padding:"10px",background:"#f8f9fa",borderRadius:"8px",marginBottom:"8px"},children:L.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"start"},children:[b.profile?.avatar_url?L.jsx("img",{src:b.profile.avatar_url,alt:b.profile.display_name,style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):L.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:b.profile?.display_name?.[0]?.toUpperCase()||"?"}),L.jsxs("div",{style:{flex:1,minWidth:0},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",gap:"8px"},children:[L.jsxs("div",{children:[L.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:b.profile?.display_name||"Unknown"}),L.jsx("div",{style:{fontSize:"13px",color:"#999"},children:h(b.created_at)})]}),b.user_id===R&&L.jsx("button",{onClick:()=>a(b.id),style:{background:"transparent",border:"none",color:"#999",fontSize:"12px",cursor:"pointer",padding:"2px 6px"},children:"Delete"})]}),L.jsx("div",{style:{fontSize:"14px",marginTop:"6px",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:b.content})]})]})},b.id)),L.jsxs("form",{onSubmit:r,style:{marginTop:"12px"},children:[L.jsx("textarea",{value:e,onChange:b=>t(b.target.value),placeholder:"Write a comment...",rows:2,style:{width:"100%",resize:"vertical",marginBottom:"8px",fontSize:"14px"},disabled:l}),L.jsx("button",{type:"submit",className:"btn",style:{fontSize:"13px",padding:"6px 12px"},disabled:l||!e.trim(),children:l?"Posting...":"Post Comment"})]})]})]})}function Ct(){const[S,R]=$.useState(null),[P,u]=$.useState(null),[e,t]=$.useState([]),[l,o]=$.useState(!0),[g,y]=$.useState(""),[n,i]=$.useState(0),[r,a]=$.useState([]),[h,b]=$.useState(null);$.useEffect(()=>{_()},[]),$.useEffect(()=>{const U=J.channel("posts-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},async T=>{const{data:p}=await J.from("posts").select(`
              *,
              profile:profiles(*)
            `).eq("id",T.new.id).single();p&&(a(k=>[p,...k]),i(k=>k+1))}).subscribe();return()=>{J.removeChannel(U)}},[]);async function _(){try{const U=await ct();if(R(U),!U){window.location.href="/login.html";return}if(!Ke){const{data:T}=await J.from("profiles").select("*").eq("id",U.id).single();u(T);const{data:p,error:k}=await J.from("posts").select(`
            *,
            profile:profiles(*)
          `).order("created_at",{ascending:!1}).limit(50);if(k)throw k;t(p||[])}o(!1)}catch(U){y(U.message),o(!1)}}const m=async()=>{await J.auth.signOut(),window.location.href="/login.html"},I=()=>{t([...r,...e]),a([]),i(0)},j=async()=>{o(!0),await _(),a([]),i(0)};if(l)return L.jsx("div",{style:{textAlign:"center",padding:"40px"},children:L.jsx("p",{children:"Loading..."})});if(g)return L.jsxs("div",{className:"error",children:[L.jsx("strong",{children:"Error:"})," ",g]});if(h){const U=require("./ProfilePage").default;return L.jsxs(L.Fragment,{children:[L.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[L.jsx("button",{onClick:()=>b(null),className:"btn btn-secondary",children:" Back to Feed"}),L.jsx("a",{href:"/admin.html",children:"Admin"}),L.jsx("button",{onClick:m,className:"btn btn-secondary",children:"Sign Out"})]}),L.jsx(U,{profileId:h})]})}return L.jsxs(L.Fragment,{children:[L.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[L.jsx("button",{onClick:()=>b(S?.id||""),className:"btn btn-secondary",children:"My Profile"}),L.jsx("a",{href:"/admin.html",children:"Admin"}),L.jsx("button",{onClick:m,className:"btn btn-secondary",children:"Sign Out"})]}),L.jsxs("div",{style:{marginBottom:"30px"},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[L.jsx("h1",{style:{margin:0},children:"Family Feed"}),L.jsx("button",{onClick:j,className:"btn btn-secondary",style:{fontSize:"14px",padding:"6px 12px"},children:" Refresh"})]}),n>0&&L.jsxs("div",{onClick:I,style:{background:"#4A90E2",color:"white",padding:"12px",borderRadius:"8px",marginBottom:"15px",textAlign:"center",cursor:"pointer",fontWeight:500},children:[" ",n," new ",n===1?"post":"posts"," - Tap to view"]}),Ke,L.jsx("div",{className:"card",children:L.jsx(vt,{userId:S?.id||Ve,userAvatar:P?.avatar_url})})]}),L.jsxs("div",{children:[e.length===0&&L.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:L.jsx("p",{style:{color:"#999"},children:"No posts yet. Be the first to share something!"})}),e.map(U=>L.jsx(At,{post:U,currentUserId:S?.id||Ve,onProfileClick:T=>b(T)},U.id))]})]})}function At({post:S,currentUserId:R,onProfileClick:P}){const u=l=>{const o=new Date(l),y=new Date().getTime()-o.getTime(),n=Math.floor(y/(1e3*60*60)),i=Math.floor(n/24);return i>0?`${i}d ago`:n>0?`${n}h ago`:"Just now"},e=async()=>{if(confirm("Delete this post?"))try{if(S.media_urls&&S.media_urls.length>0)for(const l of S.media_urls){const o=l.split("/media/")[1];o&&await J.storage.from("media").remove([o])}await J.from("posts").delete().eq("id",S.id),window.location.reload()}catch{alert("Failed to delete post")}},t=S.user_id===R;return L.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"15px",gap:"10px"},children:[L.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flex:1,minWidth:0,cursor:"pointer"},onClick:()=>P?.(S.user_id),children:[S.profile?.avatar_url?L.jsx("img",{src:S.profile.avatar_url,alt:S.profile.display_name,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):L.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:S.profile?.display_name?.[0]?.toUpperCase()||"?"}),L.jsxs("div",{style:{minWidth:0,flex:1},children:[L.jsx("div",{style:{fontWeight:600,color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:S.profile?.display_name||"Unknown"}),L.jsx("div",{style:{fontSize:"13px",color:"#999"},children:u(S.created_at)})]})]}),t&&L.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"28px",color:"#999",cursor:"pointer",lineHeight:1,padding:0,width:"28px",height:"28px",flexShrink:0},title:"Delete post",children:""})]}),L.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:S.content}),S.media_urls&&S.media_urls.length>0&&L.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:S.media_urls.map((l,o)=>L.jsx("img",{src:l,alt:"Post media",style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px"}},o))}),L.jsx(xt,{postId:S.id,currentUserId:R}),L.jsx(wt,{postId:S.id,currentUserId:R})]})}export{Ct as default};
