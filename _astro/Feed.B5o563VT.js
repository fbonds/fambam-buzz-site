import{j as k,a as Q,g as Ye}from"./client-auth.DKJLJEpy.js";import{r as $}from"./index.D55ewHcJ.js";const Ke=!1,Ve="fletcher-dev-id";function dt(_,R){return R.forEach((function(D){D&&typeof D!="string"&&!Array.isArray(D)&&Object.keys(D).forEach((function(f){if(f!=="default"&&!(f in _)){var e=Object.getOwnPropertyDescriptor(D,f);Object.defineProperty(_,f,e.get?e:{enumerable:!0,get:function(){return D[f]}})}}))})),Object.freeze(_)}function Xe(_,R){return new Promise((function(D,f){let e;return ut(_).then((function(t){try{return e=t,D(new Blob([R.slice(0,2),e,R.slice(2)],{type:"image/jpeg"}))}catch(l){return f(l)}}),f)}))}const ut=_=>new Promise(((R,D)=>{const f=new FileReader;f.addEventListener("load",(({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return D("not a valid JPEG");for(l+=2;;){const o=t.getUint16(l);if(o===65498)break;const p=t.getUint16(l+2);if(o===65505&&t.getUint32(l+4)===1165519206){const x=l+10;let n;switch(t.getUint16(x)){case 18761:n=!0;break;case 19789:n=!1;break;default:return D("TIFF header contains invalid endian")}if(t.getUint16(x+2,n)!==42)return D("TIFF header contains invalid version");const i=t.getUint32(x+4,n),r=x+i+2+12*t.getUint16(x+i,n);for(let a=x+i+2;a<r;a+=12)if(t.getUint16(a,n)==274){if(t.getUint16(a+2,n)!==3)return D("Orientation data type is invalid");if(t.getUint32(a+4,n)!==1)return D("Orientation data count is invalid");t.setUint16(a+8,1,n);break}return R(e.slice(l,l+2+p))}l+=2+p}return R(new Blob)})),f.readAsArrayBuffer(_)}));var Te={},ht={get exports(){return Te},set exports(_){Te=_}};(function(_){var R,D,f={};ht.exports=f,f.parse=function(e,t){for(var l=f.bin.readUshort,o=f.bin.readUint,p=0,x={},n=new Uint8Array(e),i=n.length-4;o(n,i)!=101010256;)i--;p=i,p+=4;var r=l(n,p+=4);l(n,p+=2);var a=o(n,p+=2),h=o(n,p+=4);p+=4,p=h;for(var m=0;m<r;m++){o(n,p),p+=4,p+=4,p+=4,o(n,p+=4),a=o(n,p+=4);var w=o(n,p+=4),y=l(n,p+=4),I=l(n,p+2),F=l(n,p+4);p+=6;var U=o(n,p+=8);p+=4,p+=y+I+F,f._readLocal(n,U,x,a,w,t)}return x},f._readLocal=function(e,t,l,o,p,x){var n=f.bin.readUshort,i=f.bin.readUint;i(e,t),n(e,t+=4),n(e,t+=2);var r=n(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var a=n(e,t+=8),h=n(e,t+=2);t+=2;var m=f.bin.readUTF8(e,t,a);if(t+=a,t+=h,x)l[m]={size:p,csize:o};else{var w=new Uint8Array(e.buffer,t);if(r==0)l[m]=new Uint8Array(w.buffer.slice(t,t+o));else{if(r!=8)throw"unknown compression method: "+r;var y=new Uint8Array(p);f.inflateRaw(w,y),l[m]=y}}},f.inflateRaw=function(e,t){return f.F.inflate(e,t)},f.inflate=function(e,t){return e[0],e[1],f.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},f.deflate=function(e,t){t==null&&(t={level:6});var l=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[l]=120,o[l+1]=156,l+=2,l=f.F.deflateRaw(e,o,l,t.level);var p=f.adler(e,0,e.length);return o[l+0]=p>>>24&255,o[l+1]=p>>>16&255,o[l+2]=p>>>8&255,o[l+3]=p>>>0&255,new Uint8Array(o.buffer,0,l+4)},f.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),o=f.F.deflateRaw(e,l,o,t.level);return new Uint8Array(l.buffer,0,o)},f.encode=function(e,t){t==null&&(t=!1);var l=0,o=f.bin.writeUint,p=f.bin.writeUshort,x={};for(var n in e){var i=!f._noNeed(n)&&!t,r=e[n],a=f.crc.crc(r,0,r.length);x[n]={cpr:i,usize:r.length,crc:a,file:i?f.deflateRaw(r):r}}for(var n in x)l+=x[n].file.length+30+46+2*f.bin.sizeUTF8(n);l+=22;var h=new Uint8Array(l),m=0,w=[];for(var n in x){var y=x[n];w.push(m),m=f._writeHeader(h,m,n,y,0)}var I=0,F=m;for(var n in x)y=x[n],w.push(m),m=f._writeHeader(h,m,n,y,1,w[I++]);var U=m-F;return o(h,m,101010256),m+=4,p(h,m+=4,I),p(h,m+=2,I),o(h,m+=2,U),o(h,m+=4,F),m+=4,m+=2,h.buffer},f._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},f._writeHeader=function(e,t,l,o,p,x){var n=f.bin.writeUint,i=f.bin.writeUshort,r=o.file;return n(e,t,p==0?67324752:33639248),t+=4,p==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,o.cpr?8:0),n(e,t+=2,0),n(e,t+=4,o.crc),n(e,t+=4,r.length),n(e,t+=4,o.usize),i(e,t+=4,f.bin.sizeUTF8(l)),i(e,t+=2,0),t+=2,p==1&&(t+=2,t+=2,n(e,t+=6,x),t+=4),t+=f.bin.writeUTF8(e,t,l),p==0&&(e.set(r,t),t+=r.length),t},f.crc={table:(function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,o=0;o<8;o++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e})(),update:function(e,t,l,o){for(var p=0;p<o;p++)e=f.crc.table[255&(e^t[l+p])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^f.crc.update(4294967295,e,t,l)}},f.adler=function(e,t,l){for(var o=1,p=0,x=t,n=t+l;x<n;){for(var i=Math.min(x+5552,n);x<i;)p+=o+=e[x++];o%=65521,p%=65521}return p<<16|o},f.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var o="",p=0;p<l;p++)o+=String.fromCharCode(e[t+p]);return o},writeASCII:function(e,t,l){for(var o=0;o<l.length;o++)e[t+o]=l.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var o,p="",x=0;x<l;x++)p+="%"+f.bin.pad(e[t+x].toString(16));try{o=decodeURIComponent(p)}catch{return f.bin.readASCII(e,t,l)}return o},writeUTF8:function(e,t,l){for(var o=l.length,p=0,x=0;x<o;x++){var n=l.charCodeAt(x);if((4294967168&n)==0)e[t+p]=n,p++;else if((4294965248&n)==0)e[t+p]=192|n>>6,e[t+p+1]=128|n>>0&63,p+=2;else if((4294901760&n)==0)e[t+p]=224|n>>12,e[t+p+1]=128|n>>6&63,e[t+p+2]=128|n>>0&63,p+=3;else{if((4292870144&n)!=0)throw"e";e[t+p]=240|n>>18,e[t+p+1]=128|n>>12&63,e[t+p+2]=128|n>>6&63,e[t+p+3]=128|n>>0&63,p+=4}}return p},sizeUTF8:function(e){for(var t=e.length,l=0,o=0;o<t;o++){var p=e.charCodeAt(o);if((4294967168&p)==0)l++;else if((4294965248&p)==0)l+=2;else if((4294901760&p)==0)l+=3;else{if((4292870144&p)!=0)throw"e";l+=4}}return l}},f.F={},f.F.deflateRaw=function(e,t,l,o){var p=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],x=f.F.U,n=f.F._goodIndex;f.F._hash;var i=f.F._putsE,r=0,a=l<<3,h=0,m=e.length;if(o==0){for(;r<m;)i(t,a,r+(S=Math.min(65535,m-r))==m?1:0),a=f.F._copyExact(e,r,S,t,a+8),r+=S;return a>>>3}var w=x.lits,y=x.strt,I=x.prev,F=0,U=0,M=0,g=0,P=0,d=0;for(m>2&&(y[d=f.F._hash(e,0)]=0),r=0;r<m;r++){if(P=d,r+1<m-2){d=f.F._hash(e,r+1);var c=r+1&32767;I[c]=y[d],y[d]=c}if(h<=r){(F>14e3||U>26697)&&m-r>100&&(h<r&&(w[F]=r-h,F+=2,h=r),a=f.F._writeBlock(r==m-1||h==m?1:0,w,F,g,e,M,r-M,t,a),F=U=g=0,M=r);var v=0;r<m-2&&(v=f.F._bestMatch(e,r,I,P,Math.min(p[2],m-r),p[3]));var S=v>>>16,A=65535&v;if(v!=0){A=65535&v;var j=n(S=v>>>16,x.of0);x.lhst[257+j]++;var b=n(A,x.df0);x.dhst[b]++,g+=x.exb[j]+x.dxb[b],w[F]=S<<23|r-h,w[F+1]=A<<16|j<<8|b,F+=2,h=r+S}else x.lhst[e[r]]++;U++}}for(M==r&&e.length!=0||(h<r&&(w[F]=r-h,F+=2,h=r),a=f.F._writeBlock(1,w,F,g,e,M,r-M,t,a),F=0,U=0,F=U=g=0,M=r);(7&a)!=0;)a++;return a>>>3},f.F._bestMatch=function(e,t,l,o,p,x){var n=32767&t,i=l[n],r=n-i+32768&32767;if(i==n||o!=f.F._hash(e,t-r))return 0;for(var a=0,h=0,m=Math.min(32767,t);r<=m&&--x!=0&&i!=n;){if(a==0||e[t+a]==e[t+a-r]){var w=f.F._howLong(e,t,r);if(w>a){if(h=r,(a=w)>=p)break;r+2<w&&(w=r+2);for(var y=0,I=0;I<w-2;I++){var F=t-r+I+32768&32767,U=F-l[F]+32768&32767;U>y&&(y=U,i=F)}}}r+=(n=i)-(i=l[n])+32768&32767}return a<<16|h},f.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var o=t,p=Math.min(e.length,t+258);for(t+=3;t<p&&e[t]==e[t-l];)t++;return t-o},f.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},f.saved=0,f.F._writeBlock=function(e,t,l,o,p,x,n,i,r){var a,h,m,w,y,I,F,U,M,g=f.F.U,P=f.F._putsF,d=f.F._putsE;g.lhst[256]++,h=(a=f.F.getTrees())[0],m=a[1],w=a[2],y=a[3],I=a[4],F=a[5],U=a[6],M=a[7];var c=32+((r+3&7)==0?0:8-(r+3&7))+(n<<3),v=o+f.F.contSize(g.fltree,g.lhst)+f.F.contSize(g.fdtree,g.dhst),S=o+f.F.contSize(g.ltree,g.lhst)+f.F.contSize(g.dtree,g.dhst);S+=14+3*F+f.F.contSize(g.itree,g.ihst)+(2*g.ihst[16]+3*g.ihst[17]+7*g.ihst[18]);for(var A=0;A<286;A++)g.lhst[A]=0;for(A=0;A<30;A++)g.dhst[A]=0;for(A=0;A<19;A++)g.ihst[A]=0;var j=c<v&&c<S?0:v<S?1:2;if(P(i,r,e),P(i,r+1,j),r+=3,j==0){for(;(7&r)!=0;)r++;r=f.F._copyExact(p,x,n,i,r)}else{var b,E;if(j==1&&(b=g.fltree,E=g.fdtree),j==2){f.F.makeCodes(g.ltree,h),f.F.revCodes(g.ltree,h),f.F.makeCodes(g.dtree,m),f.F.revCodes(g.dtree,m),f.F.makeCodes(g.itree,w),f.F.revCodes(g.itree,w),b=g.ltree,E=g.dtree,d(i,r,y-257),d(i,r+=5,I-1),d(i,r+=5,F-4),r+=4;for(var u=0;u<F;u++)d(i,r+3*u,g.itree[1+(g.ordr[u]<<1)]);r+=3*F,r=f.F._codeTiny(U,g.itree,i,r),r=f.F._codeTiny(M,g.itree,i,r)}for(var s=x,z=0;z<l;z+=2){for(var C=t[z],O=C>>>23,B=s+(8388607&C);s<B;)r=f.F._writeLit(p[s++],b,i,r);if(O!=0){var L=t[z+1],H=L>>16,N=L>>8&255,T=255&L;d(i,r=f.F._writeLit(257+N,b,i,r),O-g.of0[N]),r+=g.exb[N],P(i,r=f.F._writeLit(T,E,i,r),H-g.df0[T]),r+=g.dxb[T],s+=O}}r=f.F._writeLit(256,b,i,r)}return r},f.F._copyExact=function(e,t,l,o,p){var x=p>>>3;return o[x]=l,o[x+1]=l>>>8,o[x+2]=255-o[x],o[x+3]=255-o[x+1],x+=4,o.set(new Uint8Array(e.buffer,t,l),x),p+(l+4<<3)},f.F.getTrees=function(){for(var e=f.F.U,t=f.F._hufTree(e.lhst,e.ltree,15),l=f.F._hufTree(e.dhst,e.dtree,15),o=[],p=f.F._lenCodes(e.ltree,o),x=[],n=f.F._lenCodes(e.dtree,x),i=0;i<o.length;i+=2)e.ihst[o[i]]++;for(i=0;i<x.length;i+=2)e.ihst[x[i]]++;for(var r=f.F._hufTree(e.ihst,e.itree,7),a=19;a>4&&e.itree[1+(e.ordr[a-1]<<1)]==0;)a--;return[t,l,r,p,n,a,o,x]},f.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},f.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},f.F.contSize=function(e,t){for(var l=0,o=0;o<t.length;o++)l+=t[o]*e[1+(o<<1)];return l},f.F._codeTiny=function(e,t,l,o){for(var p=0;p<e.length;p+=2){var x=e[p],n=e[p+1];o=f.F._writeLit(x,t,l,o);var i=x==16?2:x==17?3:7;x>15&&(f.F._putsE(l,o,n,i),o+=i)}return o},f.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var o=0;o<l;o+=2){var p=e[o+1],x=o+3<l?e[o+3]:-1,n=o+5<l?e[o+5]:-1,i=o==0?-1:e[o-1];if(p==0&&x==p&&n==p){for(var r=o+5;r+2<l&&e[r+2]==p;)r+=2;(a=Math.min(r+1-o>>>1,138))<11?t.push(17,a-3):t.push(18,a-11),o+=2*a-2}else if(p==i&&x==p&&n==p){for(r=o+5;r+2<l&&e[r+2]==p;)r+=2;var a=Math.min(r+1-o>>>1,6);t.push(16,a-3),o+=2*a-2}else t.push(p,0)}return l>>>1},f.F._hufTree=function(e,t,l){var o=[],p=e.length,x=t.length,n=0;for(n=0;n<x;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<p;n++)e[n]!=0&&o.push({lit:n,f:e[n]});var i=o.length,r=o.slice(0);if(i==0)return 0;if(i==1){var a=o[0].lit;return r=a==0?1:0,t[1+(a<<1)]=1,t[1+(r<<1)]=1,1}o.sort((function(U,M){return U.f-M.f}));var h=o[0],m=o[1],w=0,y=1,I=2;for(o[0]={lit:-1,f:h.f+m.f,l:h,r:m,d:0};y!=i-1;)h=w!=y&&(I==i||o[w].f<o[I].f)?o[w++]:o[I++],m=w!=y&&(I==i||o[w].f<o[I].f)?o[w++]:o[I++],o[y++]={lit:-1,f:h.f+m.f,l:h,r:m};var F=f.F.setDepth(o[y-1],0);for(F>l&&(f.F.restrictDepth(r,l,F),F=l),n=0;n<i;n++)t[1+(r[n].lit<<1)]=r[n].d;return F},f.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(f.F.setDepth(e.l,t+1),f.F.setDepth(e.r,t+1))},f.F.restrictDepth=function(e,t,l){var o=0,p=1<<l-t,x=0;for(e.sort((function(i,r){return r.d==i.d?i.f-r.f:r.d-i.d})),o=0;o<e.length&&e[o].d>t;o++){var n=e[o].d;e[o].d=t,x+=p-(1<<l-n)}for(x>>>=l-t;x>0;)(n=e[o].d)<t?(e[o].d++,x-=1<<t-n-1):o++;for(;o>=0;o--)e[o].d==t&&x<0&&(e[o].d--,x++);x!=0&&console.log("debt left")},f.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},f.F._writeLit=function(e,t,l,o){return f.F._putsF(l,o,t[e<<1]),o+t[1+(e<<1)]},f.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var o=f.F,p=o._bitsF,x=o._bitsE,n=o._decodeTiny,i=o.makeCodes,r=o.codes2map,a=o._get17,h=o.U,m=t==null;m&&(t=new l(e.length>>>2<<3));for(var w,y,I=0,F=0,U=0,M=0,g=0,P=0,d=0,c=0,v=0;I==0;)if(I=p(e,v,1),F=p(e,v+1,2),v+=3,F!=0){if(m&&(t=f.F._check(t,c+(1<<17))),F==1&&(w=h.flmap,y=h.fdmap,P=511,d=31),F==2){U=x(e,v,5)+257,M=x(e,v+5,5)+1,g=x(e,v+10,4)+4,v+=14;for(var S=0;S<38;S+=2)h.itree[S]=0,h.itree[S+1]=0;var A=1;for(S=0;S<g;S++){var j=x(e,v+3*S,3);h.itree[1+(h.ordr[S]<<1)]=j,j>A&&(A=j)}v+=3*g,i(h.itree,A),r(h.itree,A,h.imap),w=h.lmap,y=h.dmap,v=n(h.imap,(1<<A)-1,U+M,e,v,h.ttree);var b=o._copyOut(h.ttree,0,U,h.ltree);P=(1<<b)-1;var E=o._copyOut(h.ttree,U,M,h.dtree);d=(1<<E)-1,i(h.ltree,b),r(h.ltree,b,w),i(h.dtree,E),r(h.dtree,E,y)}for(;;){var u=w[a(e,v)&P];v+=15&u;var s=u>>>4;if(!(s>>>8))t[c++]=s;else{if(s==256)break;var z=c+s-254;if(s>264){var C=h.ldef[s-257];z=c+(C>>>3)+x(e,v,7&C),v+=7&C}var O=y[a(e,v)&d];v+=15&O;var B=O>>>4,L=h.ddef[B],H=(L>>>4)+p(e,v,15&L);for(v+=15&L,m&&(t=f.F._check(t,c+(1<<17)));c<z;)t[c]=t[c++-H],t[c]=t[c++-H],t[c]=t[c++-H],t[c]=t[c++-H];c=z}}}else{(7&v)!=0&&(v+=8-(7&v));var N=4+(v>>>3),T=e[N-4]|e[N-3]<<8;m&&(t=f.F._check(t,c+T)),t.set(new l(e.buffer,e.byteOffset+N,T),c),v=N+T<<3,c+=T}return t.length==c?t:t.slice(0,c)},f.F._check=function(e,t){var l=e.length;if(t<=l)return e;var o=new Uint8Array(Math.max(l<<1,t));return o.set(e,0),o},f.F._decodeTiny=function(e,t,l,o,p,x){for(var n=f.F._bitsE,i=f.F._get17,r=0;r<l;){var a=e[i(o,p)&t];p+=15&a;var h=a>>>4;if(h<=15)x[r]=h,r++;else{var m=0,w=0;h==16?(w=3+n(o,p,2),p+=2,m=x[r-1]):h==17?(w=3+n(o,p,3),p+=3):h==18&&(w=11+n(o,p,7),p+=7);for(var y=r+w;r<y;)x[r]=m,r++}}return p},f.F._copyOut=function(e,t,l,o){for(var p=0,x=0,n=o.length>>>1;x<l;){var i=e[x+t];o[x<<1]=0,o[1+(x<<1)]=i,i>p&&(p=i),x++}for(;x<n;)o[x<<1]=0,o[1+(x<<1)]=0,x++;return p},f.F.makeCodes=function(e,t){for(var l,o,p,x,n=f.F.U,i=e.length,r=n.bl_count,a=0;a<=t;a++)r[a]=0;for(a=1;a<i;a+=2)r[e[a]]++;var h=n.next_code;for(l=0,r[0]=0,o=1;o<=t;o++)l=l+r[o-1]<<1,h[o]=l;for(p=0;p<i;p+=2)(x=e[p+1])!=0&&(e[p]=h[x],h[x]++)},f.F.codes2map=function(e,t,l){for(var o=e.length,p=f.F.U.rev15,x=0;x<o;x+=2)if(e[x+1]!=0)for(var n=x>>1,i=e[x+1],r=n<<4|i,a=t-i,h=e[x]<<a,m=h+(1<<a);h!=m;)l[p[h]>>>15-t]=r,h++},f.F.revCodes=function(e,t){for(var l=f.F.U.rev15,o=15-t,p=0;p<e.length;p+=2){var x=e[p]<<t-e[p+1];e[p]=l[x]>>>o}},f.F._putsE=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8},f.F._putsF=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8,e[o+2]|=l>>>16},f.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},f.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},f.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},f.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},f.F.U=(R=Uint16Array,D=Uint32Array,{next_code:new R(16),bl_count:new R(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new R(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new D(32),flmap:new R(512),fltree:[],fdmap:new R(32),fdtree:[],lmap:new R(32768),ltree:[],ttree:[],dmap:new R(32768),dtree:[],imap:new R(512),itree:[],rev15:new R(32768),lhst:new D(286),dhst:new D(30),ihst:new D(19),lits:new D(15e3),strt:new R(65536),prev:new R(32768)}),(function(){for(var e=f.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function o(p,x,n){for(;x--!=0;)p.push(0,n)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),f.F.makeCodes(e.fltree,9),f.F.codes2map(e.fltree,9,e.flmap),f.F.revCodes(e.fltree,9),o(e.fdtree,32,5),f.F.makeCodes(e.fdtree,5),f.F.codes2map(e.fdtree,5,e.fdmap),f.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)})()})();var pt=dt({__proto__:null,default:Te},[Te]);const ge=(function(){var _={nextZero(n,i){for(;n[i]!=0;)i++;return i},readUshort:(n,i)=>n[i]<<8|n[i+1],writeUshort(n,i,r){n[i]=r>>8&255,n[i+1]=255&r},readUint:(n,i)=>16777216*n[i]+(n[i+1]<<16|n[i+2]<<8|n[i+3]),writeUint(n,i,r){n[i]=r>>24&255,n[i+1]=r>>16&255,n[i+2]=r>>8&255,n[i+3]=255&r},readASCII(n,i,r){let a="";for(let h=0;h<r;h++)a+=String.fromCharCode(n[i+h]);return a},writeASCII(n,i,r){for(let a=0;a<r.length;a++)n[i+a]=r.charCodeAt(a)},readBytes(n,i,r){const a=[];for(let h=0;h<r;h++)a.push(n[i+h]);return a},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,i,r){let a,h="";for(let m=0;m<r;m++)h+=`%${_.pad(n[i+m].toString(16))}`;try{a=decodeURIComponent(h)}catch{return _.readASCII(n,i,r)}return a}};function R(n,i,r,a){const h=i*r,m=t(a),w=Math.ceil(i*m/8),y=new Uint8Array(4*h),I=new Uint32Array(y.buffer),{ctype:F}=a,{depth:U}=a,M=_.readUshort;if(F==6){const C=h<<2;if(U==8)for(var g=0;g<C;g+=4)y[g]=n[g],y[g+1]=n[g+1],y[g+2]=n[g+2],y[g+3]=n[g+3];if(U==16)for(g=0;g<C;g++)y[g]=n[g<<1]}else if(F==2){const C=a.tabs.tRNS;if(C==null){if(U==8)for(g=0;g<h;g++){var P=3*g;I[g]=255<<24|n[P+2]<<16|n[P+1]<<8|n[P]}if(U==16)for(g=0;g<h;g++)P=6*g,I[g]=255<<24|n[P+4]<<16|n[P+2]<<8|n[P]}else{var d=C[0];const O=C[1],B=C[2];if(U==8)for(g=0;g<h;g++){var c=g<<2;P=3*g,I[g]=255<<24|n[P+2]<<16|n[P+1]<<8|n[P],n[P]==d&&n[P+1]==O&&n[P+2]==B&&(y[c+3]=0)}if(U==16)for(g=0;g<h;g++)c=g<<2,P=6*g,I[g]=255<<24|n[P+4]<<16|n[P+2]<<8|n[P],M(n,P)==d&&M(n,P+2)==O&&M(n,P+4)==B&&(y[c+3]=0)}}else if(F==3){const C=a.tabs.PLTE,O=a.tabs.tRNS,B=O?O.length:0;if(U==1)for(var v=0;v<r;v++){var S=v*w,A=v*i;for(g=0;g<i;g++){c=A+g<<2;var j=3*(b=n[S+(g>>3)]>>7-((7&g)<<0)&1);y[c]=C[j],y[c+1]=C[j+1],y[c+2]=C[j+2],y[c+3]=b<B?O[b]:255}}if(U==2)for(v=0;v<r;v++)for(S=v*w,A=v*i,g=0;g<i;g++)c=A+g<<2,j=3*(b=n[S+(g>>2)]>>6-((3&g)<<1)&3),y[c]=C[j],y[c+1]=C[j+1],y[c+2]=C[j+2],y[c+3]=b<B?O[b]:255;if(U==4)for(v=0;v<r;v++)for(S=v*w,A=v*i,g=0;g<i;g++)c=A+g<<2,j=3*(b=n[S+(g>>1)]>>4-((1&g)<<2)&15),y[c]=C[j],y[c+1]=C[j+1],y[c+2]=C[j+2],y[c+3]=b<B?O[b]:255;if(U==8)for(g=0;g<h;g++){var b;c=g<<2,j=3*(b=n[g]),y[c]=C[j],y[c+1]=C[j+1],y[c+2]=C[j+2],y[c+3]=b<B?O[b]:255}}else if(F==4){if(U==8)for(g=0;g<h;g++){c=g<<2;var E=n[u=g<<1];y[c]=E,y[c+1]=E,y[c+2]=E,y[c+3]=n[u+1]}if(U==16)for(g=0;g<h;g++){var u;c=g<<2,E=n[u=g<<2],y[c]=E,y[c+1]=E,y[c+2]=E,y[c+3]=n[u+2]}}else if(F==0)for(d=a.tabs.tRNS?a.tabs.tRNS:-1,v=0;v<r;v++){const C=v*w,O=v*i;if(U==1)for(var s=0;s<i;s++){var z=(E=255*(n[C+(s>>>3)]>>>7-(7&s)&1))==255*d?0:255;I[O+s]=z<<24|E<<16|E<<8|E}else if(U==2)for(s=0;s<i;s++)z=(E=85*(n[C+(s>>>2)]>>>6-((3&s)<<1)&3))==85*d?0:255,I[O+s]=z<<24|E<<16|E<<8|E;else if(U==4)for(s=0;s<i;s++)z=(E=17*(n[C+(s>>>1)]>>>4-((1&s)<<2)&15))==17*d?0:255,I[O+s]=z<<24|E<<16|E<<8|E;else if(U==8)for(s=0;s<i;s++)z=(E=n[C+s])==d?0:255,I[O+s]=z<<24|E<<16|E<<8|E;else if(U==16)for(s=0;s<i;s++)E=n[C+(s<<1)],z=M(n,C+(s<<1))==d?0:255,I[O+s]=z<<24|E<<16|E<<8|E}return y}function D(n,i,r,a){const h=t(n),m=Math.ceil(r*h/8),w=new Uint8Array((m+1+n.interlace)*a);return i=n.tabs.CgBI?e(i,w):f(i,w),n.interlace==0?i=l(i,n,0,r,a):n.interlace==1&&(i=(function(I,F){const U=F.width,M=F.height,g=t(F),P=g>>3,d=Math.ceil(U*g/8),c=new Uint8Array(M*d);let v=0;const S=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],j=[8,8,8,4,4,2,2],b=[8,8,4,4,2,2,1];let E=0;for(;E<7;){const s=j[E],z=b[E];let C=0,O=0,B=S[E];for(;B<M;)B+=s,O++;let L=A[E];for(;L<U;)L+=z,C++;const H=Math.ceil(C*g/8);l(I,F,v,C,O);let N=0,T=S[E];for(;T<M;){let W=A[E],Y=v+N*H<<3;for(;W<U;){var u;if(g==1&&(u=(u=I[Y>>3])>>7-(7&Y)&1,c[T*d+(W>>3)]|=u<<7-((7&W)<<0)),g==2&&(u=(u=I[Y>>3])>>6-(7&Y)&3,c[T*d+(W>>2)]|=u<<6-((3&W)<<1)),g==4&&(u=(u=I[Y>>3])>>4-(7&Y)&15,c[T*d+(W>>1)]|=u<<4-((1&W)<<2)),g>=8){const G=T*d+W*P;for(let q=0;q<P;q++)c[G+q]=I[(Y>>3)+q]}Y+=g,W+=z}N++,T+=s}C*O!=0&&(v+=O*(1+H)),E+=1}return c})(i,n)),i}function f(n,i){return e(new Uint8Array(n.buffer,2,n.length-6),i)}var e=(function(){const n={H:{}};return n.H.N=function(i,r){const a=Uint8Array;let h,m,w=0,y=0,I=0,F=0,U=0,M=0,g=0,P=0,d=0;if(i[0]==3&&i[1]==0)return r||new a(0);const c=n.H,v=c.b,S=c.e,A=c.R,j=c.n,b=c.A,E=c.Z,u=c.m,s=r==null;for(s&&(r=new a(i.length>>>2<<5));w==0;)if(w=v(i,d,1),y=v(i,d+1,2),d+=3,y!=0){if(s&&(r=n.H.W(r,P+(1<<17))),y==1&&(h=u.J,m=u.h,M=511,g=31),y==2){I=S(i,d,5)+257,F=S(i,d+5,5)+1,U=S(i,d+10,4)+4,d+=14;let C=1;for(var z=0;z<38;z+=2)u.Q[z]=0,u.Q[z+1]=0;for(z=0;z<U;z++){const L=S(i,d+3*z,3);u.Q[1+(u.X[z]<<1)]=L,L>C&&(C=L)}d+=3*U,j(u.Q,C),b(u.Q,C,u.u),h=u.w,m=u.d,d=A(u.u,(1<<C)-1,I+F,i,d,u.v);const O=c.V(u.v,0,I,u.C);M=(1<<O)-1;const B=c.V(u.v,I,F,u.D);g=(1<<B)-1,j(u.C,O),b(u.C,O,h),j(u.D,B),b(u.D,B,m)}for(;;){const C=h[E(i,d)&M];d+=15&C;const O=C>>>4;if(!(O>>>8))r[P++]=O;else{if(O==256)break;{let B=P+O-254;if(O>264){const W=u.q[O-257];B=P+(W>>>3)+S(i,d,7&W),d+=7&W}const L=m[E(i,d)&g];d+=15&L;const H=L>>>4,N=u.c[H],T=(N>>>4)+v(i,d,15&N);for(d+=15&N;P<B;)r[P]=r[P++-T],r[P]=r[P++-T],r[P]=r[P++-T],r[P]=r[P++-T];P=B}}}}else{(7&d)!=0&&(d+=8-(7&d));const C=4+(d>>>3),O=i[C-4]|i[C-3]<<8;s&&(r=n.H.W(r,P+O)),r.set(new a(i.buffer,i.byteOffset+C,O),P),d=C+O<<3,P+=O}return r.length==P?r:r.slice(0,P)},n.H.W=function(i,r){const a=i.length;if(r<=a)return i;const h=new Uint8Array(a<<1);return h.set(i,0),h},n.H.R=function(i,r,a,h,m,w){const y=n.H.e,I=n.H.Z;let F=0;for(;F<a;){const U=i[I(h,m)&r];m+=15&U;const M=U>>>4;if(M<=15)w[F]=M,F++;else{let g=0,P=0;M==16?(P=3+y(h,m,2),m+=2,g=w[F-1]):M==17?(P=3+y(h,m,3),m+=3):M==18&&(P=11+y(h,m,7),m+=7);const d=F+P;for(;F<d;)w[F]=g,F++}}return m},n.H.V=function(i,r,a,h){let m=0,w=0;const y=h.length>>>1;for(;w<a;){const I=i[w+r];h[w<<1]=0,h[1+(w<<1)]=I,I>m&&(m=I),w++}for(;w<y;)h[w<<1]=0,h[1+(w<<1)]=0,w++;return m},n.H.n=function(i,r){const a=n.H.m,h=i.length;let m,w,y,I;const F=a.j;for(var U=0;U<=r;U++)F[U]=0;for(U=1;U<h;U+=2)F[i[U]]++;const M=a.K;for(m=0,F[0]=0,w=1;w<=r;w++)m=m+F[w-1]<<1,M[w]=m;for(y=0;y<h;y+=2)I=i[y+1],I!=0&&(i[y]=M[I],M[I]++)},n.H.A=function(i,r,a){const h=i.length,m=n.H.m.r;for(let w=0;w<h;w+=2)if(i[w+1]!=0){const y=w>>1,I=i[w+1],F=y<<4|I,U=r-I;let M=i[w]<<U;const g=M+(1<<U);for(;M!=g;)a[m[M]>>>15-r]=F,M++}},n.H.l=function(i,r){const a=n.H.m.r,h=15-r;for(let m=0;m<i.length;m+=2){const w=i[m]<<r-i[m+1];i[m]=a[w]>>>h}},n.H.M=function(i,r,a){a<<=7&r;const h=r>>>3;i[h]|=a,i[h+1]|=a>>>8},n.H.I=function(i,r,a){a<<=7&r;const h=r>>>3;i[h]|=a,i[h+1]|=a>>>8,i[h+2]|=a>>>16},n.H.e=function(i,r,a){return(i[r>>>3]|i[1+(r>>>3)]<<8)>>>(7&r)&(1<<a)-1},n.H.b=function(i,r,a){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)&(1<<a)-1},n.H.Z=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16|i[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=(function(){const i=Uint16Array,r=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=n.H.m;for(var r=0;r<32768;r++){let h=r;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[r]=(h>>>16|h<<16)>>>17}function a(h,m,w){for(;m--!=0;)h.push(0,w)}for(r=0;r<32;r++)i.q[r]=i.S[r]<<3|i.T[r],i.c[r]=i.p[r]<<4|i.z[r];a(i._,144,8),a(i._,112,9),a(i._,24,7),a(i._,8,8),n.H.n(i._,9),n.H.A(i._,9,i.J),n.H.l(i._,9),a(i.$,32,5),n.H.n(i.$,5),n.H.A(i.$,5,i.h),n.H.l(i.$,5),a(i.Q,19,0),a(i.C,286,0),a(i.D,30,0),a(i.v,320,0)})(),n.H.N})();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function l(n,i,r,a,h){let m=t(i);const w=Math.ceil(a*m/8);let y,I;m=Math.ceil(m/8);let F=n[r],U=0;if(F>1&&(n[r]=[0,0,1][F-2]),F==3)for(U=m;U<w;U++)n[U+1]=n[U+1]+(n[U+1-m]>>>1)&255;for(let M=0;M<h;M++)if(y=r+M*w,I=y+M+1,F=n[I-1],U=0,F==0)for(;U<w;U++)n[y+U]=n[I+U];else if(F==1){for(;U<m;U++)n[y+U]=n[I+U];for(;U<w;U++)n[y+U]=n[I+U]+n[y+U-m]}else if(F==2)for(;U<w;U++)n[y+U]=n[I+U]+n[y+U-w];else if(F==3){for(;U<m;U++)n[y+U]=n[I+U]+(n[y+U-w]>>>1);for(;U<w;U++)n[y+U]=n[I+U]+(n[y+U-w]+n[y+U-m]>>>1)}else{for(;U<m;U++)n[y+U]=n[I+U]+o(0,n[y+U-w],0);for(;U<w;U++)n[y+U]=n[I+U]+o(n[y+U-m],n[y+U-w],n[y+U-m-w])}return n}function o(n,i,r){const a=n+i-r,h=a-n,m=a-i,w=a-r;return h*h<=m*m&&h*h<=w*w?n:m*m<=w*w?i:r}function p(n,i,r){r.width=_.readUint(n,i),i+=4,r.height=_.readUint(n,i),i+=4,r.depth=n[i],i++,r.ctype=n[i],i++,r.compress=n[i],i++,r.filter=n[i],i++,r.interlace=n[i],i++}function x(n,i,r,a,h,m,w,y,I){const F=Math.min(i,h),U=Math.min(r,m);let M=0,g=0;for(let E=0;E<U;E++)for(let u=0;u<F;u++)if(w>=0&&y>=0?(M=E*i+u<<2,g=(y+E)*h+w+u<<2):(M=(-y+E)*i-w+u<<2,g=E*h+u<<2),I==0)a[g]=n[M],a[g+1]=n[M+1],a[g+2]=n[M+2],a[g+3]=n[M+3];else if(I==1){var P=n[M+3]*.00392156862745098,d=n[M]*P,c=n[M+1]*P,v=n[M+2]*P,S=a[g+3]*(1/255),A=a[g]*S,j=a[g+1]*S,b=a[g+2]*S;const s=1-P,z=P+S*s,C=z==0?0:1/z;a[g+3]=255*z,a[g+0]=(d+A*s)*C,a[g+1]=(c+j*s)*C,a[g+2]=(v+b*s)*C}else if(I==2)P=n[M+3],d=n[M],c=n[M+1],v=n[M+2],S=a[g+3],A=a[g],j=a[g+1],b=a[g+2],P==S&&d==A&&c==j&&v==b?(a[g]=0,a[g+1]=0,a[g+2]=0,a[g+3]=0):(a[g]=d,a[g+1]=c,a[g+2]=v,a[g+3]=P);else if(I==3){if(P=n[M+3],d=n[M],c=n[M+1],v=n[M+2],S=a[g+3],A=a[g],j=a[g+1],b=a[g+2],P==S&&d==A&&c==j&&v==b)continue;if(P<220&&S>20)return!1}return!0}return{decode:function(i){const r=new Uint8Array(i);let a=8;const h=_,m=h.readUshort,w=h.readUint,y={tabs:{},frames:[]},I=new Uint8Array(r.length);let F,U=0,M=0;const g=[137,80,78,71,13,10,26,10];for(var P=0;P<8;P++)if(r[P]!=g[P])throw"The input is not a PNG file!";for(;a<r.length;){const E=h.readUint(r,a);a+=4;const u=h.readASCII(r,a,4);if(a+=4,u=="IHDR")p(r,a,y);else if(u=="iCCP"){for(var d=a;r[d]!=0;)d++;h.readASCII(r,a,d-a),r[d+1];const s=r.slice(d+2,a+E);let z=null;try{z=f(s)}catch{z=e(s)}y.tabs[u]=z}else if(u=="CgBI")y.tabs[u]=r.slice(a,a+4);else if(u=="IDAT"){for(P=0;P<E;P++)I[U+P]=r[a+P];U+=E}else if(u=="acTL")y.tabs[u]={num_frames:w(r,a),num_plays:w(r,a+4)},F=new Uint8Array(r.length);else if(u=="fcTL"){M!=0&&((b=y.frames[y.frames.length-1]).data=D(y,F.slice(0,M),b.rect.width,b.rect.height),M=0);const s={x:w(r,a+12),y:w(r,a+16),width:w(r,a+4),height:w(r,a+8)};let z=m(r,a+22);z=m(r,a+20)/(z==0?100:z);const C={rect:s,delay:Math.round(1e3*z),dispose:r[a+24],blend:r[a+25]};y.frames.push(C)}else if(u=="fdAT"){for(P=0;P<E-4;P++)F[M+P]=r[a+P+4];M+=E-4}else if(u=="pHYs")y.tabs[u]=[h.readUint(r,a),h.readUint(r,a+4),r[a+8]];else if(u=="cHRM")for(y.tabs[u]=[],P=0;P<8;P++)y.tabs[u].push(h.readUint(r,a+4*P));else if(u=="tEXt"||u=="zTXt"){y.tabs[u]==null&&(y.tabs[u]={});var c=h.nextZero(r,a),v=h.readASCII(r,a,c-a),S=a+E-c-1;if(u=="tEXt")j=h.readASCII(r,c+1,S);else{var A=f(r.slice(c+2,c+2+S));j=h.readUTF8(A,0,A.length)}y.tabs[u][v]=j}else if(u=="iTXt"){y.tabs[u]==null&&(y.tabs[u]={}),c=0,d=a,c=h.nextZero(r,d),v=h.readASCII(r,d,c-d);const s=r[d=c+1];var j;r[d+1],d+=2,c=h.nextZero(r,d),h.readASCII(r,d,c-d),d=c+1,c=h.nextZero(r,d),h.readUTF8(r,d,c-d),S=E-((d=c+1)-a),s==0?j=h.readUTF8(r,d,S):(A=f(r.slice(d,d+S)),j=h.readUTF8(A,0,A.length)),y.tabs[u][v]=j}else if(u=="PLTE")y.tabs[u]=h.readBytes(r,a,E);else if(u=="hIST"){const s=y.tabs.PLTE.length/3;for(y.tabs[u]=[],P=0;P<s;P++)y.tabs[u].push(m(r,a+2*P))}else if(u=="tRNS")y.ctype==3?y.tabs[u]=h.readBytes(r,a,E):y.ctype==0?y.tabs[u]=m(r,a):y.ctype==2&&(y.tabs[u]=[m(r,a),m(r,a+2),m(r,a+4)]);else if(u=="gAMA")y.tabs[u]=h.readUint(r,a)/1e5;else if(u=="sRGB")y.tabs[u]=r[a];else if(u=="bKGD")y.ctype==0||y.ctype==4?y.tabs[u]=[m(r,a)]:y.ctype==2||y.ctype==6?y.tabs[u]=[m(r,a),m(r,a+2),m(r,a+4)]:y.ctype==3&&(y.tabs[u]=r[a]);else if(u=="IEND")break;a+=E,h.readUint(r,a),a+=4}var b;return M!=0&&((b=y.frames[y.frames.length-1]).data=D(y,F.slice(0,M),b.rect.width,b.rect.height)),y.data=D(y,I,y.width,y.height),delete y.compress,delete y.interlace,delete y.filter,y},toRGBA8:function(i){const r=i.width,a=i.height;if(i.tabs.acTL==null)return[R(i.data,r,a,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const m=r*a*4,w=new Uint8Array(m),y=new Uint8Array(m),I=new Uint8Array(m);for(let U=0;U<i.frames.length;U++){const M=i.frames[U],g=M.rect.x,P=M.rect.y,d=M.rect.width,c=M.rect.height,v=R(M.data,d,c,i);if(U!=0)for(var F=0;F<m;F++)I[F]=w[F];if(M.blend==0?x(v,d,c,w,r,a,g,P,0):M.blend==1&&x(v,d,c,w,r,a,g,P,1),h.push(w.buffer.slice(0)),M.dispose!=0){if(M.dispose==1)x(y,d,c,w,r,a,g,P,0);else if(M.dispose==2)for(F=0;F<m;F++)w[F]=I[F]}}return h},_paeth:o,_copyTile:x,_bin:_}})();(function(){const{_copyTile:_}=ge,{_bin:R}=ge,D=ge._paeth;var f={table:(function(){const d=new Uint32Array(256);for(let c=0;c<256;c++){let v=c;for(let S=0;S<8;S++)1&v?v=3988292384^v>>>1:v>>>=1;d[c]=v}return d})(),update(d,c,v,S){for(let A=0;A<S;A++)d=f.table[255&(d^c[v+A])]^d>>>8;return d},crc:(d,c,v)=>4294967295^f.update(4294967295,d,c,v)};function e(d,c,v,S){c[v]+=d[0]*S>>4,c[v+1]+=d[1]*S>>4,c[v+2]+=d[2]*S>>4,c[v+3]+=d[3]*S>>4}function t(d){return Math.max(0,Math.min(255,d))}function l(d,c){const v=d[0]-c[0],S=d[1]-c[1],A=d[2]-c[2],j=d[3]-c[3];return v*v+S*S+A*A+j*j}function o(d,c,v,S,A,j,b){b==null&&(b=1);const E=S.length,u=[];for(var s=0;s<E;s++){const T=S[s];u.push([T>>>0&255,T>>>8&255,T>>>16&255,T>>>24&255])}for(s=0;s<E;s++){let T=4294967295;for(var z=0,C=0;C<E;C++){var O=l(u[s],u[C]);C!=s&&O<T&&(T=O,z=C)}}const B=new Uint32Array(A.buffer),L=new Int16Array(c*v*4),H=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(s=0;s<H.length;s++)H[s]=255*((H[s]+.5)/16-.5);for(let T=0;T<v;T++)for(let W=0;W<c;W++){var N;s=4*(T*c+W),b!=2?N=[t(d[s]+L[s]),t(d[s+1]+L[s+1]),t(d[s+2]+L[s+2]),t(d[s+3]+L[s+3])]:(O=H[4*(3&T)+(3&W)],N=[t(d[s]+O),t(d[s+1]+O),t(d[s+2]+O),t(d[s+3]+O)]),z=0;let Y=16777215;for(C=0;C<E;C++){const K=l(N,u[C]);K<Y&&(Y=K,z=C)}const G=u[z],q=[N[0]-G[0],N[1]-G[1],N[2]-G[2],N[3]-G[3]];b==1&&(W!=c-1&&e(q,L,s+4,7),T!=v-1&&(W!=0&&e(q,L,s+4*c-4,3),e(q,L,s+4*c,5),W!=c-1&&e(q,L,s+4*c+4,1))),j[s>>2]=z,B[s>>2]=S[z]}}function p(d,c,v,S,A){A==null&&(A={});const{crc:j}=f,b=R.writeUint,E=R.writeUshort,u=R.writeASCII;let s=8;const z=d.frames.length>1;let C,O=!1,B=33+(z?20:0);if(A.sRGB!=null&&(B+=13),A.pHYs!=null&&(B+=21),A.iCCP!=null&&(C=pako.deflate(A.iCCP),B+=21+C.length+4),d.ctype==3){for(var L=d.plte.length,H=0;H<L;H++)d.plte[H]>>>24!=255&&(O=!0);B+=8+3*L+4+(O?8+1*L+4:0)}for(var N=0;N<d.frames.length;N++)z&&(B+=38),B+=(G=d.frames[N]).cimg.length+12,N!=0&&(B+=4);B+=12;const T=new Uint8Array(B),W=[137,80,78,71,13,10,26,10];for(H=0;H<8;H++)T[H]=W[H];if(b(T,s,13),s+=4,u(T,s,"IHDR"),s+=4,b(T,s,c),s+=4,b(T,s,v),s+=4,T[s]=d.depth,s++,T[s]=d.ctype,s++,T[s]=0,s++,T[s]=0,s++,T[s]=0,s++,b(T,s,j(T,s-17,17)),s+=4,A.sRGB!=null&&(b(T,s,1),s+=4,u(T,s,"sRGB"),s+=4,T[s]=A.sRGB,s++,b(T,s,j(T,s-5,5)),s+=4),A.iCCP!=null){const q=13+C.length;b(T,s,q),s+=4,u(T,s,"iCCP"),s+=4,u(T,s,"ICC profile"),s+=11,s+=2,T.set(C,s),s+=C.length,b(T,s,j(T,s-(q+4),q+4)),s+=4}if(A.pHYs!=null&&(b(T,s,9),s+=4,u(T,s,"pHYs"),s+=4,b(T,s,A.pHYs[0]),s+=4,b(T,s,A.pHYs[1]),s+=4,T[s]=A.pHYs[2],s++,b(T,s,j(T,s-13,13)),s+=4),z&&(b(T,s,8),s+=4,u(T,s,"acTL"),s+=4,b(T,s,d.frames.length),s+=4,b(T,s,A.loop!=null?A.loop:0),s+=4,b(T,s,j(T,s-12,12)),s+=4),d.ctype==3){for(b(T,s,3*(L=d.plte.length)),s+=4,u(T,s,"PLTE"),s+=4,H=0;H<L;H++){const q=3*H,K=d.plte[H],ee=255&K,re=K>>>8&255,_e=K>>>16&255;T[s+q+0]=ee,T[s+q+1]=re,T[s+q+2]=_e}if(s+=3*L,b(T,s,j(T,s-3*L-4,3*L+4)),s+=4,O){for(b(T,s,L),s+=4,u(T,s,"tRNS"),s+=4,H=0;H<L;H++)T[s+H]=d.plte[H]>>>24&255;s+=L,b(T,s,j(T,s-L-4,L+4)),s+=4}}let Y=0;for(N=0;N<d.frames.length;N++){var G=d.frames[N];z&&(b(T,s,26),s+=4,u(T,s,"fcTL"),s+=4,b(T,s,Y++),s+=4,b(T,s,G.rect.width),s+=4,b(T,s,G.rect.height),s+=4,b(T,s,G.rect.x),s+=4,b(T,s,G.rect.y),s+=4,E(T,s,S[N]),s+=2,E(T,s,1e3),s+=2,T[s]=G.dispose,s++,T[s]=G.blend,s++,b(T,s,j(T,s-30,30)),s+=4);const q=G.cimg;b(T,s,(L=q.length)+(N==0?0:4)),s+=4;const K=s;u(T,s,N==0?"IDAT":"fdAT"),s+=4,N!=0&&(b(T,s,Y++),s+=4),T.set(q,s),s+=L,b(T,s,j(T,K,s-K)),s+=4}return b(T,s,0),s+=4,u(T,s,"IEND"),s+=4,b(T,s,j(T,s-4,4)),s+=4,T.buffer}function x(d,c,v){for(let S=0;S<d.frames.length;S++){const A=d.frames[S];A.rect.width;const j=A.rect.height,b=new Uint8Array(j*A.bpl+j);A.cimg=a(A.img,j,A.bpp,A.bpl,b,c,v)}}function n(d,c,v,S,A){const j=A[0],b=A[1],E=A[2],u=A[3],s=A[4],z=A[5];let C=6,O=8,B=255;for(var L=0;L<d.length;L++){const oe=new Uint8Array(d[L]);for(var H=oe.length,N=0;N<H;N+=4)B&=oe[N+3]}const T=B!=255,W=(function(X,V,ie,le,te,de){const ne=[];for(var Z=0;Z<X.length;Z++){const fe=new Uint8Array(X[Z]),pe=new Uint32Array(fe.buffer);var ue;let he=0,be=0,xe=V,Ue=ie,Le=le?1:0;if(Z!=0){const ft=de||le||Z==1||ne[Z-2].dispose!=0?1:2;let He=0,Qe=1e9;for(let ke=0;ke<ft;ke++){var ve=new Uint8Array(X[Z-1-ke]);const ct=new Uint32Array(X[Z-1-ke]);let we=V,Ae=ie,Fe=-1,Ie=-1;for(let je=0;je<ie;je++)for(let Ce=0;Ce<V;Ce++)pe[ae=je*V+Ce]!=ct[ae]&&(Ce<we&&(we=Ce),Ce>Fe&&(Fe=Ce),je<Ae&&(Ae=je),je>Ie&&(Ie=je));Fe==-1&&(we=Ae=Fe=Ie=0),te&&((1&we)==1&&we--,(1&Ae)==1&&Ae--);const Ge=(Fe-we+1)*(Ie-Ae+1);Ge<Qe&&(Qe=Ge,He=ke,he=we,be=Ae,xe=Fe-we+1,Ue=Ie-Ae+1)}ve=new Uint8Array(X[Z-1-He]),He==1&&(ne[Z-1].dispose=2),ue=new Uint8Array(xe*Ue*4),_(ve,V,ie,ue,xe,Ue,-he,-be,0),Le=_(fe,V,ie,ue,xe,Ue,-he,-be,3)?1:0,Le==1?r(fe,V,ie,ue,{x:he,y:be,width:xe,height:Ue}):_(fe,V,ie,ue,xe,Ue,-he,-be,0)}else ue=fe.slice(0);ne.push({rect:{x:he,y:be,width:xe,height:Ue},img:ue,blend:Le,dispose:0})}if(le)for(Z=0;Z<ne.length;Z++){if((Se=ne[Z]).blend==1)continue;const fe=Se.rect,pe=ne[Z-1].rect,he=Math.min(fe.x,pe.x),be=Math.min(fe.y,pe.y),xe={x:he,y:be,width:Math.max(fe.x+fe.width,pe.x+pe.width)-he,height:Math.max(fe.y+fe.height,pe.y+pe.height)-be};ne[Z-1].dispose=1,Z-1!=0&&i(X,V,ie,ne,Z-1,xe,te),i(X,V,ie,ne,Z,xe,te)}let Pe=0;if(X.length!=1)for(var ae=0;ae<ne.length;ae++){var Se;Pe+=(Se=ne[ae]).rect.width*Se.rect.height}return ne})(d,c,v,j,b,E),Y={},G=[],q=[];if(S!=0){const oe=[];for(N=0;N<W.length;N++)oe.push(W[N].img.buffer);const X=(function(te){let de=0;for(var ne=0;ne<te.length;ne++)de+=te[ne].byteLength;const Z=new Uint8Array(de);let ue=0;for(ne=0;ne<te.length;ne++){const ve=new Uint8Array(te[ne]),Pe=ve.length;for(let ae=0;ae<Pe;ae+=4){let Se=ve[ae],fe=ve[ae+1],pe=ve[ae+2];const he=ve[ae+3];he==0&&(Se=fe=pe=0),Z[ue+ae]=Se,Z[ue+ae+1]=fe,Z[ue+ae+2]=pe,Z[ue+ae+3]=he}ue+=Pe}return Z.buffer})(oe),V=m(X,S);for(N=0;N<V.plte.length;N++)G.push(V.plte[N].est.rgba);let ie=0;for(N=0;N<W.length;N++){const le=(ee=W[N]).img.length;var K=new Uint8Array(V.inds.buffer,ie>>2,le>>2);q.push(K);const te=new Uint8Array(V.abuf,ie,le);z&&o(ee.img,ee.rect.width,ee.rect.height,G,te,K),ee.img.set(te),ie+=le}}else for(L=0;L<W.length;L++){var ee=W[L];const oe=new Uint32Array(ee.img.buffer);var re=ee.rect.width;for(H=oe.length,K=new Uint8Array(H),q.push(K),N=0;N<H;N++){const X=oe[N];if(N!=0&&X==oe[N-1])K[N]=K[N-1];else if(N>re&&X==oe[N-re])K[N]=K[N-re];else{let V=Y[X];if(V==null&&(Y[X]=V=G.length,G.push(X),G.length>=300))break;K[N]=V}}}const _e=G.length;for(_e<=256&&s==0&&(O=_e<=2?1:_e<=4?2:_e<=16?4:8,O=Math.max(O,u)),L=0;L<W.length;L++){(ee=W[L]).rect.x,ee.rect.y,re=ee.rect.width;const oe=ee.rect.height;let X=ee.img;new Uint32Array(X.buffer);let V=4*re,ie=4;if(_e<=256&&s==0){V=Math.ceil(O*re/8);var me=new Uint8Array(V*oe);const le=q[L];for(let te=0;te<oe;te++){N=te*V;const de=te*re;if(O==8)for(var J=0;J<re;J++)me[N+J]=le[de+J];else if(O==4)for(J=0;J<re;J++)me[N+(J>>1)]|=le[de+J]<<4-4*(1&J);else if(O==2)for(J=0;J<re;J++)me[N+(J>>2)]|=le[de+J]<<6-2*(3&J);else if(O==1)for(J=0;J<re;J++)me[N+(J>>3)]|=le[de+J]<<7-1*(7&J)}X=me,C=3,ie=1}else if(T==0&&W.length==1){me=new Uint8Array(re*oe*3);const le=re*oe;for(N=0;N<le;N++){const te=3*N,de=4*N;me[te]=X[de],me[te+1]=X[de+1],me[te+2]=X[de+2]}X=me,C=2,ie=3,V=3*re}ee.img=X,ee.bpl=V,ee.bpp=ie}return{ctype:C,depth:O,plte:G,frames:W}}function i(d,c,v,S,A,j,b){const E=Uint8Array,u=Uint32Array,s=new E(d[A-1]),z=new u(d[A-1]),C=A+1<d.length?new E(d[A+1]):null,O=new E(d[A]),B=new u(O.buffer);let L=c,H=v,N=-1,T=-1;for(let Y=0;Y<j.height;Y++)for(let G=0;G<j.width;G++){const q=j.x+G,K=j.y+Y,ee=K*c+q,re=B[ee];re==0||S[A-1].dispose==0&&z[ee]==re&&(C==null||C[4*ee+3]!=0)||(q<L&&(L=q),q>N&&(N=q),K<H&&(H=K),K>T&&(T=K))}N==-1&&(L=H=N=T=0),b&&((1&L)==1&&L--,(1&H)==1&&H--),j={x:L,y:H,width:N-L+1,height:T-H+1};const W=S[A];W.rect=j,W.blend=1,W.img=new Uint8Array(j.width*j.height*4),S[A-1].dispose==0?(_(s,c,v,W.img,j.width,j.height,-j.x,-j.y,0),r(O,c,v,W.img,j)):_(O,c,v,W.img,j.width,j.height,-j.x,-j.y,0)}function r(d,c,v,S,A){_(d,c,v,S,A.width,A.height,-A.x,-A.y,2)}function a(d,c,v,S,A,j,b){const E=[];let u,s=[0,1,2,3,4];j!=-1?s=[j]:(c*S>5e5||v==1)&&(s=[0]),b&&(u={level:0});const z=pt;for(var C=0;C<s.length;C++){for(let L=0;L<c;L++)h(A,d,L,S,v,s[C]);E.push(z.deflate(A,u))}let O,B=1e9;for(C=0;C<E.length;C++)E[C].length<B&&(O=C,B=E[C].length);return E[O]}function h(d,c,v,S,A,j){const b=v*S;let E=b+v;if(d[E]=j,E++,j==0)if(S<500)for(var u=0;u<S;u++)d[E+u]=c[b+u];else d.set(new Uint8Array(c.buffer,b,S),E);else if(j==1){for(u=0;u<A;u++)d[E+u]=c[b+u];for(u=A;u<S;u++)d[E+u]=c[b+u]-c[b+u-A]+256&255}else if(v==0){for(u=0;u<A;u++)d[E+u]=c[b+u];if(j==2)for(u=A;u<S;u++)d[E+u]=c[b+u];if(j==3)for(u=A;u<S;u++)d[E+u]=c[b+u]-(c[b+u-A]>>1)+256&255;if(j==4)for(u=A;u<S;u++)d[E+u]=c[b+u]-D(c[b+u-A],0,0)+256&255}else{if(j==2)for(u=0;u<S;u++)d[E+u]=c[b+u]+256-c[b+u-S]&255;if(j==3){for(u=0;u<A;u++)d[E+u]=c[b+u]+256-(c[b+u-S]>>1)&255;for(u=A;u<S;u++)d[E+u]=c[b+u]+256-(c[b+u-S]+c[b+u-A]>>1)&255}if(j==4){for(u=0;u<A;u++)d[E+u]=c[b+u]+256-D(0,c[b+u-S],0)&255;for(u=A;u<S;u++)d[E+u]=c[b+u]+256-D(c[b+u-A],c[b+u-S],c[b+u-A-S])&255}}}function m(d,c){const v=new Uint8Array(d),S=v.slice(0),A=new Uint32Array(S.buffer),j=w(S,c),b=j[0],E=j[1],u=v.length,s=new Uint8Array(u>>2);let z;if(v.length<2e7)for(var C=0;C<u;C+=4)z=y(b,O=v[C]*(1/255),B=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255)),s[C>>2]=z.ind,A[C>>2]=z.est.rgba;else for(C=0;C<u;C+=4){var O=v[C]*.00392156862745098,B=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255);for(z=b;z.left;)z=I(z.est,O,B,L,H)<=0?z.left:z.right;s[C>>2]=z.ind,A[C>>2]=z.est.rgba}return{abuf:S.buffer,inds:s,plte:E}}function w(d,c,v){v==null&&(v=1e-4);const S=new Uint32Array(d.buffer),A={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=M(d,A.i0,A.i1),A.est=g(A.bst);const j=[A];for(;j.length<c;){let E=0,u=0;for(var b=0;b<j.length;b++)j[b].est.L>E&&(E=j[b].est.L,u=b);if(E<v)break;const s=j[u],z=F(d,S,s.i0,s.i1,s.est.e,s.est.eMq255);if(s.i0>=z||s.i1<=z){s.est.L=0;continue}const C={i0:s.i0,i1:z,bst:null,est:null,tdst:0,left:null,right:null};C.bst=M(d,C.i0,C.i1),C.est=g(C.bst);const O={i0:z,i1:s.i1,bst:null,est:null,tdst:0,left:null,right:null};for(O.bst={R:[],m:[],N:s.bst.N-C.bst.N},b=0;b<16;b++)O.bst.R[b]=s.bst.R[b]-C.bst.R[b];for(b=0;b<4;b++)O.bst.m[b]=s.bst.m[b]-C.bst.m[b];O.est=g(O.bst),s.left=C,s.right=O,j[u]=C,j.push(O)}for(j.sort(((E,u)=>u.bst.N-E.bst.N)),b=0;b<j.length;b++)j[b].ind=b;return[A,j]}function y(d,c,v,S,A){if(d.left==null)return d.tdst=(function(C,O,B,L,H){const N=O-C[0],T=B-C[1],W=L-C[2],Y=H-C[3];return N*N+T*T+W*W+Y*Y})(d.est.q,c,v,S,A),d;const j=I(d.est,c,v,S,A);let b=d.left,E=d.right;j>0&&(b=d.right,E=d.left);const u=y(b,c,v,S,A);if(u.tdst<=j*j)return u;const s=y(E,c,v,S,A);return s.tdst<u.tdst?s:u}function I(d,c,v,S,A){const{e:j}=d;return j[0]*c+j[1]*v+j[2]*S+j[3]*A-d.eMq}function F(d,c,v,S,A,j){for(S-=4;v<S;){for(;U(d,v,A)<=j;)v+=4;for(;U(d,S,A)>j;)S-=4;if(v>=S)break;const b=c[v>>2];c[v>>2]=c[S>>2],c[S>>2]=b,v+=4,S-=4}for(;U(d,v,A)>j;)v-=4;return v+4}function U(d,c,v){return d[c]*v[0]+d[c+1]*v[1]+d[c+2]*v[2]+d[c+3]*v[3]}function M(d,c,v){const S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],j=v-c>>2;for(let b=c;b<v;b+=4){const E=d[b]*.00392156862745098,u=d[b+1]*(1/255),s=d[b+2]*(1/255),z=d[b+3]*(1/255);A[0]+=E,A[1]+=u,A[2]+=s,A[3]+=z,S[0]+=E*E,S[1]+=E*u,S[2]+=E*s,S[3]+=E*z,S[5]+=u*u,S[6]+=u*s,S[7]+=u*z,S[10]+=s*s,S[11]+=s*z,S[15]+=z*z}return S[4]=S[1],S[8]=S[2],S[9]=S[6],S[12]=S[3],S[13]=S[7],S[14]=S[11],{R:S,m:A,N:j}}function g(d){const{R:c}=d,{m:v}=d,{N:S}=d,A=v[0],j=v[1],b=v[2],E=v[3],u=S==0?0:1/S,s=[c[0]-A*A*u,c[1]-A*j*u,c[2]-A*b*u,c[3]-A*E*u,c[4]-j*A*u,c[5]-j*j*u,c[6]-j*b*u,c[7]-j*E*u,c[8]-b*A*u,c[9]-b*j*u,c[10]-b*b*u,c[11]-b*E*u,c[12]-E*A*u,c[13]-E*j*u,c[14]-E*b*u,c[15]-E*E*u],z=s,C=P;let O=[Math.random(),Math.random(),Math.random(),Math.random()],B=0,L=0;if(S!=0)for(let N=0;N<16&&(O=C.multVec(z,O),L=Math.sqrt(C.dot(O,O)),O=C.sml(1/L,O),!(N!=0&&Math.abs(L-B)<1e-9));N++)B=L;const H=[A*u,j*u,b*u,E*u];return{Cov:s,q:H,e:O,L:B,eMq255:C.dot(C.sml(255,H),O),eMq:C.dot(O,H),rgba:(Math.round(255*H[3])<<24|Math.round(255*H[2])<<16|Math.round(255*H[1])<<8|Math.round(255*H[0])<<0)>>>0}}var P={multVec:(d,c)=>[d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],d[4]*c[0]+d[5]*c[1]+d[6]*c[2]+d[7]*c[3],d[8]*c[0]+d[9]*c[1]+d[10]*c[2]+d[11]*c[3],d[12]*c[0]+d[13]*c[1]+d[14]*c[2]+d[15]*c[3]],dot:(d,c)=>d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],sml:(d,c)=>[d*c[0],d*c[1],d*c[2],d*c[3]]};ge.encode=function(c,v,S,A,j,b,E){A==null&&(A=0),E==null&&(E=!1);const u=n(c,v,S,A,[!1,!1,!1,0,E,!1]);return x(u,-1),p(u,v,S,j,b)},ge.encodeLL=function(c,v,S,A,j,b,E,u){const s={ctype:0+(A==1?0:2)+(j==0?0:4),depth:b,frames:[]},z=(A+j)*b,C=z*v;for(let O=0;O<c.length;O++)s.frames.push({rect:{x:0,y:0,width:v,height:S},img:new Uint8Array(c[O]),blend:0,dispose:1,bpp:Math.ceil(z/8),bpl:Math.ceil(C/8)});return x(s,0,!0),p(s,v,S,E,u)},ge.encode.compress=n,ge.encode.dither=o,ge.quantize=m,ge.quantize.getKDtree=w,ge.quantize.getNearest=y})();const Je={toArrayBuffer(_,R){const D=_.width,f=_.height,e=D<<2,t=_.getContext("2d").getImageData(0,0,D,f),l=new Uint32Array(t.data.buffer),o=(32*D+31)/32<<2,p=o*f,x=122+p,n=new ArrayBuffer(x),i=new DataView(n),r=1<<20;let a,h,m,w,y=r,I=0,F=0,U=0;function M(d){i.setUint16(F,d,!0),F+=2}function g(d){i.setUint32(F,d,!0),F+=4}function P(d){F+=d}M(19778),g(x),P(4),g(122),g(108),g(D),g(-f>>>0),M(1),M(32),g(3),g(p),g(2835),g(2835),P(8),g(16711680),g(65280),g(255),g(4278190080),g(1466527264),(function d(){for(;I<f&&y>0;){for(w=122+I*o,a=0;a<e;)y--,h=l[U++],m=h>>>24,i.setUint32(w+a,h<<8|m),a+=4;I++}U<l.length?(y=r,setTimeout(d,Je._dly)):R(n)})()},toBlob(_,R){this.toArrayBuffer(_,(D=>{R(new Blob([D],{type:"image/bmp"}))}))},_dly:9};var ce={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gt={[ce.CHROME]:16384,[ce.FIREFOX]:11180,[ce.DESKTOP_SAFARI]:16384,[ce.IE]:8192,[ce.IOS]:4096,[ce.ETC]:8192};const $e=typeof window<"u",et=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,De=$e&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),mt=($e||et)&&(De&&De.getOriginalSymbol(window,"File")||typeof File<"u"&&File),tt=($e||et)&&(De&&De.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function qe(_,R,D=Date.now()){return new Promise((f=>{const e=_.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let o=l.length;const p=new Uint8Array(o);for(;o--;)p[o]=l.charCodeAt(o);const x=new Blob([p],{type:t});x.name=R,x.lastModified=D,f(x)}))}function nt(_){return new Promise(((R,D)=>{const f=new tt;f.onload=()=>R(f.result),f.onerror=e=>D(e),f.readAsDataURL(_)}))}function rt(_){return new Promise(((R,D)=>{const f=new Image;f.onload=()=>R(f),f.onerror=e=>D(e),f.src=_}))}function Ee(){if(Ee.cachedResult!==void 0)return Ee.cachedResult;let _=ce.ETC;const{userAgent:R}=navigator;return/Chrom(e|ium)/i.test(R)?_=ce.CHROME:/iP(ad|od|hone)/i.test(R)&&/WebKit/i.test(R)?_=ce.IOS:/Safari/i.test(R)?_=ce.DESKTOP_SAFARI:/Firefox/i.test(R)?_=ce.FIREFOX:(/MSIE/i.test(R)||document.documentMode)&&(_=ce.IE),Ee.cachedResult=_,Ee.cachedResult}function it(_,R){const D=Ee(),f=gt[D];let e=_,t=R,l=e*t;const o=e>t?t/e:e/t;for(;l>f*f;){const p=(f+e)/2,x=(f+t)/2;p<x?(t=x,e=x*o):(t=p*o,e=p),l=e*t}return{width:e,height:t}}function Ne(_,R){let D,f;try{if(D=new OffscreenCanvas(_,R),f=D.getContext("2d"),f===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{D=document.createElement("canvas"),f=D.getContext("2d")}return D.width=_,D.height=R,[D,f]}function ot(_,R){const{width:D,height:f}=it(_.width,_.height),[e,t]=Ne(D,f);return R&&/jpe?g/.test(R)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(_,0,0,e.width,e.height),e}function Me(){return Me.cachedResult!==void 0||(Me.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Me.cachedResult}function ze(_,R={}){return new Promise((function(D,f){let e,t;var l=function(){try{return t=ot(e,R.fileType||_.type),D([e,t])}catch(p){return f(p)}},o=function(p){try{var x=function(n){try{throw n}catch(i){return f(i)}};try{let n;return nt(_).then((function(i){try{return n=i,rt(n).then((function(r){try{return e=r,(function(){try{return l()}catch(a){return f(a)}})()}catch(a){return x(a)}}),x)}catch(r){return x(r)}}),x)}catch(n){x(n)}}catch(n){return f(n)}};try{if(Me()||[ce.DESKTOP_SAFARI,ce.MOBILE_SAFARI].includes(Ee()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(_).then((function(p){try{return e=p,l()}catch{return o()}}),o)}catch{o()}}))}function Oe(_,R,D,f,e=1){return new Promise((function(t,l){let o;if(R==="image/png"){let x,n,i;return x=_.getContext("2d"),{data:n}=x.getImageData(0,0,_.width,_.height),i=ge.encode([n.buffer],_.width,_.height,4096*e),o=new Blob([i],{type:R}),o.name=D,o.lastModified=f,p.call(this)}{let x=function(){return p.call(this)};if(R==="image/bmp")return new Promise((n=>Je.toBlob(_,n))).then(function(n){try{return o=n,o.name=D,o.lastModified=f,x.call(this)}catch(i){return l(i)}}.bind(this),l);{let n=function(){return x.call(this)};if(typeof OffscreenCanvas=="function"&&_ instanceof OffscreenCanvas)return _.convertToBlob({type:R,quality:e}).then(function(i){try{return o=i,o.name=D,o.lastModified=f,n.call(this)}catch(r){return l(r)}}.bind(this),l);{let i;return i=_.toDataURL(R,e),qe(i,D,f).then(function(r){try{return o=r,n.call(this)}catch(a){return l(a)}}.bind(this),l)}}}function p(){return t(o)}}))}function ye(_){_.width=0,_.height=0}function Re(){return new Promise((function(_,R){let D,f,e,t;return Re.cachedResult!==void 0?_(Re.cachedResult):qe("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(l){try{return D=l,ze(D).then((function(o){try{return f=o[1],Oe(f,D.type,D.name,D.lastModified).then((function(p){try{return e=p,ye(f),ze(e).then((function(x){try{return t=x[0],Re.cachedResult=t.width===1&&t.height===2,_(Re.cachedResult)}catch(n){return R(n)}}),R)}catch(x){return R(x)}}),R)}catch(p){return R(p)}}),R)}catch(o){return R(o)}}),R)}))}function at(_){return new Promise(((R,D)=>{const f=new tt;f.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return R(-2);const l=t.byteLength;let o=2;for(;o<l;){if(t.getUint16(o+2,!1)<=8)return R(-1);const p=t.getUint16(o,!1);if(o+=2,p==65505){if(t.getUint32(o+=2,!1)!=1165519206)return R(-1);const x=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,x);const n=t.getUint16(o,x);o+=2;for(let i=0;i<n;i++)if(t.getUint16(o+12*i,x)==274)return R(t.getUint16(o+12*i+8,x))}else{if((65280&p)!=65280)break;o+=t.getUint16(o,!1)}}return R(-1)},f.onerror=e=>D(e),f.readAsArrayBuffer(_)}))}function st(_,R){const{width:D}=_,{height:f}=_,{maxWidthOrHeight:e}=R;let t,l=_;return isFinite(e)&&(D>e||f>e)&&([l,t]=Ne(D,f),D>f?(l.width=e,l.height=f/D*e):(l.width=D/f*e,l.height=e),t.drawImage(_,0,0,l.width,l.height),ye(_)),l}function lt(_,R){const{width:D}=_,{height:f}=_,[e,t]=Ne(D,f);switch(R>4&&R<9?(e.width=f,e.height=D):(e.width=D,e.height=f),R){case 2:t.transform(-1,0,0,1,D,0);break;case 3:t.transform(-1,0,0,-1,D,f);break;case 4:t.transform(1,0,0,-1,0,f);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,f,0);break;case 7:t.transform(0,-1,-1,0,f,D);break;case 8:t.transform(0,-1,1,0,0,D)}return t.drawImage(_,0,0,D,f),ye(_),e}function Ze(_,R,D=0){return new Promise((function(f,e){let t,l,o,p,x,n,i,r,a,h,m,w,y,I,F,U,M,g,P,d;function c(S=5){if(R.signal&&R.signal.aborted)throw R.signal.reason;t+=S,R.onProgress(Math.min(t,100))}function v(S){if(R.signal&&R.signal.aborted)throw R.signal.reason;t=Math.min(Math.max(S,t),100),R.onProgress(t)}return t=D,l=R.maxIteration||10,o=1024*R.maxSizeMB*1024,c(),ze(_,R).then(function(S){try{return[,p]=S,c(),x=st(p,R),c(),new Promise((function(A,j){var b;if(!(b=R.exifOrientation))return at(_).then(function(u){try{return b=u,E.call(this)}catch(s){return j(s)}}.bind(this),j);function E(){return A(b)}return E.call(this)})).then(function(A){try{return n=A,c(),Re().then(function(j){try{return i=j?x:lt(x,n),c(),r=R.initialQuality||1,a=R.fileType||_.type,Oe(i,a,_.name,_.lastModified,r).then(function(b){try{{let u=function(){if(l--&&(F>o||F>y)){let z,C;return z=d?.95*P.width:P.width,C=d?.95*P.height:P.height,[M,g]=Ne(z,C),g.drawImage(P,0,0,z,C),r*=a==="image/png"?.85:.95,Oe(M,a,_.name,_.lastModified,r).then((function(O){try{return U=O,ye(P),P=M,F=U.size,v(Math.min(99,Math.floor((I-F)/(I-o)*100))),u}catch(B){return e(B)}}),e)}return[1]},s=function(){return ye(P),ye(M),ye(x),ye(i),ye(p),v(100),f(U)};if(h=b,c(),m=h.size>o,w=h.size>_.size,!m&&!w)return v(100),f(h);var E;return y=_.size,I=h.size,F=I,P=i,d=!R.alwaysKeepResolution&&m,(E=function(z){for(;z;){if(z.then)return void z.then(E,e);try{if(z.pop){if(z.length)return z.pop()?s.call(this):z;z=u}else z=z.call(this)}catch(C){return e(C)}}}.bind(this))(u)}}catch(u){return e(u)}}.bind(this),e)}catch(b){return e(b)}}.bind(this),e)}catch(j){return e(j)}}.bind(this),e)}catch(A){return e(A)}}.bind(this),e)}))}const xt=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Be;function yt(_,R){return new Promise(((D,f)=>{Be||(Be=(function(l){const o=[];return o.push(l),URL.createObjectURL(new Blob(o))})(xt));const e=new Worker(Be);e.addEventListener("message",(function(l){if(R.signal&&R.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return f(new Error(l.data.error)),void e.terminate();D(l.data.file),e.terminate()}else R.onProgress(l.data.progress)})),e.addEventListener("error",f),R.signal&&R.signal.addEventListener("abort",(()=>{f(R.signal.reason),e.terminate()})),e.postMessage({file:_,imageCompressionLibUrl:R.libURL,options:{...R,onProgress:void 0,signal:void 0}})}))}function se(_,R){return new Promise((function(D,f){let e,t,l,o,p,x;if(e={...R},l=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,p=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=a=>{l=a,typeof o=="function"&&o(l)},!(_ instanceof Blob||_ instanceof mt))return f(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(_.type))return f(new Error("The file given is not an image"));if(x=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!p||typeof Worker!="function"||x)return Ze(_,e).then(function(a){try{return t=a,r.call(this)}catch(h){return f(h)}}.bind(this),f);var n=function(){try{return r.call(this)}catch(a){return f(a)}}.bind(this),i=function(a){try{return Ze(_,e).then((function(h){try{return t=h,n()}catch(m){return f(m)}}),f)}catch(h){return f(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",yt(_,e).then((function(a){try{return t=a,n()}catch{return i()}}),i)}catch{i()}function r(){try{t.name=_.name,t.lastModified=_.lastModified}catch{}try{e.preserveExif&&_.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===_.type)&&(t=Xe(_,t))}catch{}return D(t)}}))}se.getDataUrlFromFile=nt,se.getFilefromDataUrl=qe,se.loadImage=rt,se.drawImageInCanvas=ot,se.drawFileInCanvas=ze,se.canvasToFile=Oe,se.getExifOrientation=at,se.handleMaxWidthOrHeight=st,se.followExifOrientation=lt,se.cleanupCanvasMemory=ye,se.isAutoOrientationInBrowser=Re,se.approximateBelowMaximumCanvasSizeOfBrowser=it,se.copyExifWithoutOrientation=Xe,se.getBrowserName=Ee,se.version="2.0.2";function bt({userId:_,userAvatar:R}){const[D,f]=$.useState(""),[e,t]=$.useState(!1),[l,o]=$.useState(!1),[p,x]=$.useState(""),[n,i]=$.useState([]),[r,a]=$.useState([]),h=async I=>{const F=Array.from(I.target.files||[]);if(F.length===0)return;if(F.length+n.length>4){x("Maximum 4 images per post");return}i([...n,...F]);const U=F.map(M=>URL.createObjectURL(M));a([...r,...U])},m=I=>{const F=n.filter((M,g)=>g!==I),U=r.filter((M,g)=>g!==I);URL.revokeObjectURL(r[I]),i(F),a(U)},w=async I=>{try{const U=await se(I,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),M=I.name.split(".").pop(),g=`${_}/${Date.now()}-${Math.random().toString(36).substring(7)}.${M}`,{data:P,error:d}=await Q.storage.from("media").upload(g,U);if(d)throw d;const{data:{publicUrl:c}}=Q.storage.from("media").getPublicUrl(P.path);return c}catch(F){throw console.error("Upload error:",F),new Error("Failed to upload image")}},y=async I=>{if(I.preventDefault(),!D.trim()&&n.length===0){x("Please write something or add an image");return}o(!0),x("");try{let F=[];n.length>0&&(t(!0),F=await Promise.all(n.map(w)),t(!1));const{error:U}=await Q.from("posts").insert({user_id:_,content:D.trim(),media_urls:F.length>0?F:null});if(U)throw U;f(""),i([]),r.forEach(M=>URL.revokeObjectURL(M)),a([]),window.location.reload()}catch(F){x(F.message||"Failed to create post"),t(!1),o(!1)}};return k.jsxs("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[k.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"start"},children:[R?k.jsx("img",{src:R,alt:"You",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):k.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:"?"}),k.jsx("textarea",{value:D,onChange:I=>f(I.target.value),placeholder:"What's on your mind?",rows:3,style:{flex:1,resize:"vertical",minHeight:"80px",fontSize:"16px"},disabled:l})]}),p&&k.jsx("div",{style:{background:"#fee",color:"#c33",padding:"10px",borderRadius:"6px",fontSize:"14px"},children:p}),r.length>0&&k.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:r.map((I,F)=>k.jsxs("div",{style:{position:"relative"},children:[k.jsx("img",{src:I,alt:`Preview ${F+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px"}}),k.jsx("button",{type:"button",onClick:()=>m(F),style:{position:"absolute",top:"5px",right:"5px",background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"16px",lineHeight:"1"},children:""})]},F))}),k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[k.jsxs("label",{style:{cursor:"pointer"},children:[k.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h,style:{display:"none"},disabled:l||n.length>=4}),k.jsxs("span",{style:{color:"#4A90E2",fontWeight:"500",fontSize:"14px"},children:[" Add Photos ",n.length>0&&`(${n.length}/4)`]})]}),k.jsx("button",{type:"submit",className:"btn",disabled:l||e,style:{opacity:l||e?.5:1},children:e?"Uploading...":l?"Posting...":"Post"})]})]})}const We={like:"",love:"",laugh:"",celebrate:""};function vt({postId:_,currentUserId:R}){const[D,f]=$.useState([]),[e,t]=$.useState(null),[l,o]=$.useState(!1),[p,x]=$.useState(!1);$.useEffect(()=>{n(),i()},[_]);async function n(){const{data:w}=await Q.from("post_reactions").select(`
        *,
        profile:profiles(display_name)
      `).eq("post_id",_);if(w){f(w);const y=w.find(I=>I.user_id===R);t(y?.reaction_type||null)}}function i(){const w=Q.channel(`reactions-${_}`).on("postgres_changes",{event:"*",schema:"public",table:"post_reactions",filter:`post_id=eq.${_}`},()=>{n()}).subscribe();return()=>{Q.removeChannel(w)}}async function r(w){if(!p){x(!0);try{e===w?(await Q.from("post_reactions").delete().eq("post_id",_).eq("user_id",R),t(null)):e?(await Q.from("post_reactions").update({reaction_type:w}).eq("post_id",_).eq("user_id",R),t(w)):(await Q.from("post_reactions").insert({post_id:_,user_id:R,reaction_type:w}),t(w)),o(!1)}catch(y){console.error("Reaction error:",y)}finally{x(!1)}}}const a={};D.forEach(w=>{a[w.reaction_type]=(a[w.reaction_type]||0)+1});const h=D.length,m=D.slice(0,3).map(w=>w.profile?.display_name).filter(Boolean);return k.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[h>0&&k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",fontSize:"14px",color:"#666"},children:[k.jsx("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:Object.entries(a).map(([w,y])=>k.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[We[w]," ",y]},w))}),m.length>0&&k.jsxs("div",{style:{fontSize:"13px"},children:[m.join(", "),D.length>3&&` +${D.length-3} more`]})]}),k.jsxs("div",{style:{display:"flex",gap:"10px",position:"relative"},children:[k.jsxs("button",{onClick:()=>e?r(e):o(!l),style:{background:e?"#e3f2fd":"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:e?"#4A90E2":"#666",fontWeight:e?600:400},children:[e?We[e]:"",e?"Liked":"Like"]}),!e&&k.jsx("button",{onClick:()=>o(!l),style:{background:"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 10px",fontSize:"16px",cursor:"pointer"},title:"React",children:"+"}),l&&k.jsx("div",{style:{position:"absolute",bottom:"100%",left:0,marginBottom:"8px",background:"white",border:"1px solid #ddd",borderRadius:"24px",padding:"8px 12px",display:"flex",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10},children:Object.entries(We).map(([w,y])=>k.jsx("button",{onClick:()=>r(w),style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",padding:"4px",borderRadius:"50%",transition:"transform 0.2s"},onMouseEnter:I=>I.currentTarget.style.transform="scale(1.3)",onMouseLeave:I=>I.currentTarget.style.transform="scale(1)",title:w,children:y},w))})]})]})}function wt({postId:_,currentUserId:R}){const[D,f]=$.useState([]),[e,t]=$.useState(""),[l,o]=$.useState(!1),[p,x]=$.useState(!1);$.useEffect(()=>{n(),i()},[_]);async function n(){const{data:m}=await Q.from("comments").select(`
        *,
        profile:profiles(display_name, avatar_url)
      `).eq("post_id",_).order("created_at",{ascending:!0});m&&f(m)}function i(){const m=Q.channel(`comments-${_}`).on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:`post_id=eq.${_}`},()=>{n()}).subscribe();return()=>{Q.removeChannel(m)}}async function r(m){if(m.preventDefault(),!(!e.trim()||l)){o(!0);try{await Q.from("comments").insert({post_id:_,user_id:R,content:e.trim()}),t(""),x(!0)}catch(w){console.error("Comment error:",w)}finally{o(!1)}}}async function a(m){if(confirm("Delete this comment?"))try{await Q.from("comments").delete().eq("id",m)}catch(w){console.error("Delete error:",w)}}const h=m=>{const w=new Date(m),I=new Date().getTime()-w.getTime(),F=Math.floor(I/(1e3*60*60)),U=Math.floor(F/24);if(U>0)return`${U}d ago`;if(F>0)return`${F}h ago`;const M=Math.floor(I/(1e3*60));return M>0?`${M}m ago`:"Just now"};return k.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[k.jsxs("button",{onClick:()=>x(!p),style:{background:"transparent",border:"none",color:"#666",fontSize:"14px",cursor:"pointer",padding:"4px 0",fontWeight:500,display:"flex",alignItems:"center",gap:"6px"},children:[" ",D.length," ",D.length===1?"Comment":"Comments",k.jsx("span",{style:{fontSize:"12px"},children:p?"":""})]}),p&&k.jsxs("div",{style:{marginTop:"12px"},children:[D.map(m=>k.jsx("div",{style:{padding:"10px",background:"#f8f9fa",borderRadius:"8px",marginBottom:"8px"},children:k.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"start"},children:[m.profile?.avatar_url?k.jsx("img",{src:m.profile.avatar_url,alt:m.profile.display_name,style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):k.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:m.profile?.display_name?.[0]?.toUpperCase()||"?"}),k.jsxs("div",{style:{flex:1,minWidth:0},children:[k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",gap:"8px"},children:[k.jsxs("div",{children:[k.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:m.profile?.display_name||"Unknown"}),k.jsx("div",{style:{fontSize:"13px",color:"#999"},children:h(m.created_at)})]}),m.user_id===R&&k.jsx("button",{onClick:()=>a(m.id),style:{background:"transparent",border:"none",color:"#999",fontSize:"12px",cursor:"pointer",padding:"2px 6px"},children:"Delete"})]}),k.jsx("div",{style:{fontSize:"14px",marginTop:"6px",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:m.content})]})]})},m.id)),k.jsxs("form",{onSubmit:r,style:{marginTop:"12px"},children:[k.jsx("textarea",{value:e,onChange:m=>t(m.target.value),placeholder:"Write a comment...",rows:2,style:{width:"100%",resize:"vertical",marginBottom:"8px",fontSize:"14px"},disabled:l}),k.jsx("button",{type:"submit",className:"btn",style:{fontSize:"13px",padding:"6px 12px"},disabled:l||!e.trim(),children:l?"Posting...":"Post Comment"})]})]})]})}function At({profileId:_}){const[R,D]=$.useState(null),[f,e]=$.useState(null),[t,l]=$.useState([]),[o,p]=$.useState(!0),[x,n]=$.useState(!1);$.useEffect(()=>{i()},[_]);async function i(){try{const a=await Ye();D(a);const{data:h}=await Q.from("profiles").select("*").eq("id",_).single();e(h);const{data:m}=await Q.from("posts").select(`
          *,
          profile:profiles(*)
        `).eq("user_id",_).order("created_at",{ascending:!1});l(m||[]),p(!1)}catch(a){console.error("Error loading profile:",a),p(!1)}}if(o)return k.jsx("div",{style:{textAlign:"center",padding:"40px"},children:"Loading..."});if(!f)return k.jsx("div",{className:"error",children:"Profile not found"});const r=R?.id===_;return k.jsxs("div",{children:[k.jsx("div",{className:"card",style:{marginBottom:"30px"},children:k.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"start",flexWrap:"wrap"},children:[f.avatar_url?k.jsx("img",{src:f.avatar_url,alt:f.display_name,style:{width:"100px",height:"100px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):k.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"40px",fontWeight:"bold",flexShrink:0},children:f.display_name[0].toUpperCase()}),k.jsxs("div",{style:{flex:1,minWidth:0},children:[k.jsx("h1",{style:{marginBottom:"10px"},children:f.display_name}),f.bio&&k.jsx("p",{style:{color:"#666",lineHeight:1.6,marginBottom:"10px"},children:f.bio}),k.jsxs("p",{style:{color:"#999",fontSize:"14px"},children:["Member since ",new Date(f.created_at).toLocaleDateString()]}),r&&!x&&k.jsx("button",{onClick:()=>n(!0),className:"btn",style:{marginTop:"15px"},children:" Edit Profile"})]})]})}),x&&r&&k.jsx(_t,{profile:f,onSave:()=>{n(!1),i()},onCancel:()=>n(!1)}),k.jsxs("h2",{style:{marginBottom:"20px"},children:[r?"Your Posts":`${f.display_name}'s Posts`," (",t.length,")"]}),t.length===0?k.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:k.jsx("p",{style:{color:"#999"},children:"No posts yet"})}):t.map(a=>k.jsx(St,{post:a,currentUserId:R?.id||""},a.id))]})}function _t({profile:_,onSave:R,onCancel:D}){const[f,e]=$.useState(_.display_name),[t,l]=$.useState(_.bio||""),[o,p]=$.useState(!1),[x,n]=$.useState(!1),[i,r]=$.useState("");async function a(m){const w=m.target.files?.[0];if(w){if(w.size>5*1024*1024){r("Avatar must be less than 5MB");return}p(!0),r("");try{const y=w.name.split(".").pop(),I=`${_.id}/avatar-${Date.now()}.${y}`,{error:F}=await Q.storage.from("media").upload(I,w,{upsert:!0});if(F)throw F;const{data:{publicUrl:U}}=Q.storage.from("media").getPublicUrl(I),{error:M}=await Q.from("profiles").update({avatar_url:U}).eq("id",_.id);if(M)throw M;p(!1),R()}catch(y){r(y.message),p(!1)}}}async function h(){n(!0),r("");try{const{error:m}=await Q.from("profiles").update({display_name:f,bio:t||null}).eq("id",_.id);if(m)throw m;n(!1),R()}catch(m){r(m.message),n(!1)}}return k.jsxs("div",{className:"card",style:{marginBottom:"30px"},children:[k.jsx("h2",{style:{marginBottom:"20px"},children:"Edit Profile"}),i&&k.jsx("div",{className:"error",children:i}),k.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[k.jsxs("div",{children:[k.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Profile Picture"}),k.jsx("input",{type:"file",accept:"image/*",onChange:a,disabled:o}),o&&k.jsx("p",{style:{fontSize:"14px",color:"#4A90E2",marginTop:"5px"},children:"Uploading..."})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"display_name",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Display Name"}),k.jsx("input",{type:"text",id:"display_name",value:f,onChange:m=>e(m.target.value),disabled:x})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"bio",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Bio"}),k.jsx("textarea",{id:"bio",value:t,onChange:m=>l(m.target.value),rows:3,placeholder:"Tell your family about yourself...",disabled:x})]}),k.jsxs("div",{style:{display:"flex",gap:"10px"},children:[k.jsx("button",{onClick:h,className:"btn",disabled:x||!f,children:x?"Saving...":"Save Changes"}),k.jsx("button",{onClick:D,className:"btn btn-secondary",disabled:x,children:"Cancel"})]})]})]})}function St({post:_,currentUserId:R}){const D=f=>{const e=new Date(f),l=new Date().getTime()-e.getTime(),o=Math.floor(l/(1e3*60*60)),p=Math.floor(o/24);return p>0?`${p}d ago`:o>0?`${o}h ago`:"Just now"};return k.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[k.jsx("div",{style:{marginBottom:"15px"},children:k.jsx("div",{style:{fontSize:"13px",color:"#999"},children:D(_.created_at)})}),k.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:_.content}),_.media_urls&&_.media_urls.length>0&&k.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:_.media_urls.map((f,e)=>k.jsx("img",{src:f,alt:"Post media",style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px"}},e))})]})}function Et(){const[_,R]=$.useState(null),[D,f]=$.useState(null),[e,t]=$.useState([]),[l,o]=$.useState(!0),[p,x]=$.useState(""),[n,i]=$.useState(0),[r,a]=$.useState([]),[h,m]=$.useState(null);$.useEffect(()=>{w()},[]),$.useEffect(()=>{const U=Q.channel("posts-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},async M=>{const{data:g}=await Q.from("posts").select(`
              *,
              profile:profiles(*)
            `).eq("id",M.new.id).single();g&&(a(P=>[g,...P]),i(P=>P+1))}).subscribe();return()=>{Q.removeChannel(U)}},[]);async function w(){try{const U=await Ye();if(R(U),!U){window.location.href="/login.html";return}if(!Ke){const{data:M}=await Q.from("profiles").select("*").eq("id",U.id).single();f(M);const{data:g,error:P}=await Q.from("posts").select(`
            *,
            profile:profiles(*)
          `).order("created_at",{ascending:!1}).limit(50);if(P)throw P;t(g||[])}o(!1)}catch(U){x(U.message),o(!1)}}const y=async()=>{await Q.auth.signOut(),window.location.href="/login.html"},I=()=>{t([...r,...e]),a([]),i(0)},F=async()=>{o(!0),await w(),a([]),i(0)};return l?k.jsx("div",{style:{textAlign:"center",padding:"40px"},children:k.jsx("p",{children:"Loading..."})}):p?k.jsxs("div",{className:"error",children:[k.jsx("strong",{children:"Error:"})," ",p]}):h?k.jsxs(k.Fragment,{children:[k.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[k.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:" Back to Feed"}),k.jsx("a",{href:"/admin.html",children:"Admin"}),k.jsx("button",{onClick:y,className:"btn btn-secondary",children:"Sign Out"})]}),k.jsx(At,{profileId:h})]}):k.jsxs(k.Fragment,{children:[k.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[k.jsx("button",{onClick:()=>m(_?.id||""),className:"btn btn-secondary",children:"My Profile"}),k.jsx("a",{href:"/admin.html",children:"Admin"}),k.jsx("button",{onClick:y,className:"btn btn-secondary",children:"Sign Out"})]}),k.jsxs("div",{style:{marginBottom:"30px"},children:[k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[k.jsx("h1",{style:{margin:0},children:"Family Feed"}),k.jsx("button",{onClick:F,className:"btn btn-secondary",style:{fontSize:"14px",padding:"6px 12px"},children:" Refresh"})]}),n>0&&k.jsxs("div",{onClick:I,style:{background:"#4A90E2",color:"white",padding:"12px",borderRadius:"8px",marginBottom:"15px",textAlign:"center",cursor:"pointer",fontWeight:500},children:[" ",n," new ",n===1?"post":"posts"," - Tap to view"]}),Ke,k.jsx("div",{className:"card",children:k.jsx(bt,{userId:_?.id||Ve,userAvatar:D?.avatar_url})})]}),k.jsxs("div",{children:[e.length===0&&k.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:k.jsx("p",{style:{color:"#999"},children:"No posts yet. Be the first to share something!"})}),e.map(U=>k.jsx(Ut,{post:U,currentUserId:_?.id||Ve,onProfileClick:M=>m(M)},U.id))]})]})}function Ut({post:_,currentUserId:R,onProfileClick:D}){const f=l=>{const o=new Date(l),x=new Date().getTime()-o.getTime(),n=Math.floor(x/(1e3*60*60)),i=Math.floor(n/24);return i>0?`${i}d ago`:n>0?`${n}h ago`:"Just now"},e=async()=>{if(confirm("Delete this post?"))try{if(_.media_urls&&_.media_urls.length>0)for(const l of _.media_urls){const o=l.split("/media/")[1];o&&await Q.storage.from("media").remove([o])}await Q.from("posts").delete().eq("id",_.id),window.location.reload()}catch{alert("Failed to delete post")}},t=_.user_id===R;return k.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"15px",gap:"10px"},children:[k.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flex:1,minWidth:0,cursor:"pointer"},onClick:()=>D?.(_.user_id),children:[_.profile?.avatar_url?k.jsx("img",{src:_.profile.avatar_url,alt:_.profile.display_name,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):k.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:_.profile?.display_name?.[0]?.toUpperCase()||"?"}),k.jsxs("div",{style:{minWidth:0,flex:1},children:[k.jsx("div",{style:{fontWeight:600,color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:_.profile?.display_name||"Unknown"}),k.jsx("div",{style:{fontSize:"13px",color:"#999"},children:f(_.created_at)})]})]}),t&&k.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"28px",color:"#999",cursor:"pointer",lineHeight:1,padding:0,width:"28px",height:"28px",flexShrink:0},title:"Delete post",children:""})]}),k.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:_.content}),_.media_urls&&_.media_urls.length>0&&k.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:_.media_urls.map((l,o)=>k.jsx("img",{src:l,alt:"Post media",style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px"}},o))}),k.jsx(vt,{postId:_.id,currentUserId:R}),k.jsx(wt,{postId:_.id,currentUserId:R})]})}export{Et as default};
