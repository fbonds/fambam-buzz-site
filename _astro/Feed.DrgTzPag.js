import{j as I,a as Q,g as Xe}from"./client-auth.DKJLJEpy.js";import{r as $}from"./index.D55ewHcJ.js";const Ke=!1,Ve="fletcher-dev-id";function dt(S,F){return F.forEach((function(z){z&&typeof z!="string"&&!Array.isArray(z)&&Object.keys(z).forEach((function(f){if(f!=="default"&&!(f in S)){var e=Object.getOwnPropertyDescriptor(z,f);Object.defineProperty(S,f,e.get?e:{enumerable:!0,get:function(){return z[f]}})}}))})),Object.freeze(S)}function Ye(S,F){return new Promise((function(z,f){let e;return ut(S).then((function(t){try{return e=t,z(new Blob([F.slice(0,2),e,F.slice(2)],{type:"image/jpeg"}))}catch(l){return f(l)}}),f)}))}const ut=S=>new Promise(((F,z)=>{const f=new FileReader;f.addEventListener("load",(({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return z("not a valid JPEG");for(l+=2;;){const o=t.getUint16(l);if(o===65498)break;const p=t.getUint16(l+2);if(o===65505&&t.getUint32(l+4)===1165519206){const y=l+10;let r;switch(t.getUint16(y)){case 18761:r=!0;break;case 19789:r=!1;break;default:return z("TIFF header contains invalid endian")}if(t.getUint16(y+2,r)!==42)return z("TIFF header contains invalid version");const i=t.getUint32(y+4,r),n=y+i+2+12*t.getUint16(y+i,r);for(let s=y+i+2;s<n;s+=12)if(t.getUint16(s,r)==274){if(t.getUint16(s+2,r)!==3)return z("Orientation data type is invalid");if(t.getUint32(s+4,r)!==1)return z("Orientation data count is invalid");t.setUint16(s+8,1,r);break}return F(e.slice(l,l+2+p))}l+=2+p}return F(new Blob)})),f.readAsArrayBuffer(S)}));var Te={},ht={get exports(){return Te},set exports(S){Te=S}};(function(S){var F,z,f={};ht.exports=f,f.parse=function(e,t){for(var l=f.bin.readUshort,o=f.bin.readUint,p=0,y={},r=new Uint8Array(e),i=r.length-4;o(r,i)!=101010256;)i--;p=i,p+=4;var n=l(r,p+=4);l(r,p+=2);var s=o(r,p+=2),h=o(r,p+=4);p+=4,p=h;for(var m=0;m<n;m++){o(r,p),p+=4,p+=4,p+=4,o(r,p+=4),s=o(r,p+=4);var j=o(r,p+=4),x=l(r,p+=4),R=l(r,p+2),U=l(r,p+4);p+=6;var C=o(r,p+=8);p+=4,p+=x+R+U,f._readLocal(r,C,y,s,j,t)}return y},f._readLocal=function(e,t,l,o,p,y){var r=f.bin.readUshort,i=f.bin.readUint;i(e,t),r(e,t+=4),r(e,t+=2);var n=r(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var s=r(e,t+=8),h=r(e,t+=2);t+=2;var m=f.bin.readUTF8(e,t,s);if(t+=s,t+=h,y)l[m]={size:p,csize:o};else{var j=new Uint8Array(e.buffer,t);if(n==0)l[m]=new Uint8Array(j.buffer.slice(t,t+o));else{if(n!=8)throw"unknown compression method: "+n;var x=new Uint8Array(p);f.inflateRaw(j,x),l[m]=x}}},f.inflateRaw=function(e,t){return f.F.inflate(e,t)},f.inflate=function(e,t){return e[0],e[1],f.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},f.deflate=function(e,t){t==null&&(t={level:6});var l=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[l]=120,o[l+1]=156,l+=2,l=f.F.deflateRaw(e,o,l,t.level);var p=f.adler(e,0,e.length);return o[l+0]=p>>>24&255,o[l+1]=p>>>16&255,o[l+2]=p>>>8&255,o[l+3]=p>>>0&255,new Uint8Array(o.buffer,0,l+4)},f.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),o=f.F.deflateRaw(e,l,o,t.level);return new Uint8Array(l.buffer,0,o)},f.encode=function(e,t){t==null&&(t=!1);var l=0,o=f.bin.writeUint,p=f.bin.writeUshort,y={};for(var r in e){var i=!f._noNeed(r)&&!t,n=e[r],s=f.crc.crc(n,0,n.length);y[r]={cpr:i,usize:n.length,crc:s,file:i?f.deflateRaw(n):n}}for(var r in y)l+=y[r].file.length+30+46+2*f.bin.sizeUTF8(r);l+=22;var h=new Uint8Array(l),m=0,j=[];for(var r in y){var x=y[r];j.push(m),m=f._writeHeader(h,m,r,x,0)}var R=0,U=m;for(var r in y)x=y[r],j.push(m),m=f._writeHeader(h,m,r,x,1,j[R++]);var C=m-U;return o(h,m,101010256),m+=4,p(h,m+=4,R),p(h,m+=2,R),o(h,m+=2,C),o(h,m+=4,U),m+=4,m+=2,h.buffer},f._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},f._writeHeader=function(e,t,l,o,p,y){var r=f.bin.writeUint,i=f.bin.writeUshort,n=o.file;return r(e,t,p==0?67324752:33639248),t+=4,p==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,o.cpr?8:0),r(e,t+=2,0),r(e,t+=4,o.crc),r(e,t+=4,n.length),r(e,t+=4,o.usize),i(e,t+=4,f.bin.sizeUTF8(l)),i(e,t+=2,0),t+=2,p==1&&(t+=2,t+=2,r(e,t+=6,y),t+=4),t+=f.bin.writeUTF8(e,t,l),p==0&&(e.set(n,t),t+=n.length),t},f.crc={table:(function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,o=0;o<8;o++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e})(),update:function(e,t,l,o){for(var p=0;p<o;p++)e=f.crc.table[255&(e^t[l+p])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^f.crc.update(4294967295,e,t,l)}},f.adler=function(e,t,l){for(var o=1,p=0,y=t,r=t+l;y<r;){for(var i=Math.min(y+5552,r);y<i;)p+=o+=e[y++];o%=65521,p%=65521}return p<<16|o},f.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var o="",p=0;p<l;p++)o+=String.fromCharCode(e[t+p]);return o},writeASCII:function(e,t,l){for(var o=0;o<l.length;o++)e[t+o]=l.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var o,p="",y=0;y<l;y++)p+="%"+f.bin.pad(e[t+y].toString(16));try{o=decodeURIComponent(p)}catch{return f.bin.readASCII(e,t,l)}return o},writeUTF8:function(e,t,l){for(var o=l.length,p=0,y=0;y<o;y++){var r=l.charCodeAt(y);if((4294967168&r)==0)e[t+p]=r,p++;else if((4294965248&r)==0)e[t+p]=192|r>>6,e[t+p+1]=128|r>>0&63,p+=2;else if((4294901760&r)==0)e[t+p]=224|r>>12,e[t+p+1]=128|r>>6&63,e[t+p+2]=128|r>>0&63,p+=3;else{if((4292870144&r)!=0)throw"e";e[t+p]=240|r>>18,e[t+p+1]=128|r>>12&63,e[t+p+2]=128|r>>6&63,e[t+p+3]=128|r>>0&63,p+=4}}return p},sizeUTF8:function(e){for(var t=e.length,l=0,o=0;o<t;o++){var p=e.charCodeAt(o);if((4294967168&p)==0)l++;else if((4294965248&p)==0)l+=2;else if((4294901760&p)==0)l+=3;else{if((4292870144&p)!=0)throw"e";l+=4}}return l}},f.F={},f.F.deflateRaw=function(e,t,l,o){var p=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],y=f.F.U,r=f.F._goodIndex;f.F._hash;var i=f.F._putsE,n=0,s=l<<3,h=0,m=e.length;if(o==0){for(;n<m;)i(t,s,n+(v=Math.min(65535,m-n))==m?1:0),s=f.F._copyExact(e,n,v,t,s+8),n+=v;return s>>>3}var j=y.lits,x=y.strt,R=y.prev,U=0,C=0,P=0,g=0,M=0,d=0;for(m>2&&(x[d=f.F._hash(e,0)]=0),n=0;n<m;n++){if(M=d,n+1<m-2){d=f.F._hash(e,n+1);var c=n+1&32767;R[c]=x[d],x[d]=c}if(h<=n){(U>14e3||C>26697)&&m-n>100&&(h<n&&(j[U]=n-h,U+=2,h=n),s=f.F._writeBlock(n==m-1||h==m?1:0,j,U,g,e,P,n-P,t,s),U=C=g=0,P=n);var b=0;n<m-2&&(b=f.F._bestMatch(e,n,R,M,Math.min(p[2],m-n),p[3]));var v=b>>>16,A=65535&b;if(b!=0){A=65535&b;var _=r(v=b>>>16,y.of0);y.lhst[257+_]++;var w=r(A,y.df0);y.dhst[w]++,g+=y.exb[_]+y.dxb[w],j[U]=v<<23|n-h,j[U+1]=A<<16|_<<8|w,U+=2,h=n+v}else y.lhst[e[n]]++;C++}}for(P==n&&e.length!=0||(h<n&&(j[U]=n-h,U+=2,h=n),s=f.F._writeBlock(1,j,U,g,e,P,n-P,t,s),U=0,C=0,U=C=g=0,P=n);(7&s)!=0;)s++;return s>>>3},f.F._bestMatch=function(e,t,l,o,p,y){var r=32767&t,i=l[r],n=r-i+32768&32767;if(i==r||o!=f.F._hash(e,t-n))return 0;for(var s=0,h=0,m=Math.min(32767,t);n<=m&&--y!=0&&i!=r;){if(s==0||e[t+s]==e[t+s-n]){var j=f.F._howLong(e,t,n);if(j>s){if(h=n,(s=j)>=p)break;n+2<j&&(j=n+2);for(var x=0,R=0;R<j-2;R++){var U=t-n+R+32768&32767,C=U-l[U]+32768&32767;C>x&&(x=C,i=U)}}}n+=(r=i)-(i=l[r])+32768&32767}return s<<16|h},f.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var o=t,p=Math.min(e.length,t+258);for(t+=3;t<p&&e[t]==e[t-l];)t++;return t-o},f.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},f.saved=0,f.F._writeBlock=function(e,t,l,o,p,y,r,i,n){var s,h,m,j,x,R,U,C,P,g=f.F.U,M=f.F._putsF,d=f.F._putsE;g.lhst[256]++,h=(s=f.F.getTrees())[0],m=s[1],j=s[2],x=s[3],R=s[4],U=s[5],C=s[6],P=s[7];var c=32+((n+3&7)==0?0:8-(n+3&7))+(r<<3),b=o+f.F.contSize(g.fltree,g.lhst)+f.F.contSize(g.fdtree,g.dhst),v=o+f.F.contSize(g.ltree,g.lhst)+f.F.contSize(g.dtree,g.dhst);v+=14+3*U+f.F.contSize(g.itree,g.ihst)+(2*g.ihst[16]+3*g.ihst[17]+7*g.ihst[18]);for(var A=0;A<286;A++)g.lhst[A]=0;for(A=0;A<30;A++)g.dhst[A]=0;for(A=0;A<19;A++)g.ihst[A]=0;var _=c<b&&c<v?0:b<v?1:2;if(M(i,n,e),M(i,n+1,_),n+=3,_==0){for(;(7&n)!=0;)n++;n=f.F._copyExact(p,y,r,i,n)}else{var w,k;if(_==1&&(w=g.fltree,k=g.fdtree),_==2){f.F.makeCodes(g.ltree,h),f.F.revCodes(g.ltree,h),f.F.makeCodes(g.dtree,m),f.F.revCodes(g.dtree,m),f.F.makeCodes(g.itree,j),f.F.revCodes(g.itree,j),w=g.ltree,k=g.dtree,d(i,n,x-257),d(i,n+=5,R-1),d(i,n+=5,U-4),n+=4;for(var u=0;u<U;u++)d(i,n+3*u,g.itree[1+(g.ordr[u]<<1)]);n+=3*U,n=f.F._codeTiny(C,g.itree,i,n),n=f.F._codeTiny(P,g.itree,i,n)}for(var a=y,D=0;D<l;D+=2){for(var E=t[D],L=E>>>23,H=a+(8388607&E);a<H;)n=f.F._writeLit(p[a++],w,i,n);if(L!=0){var N=t[D+1],W=N>>16,O=N>>8&255,T=255&N;d(i,n=f.F._writeLit(257+O,w,i,n),L-g.of0[O]),n+=g.exb[O],M(i,n=f.F._writeLit(T,k,i,n),W-g.df0[T]),n+=g.dxb[T],a+=L}}n=f.F._writeLit(256,w,i,n)}return n},f.F._copyExact=function(e,t,l,o,p){var y=p>>>3;return o[y]=l,o[y+1]=l>>>8,o[y+2]=255-o[y],o[y+3]=255-o[y+1],y+=4,o.set(new Uint8Array(e.buffer,t,l),y),p+(l+4<<3)},f.F.getTrees=function(){for(var e=f.F.U,t=f.F._hufTree(e.lhst,e.ltree,15),l=f.F._hufTree(e.dhst,e.dtree,15),o=[],p=f.F._lenCodes(e.ltree,o),y=[],r=f.F._lenCodes(e.dtree,y),i=0;i<o.length;i+=2)e.ihst[o[i]]++;for(i=0;i<y.length;i+=2)e.ihst[y[i]]++;for(var n=f.F._hufTree(e.ihst,e.itree,7),s=19;s>4&&e.itree[1+(e.ordr[s-1]<<1)]==0;)s--;return[t,l,n,p,r,s,o,y]},f.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},f.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},f.F.contSize=function(e,t){for(var l=0,o=0;o<t.length;o++)l+=t[o]*e[1+(o<<1)];return l},f.F._codeTiny=function(e,t,l,o){for(var p=0;p<e.length;p+=2){var y=e[p],r=e[p+1];o=f.F._writeLit(y,t,l,o);var i=y==16?2:y==17?3:7;y>15&&(f.F._putsE(l,o,r,i),o+=i)}return o},f.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var o=0;o<l;o+=2){var p=e[o+1],y=o+3<l?e[o+3]:-1,r=o+5<l?e[o+5]:-1,i=o==0?-1:e[o-1];if(p==0&&y==p&&r==p){for(var n=o+5;n+2<l&&e[n+2]==p;)n+=2;(s=Math.min(n+1-o>>>1,138))<11?t.push(17,s-3):t.push(18,s-11),o+=2*s-2}else if(p==i&&y==p&&r==p){for(n=o+5;n+2<l&&e[n+2]==p;)n+=2;var s=Math.min(n+1-o>>>1,6);t.push(16,s-3),o+=2*s-2}else t.push(p,0)}return l>>>1},f.F._hufTree=function(e,t,l){var o=[],p=e.length,y=t.length,r=0;for(r=0;r<y;r+=2)t[r]=0,t[r+1]=0;for(r=0;r<p;r++)e[r]!=0&&o.push({lit:r,f:e[r]});var i=o.length,n=o.slice(0);if(i==0)return 0;if(i==1){var s=o[0].lit;return n=s==0?1:0,t[1+(s<<1)]=1,t[1+(n<<1)]=1,1}o.sort((function(C,P){return C.f-P.f}));var h=o[0],m=o[1],j=0,x=1,R=2;for(o[0]={lit:-1,f:h.f+m.f,l:h,r:m,d:0};x!=i-1;)h=j!=x&&(R==i||o[j].f<o[R].f)?o[j++]:o[R++],m=j!=x&&(R==i||o[j].f<o[R].f)?o[j++]:o[R++],o[x++]={lit:-1,f:h.f+m.f,l:h,r:m};var U=f.F.setDepth(o[x-1],0);for(U>l&&(f.F.restrictDepth(n,l,U),U=l),r=0;r<i;r++)t[1+(n[r].lit<<1)]=n[r].d;return U},f.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(f.F.setDepth(e.l,t+1),f.F.setDepth(e.r,t+1))},f.F.restrictDepth=function(e,t,l){var o=0,p=1<<l-t,y=0;for(e.sort((function(i,n){return n.d==i.d?i.f-n.f:n.d-i.d})),o=0;o<e.length&&e[o].d>t;o++){var r=e[o].d;e[o].d=t,y+=p-(1<<l-r)}for(y>>>=l-t;y>0;)(r=e[o].d)<t?(e[o].d++,y-=1<<t-r-1):o++;for(;o>=0;o--)e[o].d==t&&y<0&&(e[o].d--,y++);y!=0&&console.log("debt left")},f.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},f.F._writeLit=function(e,t,l,o){return f.F._putsF(l,o,t[e<<1]),o+t[1+(e<<1)]},f.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var o=f.F,p=o._bitsF,y=o._bitsE,r=o._decodeTiny,i=o.makeCodes,n=o.codes2map,s=o._get17,h=o.U,m=t==null;m&&(t=new l(e.length>>>2<<3));for(var j,x,R=0,U=0,C=0,P=0,g=0,M=0,d=0,c=0,b=0;R==0;)if(R=p(e,b,1),U=p(e,b+1,2),b+=3,U!=0){if(m&&(t=f.F._check(t,c+(1<<17))),U==1&&(j=h.flmap,x=h.fdmap,M=511,d=31),U==2){C=y(e,b,5)+257,P=y(e,b+5,5)+1,g=y(e,b+10,4)+4,b+=14;for(var v=0;v<38;v+=2)h.itree[v]=0,h.itree[v+1]=0;var A=1;for(v=0;v<g;v++){var _=y(e,b+3*v,3);h.itree[1+(h.ordr[v]<<1)]=_,_>A&&(A=_)}b+=3*g,i(h.itree,A),n(h.itree,A,h.imap),j=h.lmap,x=h.dmap,b=r(h.imap,(1<<A)-1,C+P,e,b,h.ttree);var w=o._copyOut(h.ttree,0,C,h.ltree);M=(1<<w)-1;var k=o._copyOut(h.ttree,C,P,h.dtree);d=(1<<k)-1,i(h.ltree,w),n(h.ltree,w,j),i(h.dtree,k),n(h.dtree,k,x)}for(;;){var u=j[s(e,b)&M];b+=15&u;var a=u>>>4;if(!(a>>>8))t[c++]=a;else{if(a==256)break;var D=c+a-254;if(a>264){var E=h.ldef[a-257];D=c+(E>>>3)+y(e,b,7&E),b+=7&E}var L=x[s(e,b)&d];b+=15&L;var H=L>>>4,N=h.ddef[H],W=(N>>>4)+p(e,b,15&N);for(b+=15&N,m&&(t=f.F._check(t,c+(1<<17)));c<D;)t[c]=t[c++-W],t[c]=t[c++-W],t[c]=t[c++-W],t[c]=t[c++-W];c=D}}}else{(7&b)!=0&&(b+=8-(7&b));var O=4+(b>>>3),T=e[O-4]|e[O-3]<<8;m&&(t=f.F._check(t,c+T)),t.set(new l(e.buffer,e.byteOffset+O,T),c),b=O+T<<3,c+=T}return t.length==c?t:t.slice(0,c)},f.F._check=function(e,t){var l=e.length;if(t<=l)return e;var o=new Uint8Array(Math.max(l<<1,t));return o.set(e,0),o},f.F._decodeTiny=function(e,t,l,o,p,y){for(var r=f.F._bitsE,i=f.F._get17,n=0;n<l;){var s=e[i(o,p)&t];p+=15&s;var h=s>>>4;if(h<=15)y[n]=h,n++;else{var m=0,j=0;h==16?(j=3+r(o,p,2),p+=2,m=y[n-1]):h==17?(j=3+r(o,p,3),p+=3):h==18&&(j=11+r(o,p,7),p+=7);for(var x=n+j;n<x;)y[n]=m,n++}}return p},f.F._copyOut=function(e,t,l,o){for(var p=0,y=0,r=o.length>>>1;y<l;){var i=e[y+t];o[y<<1]=0,o[1+(y<<1)]=i,i>p&&(p=i),y++}for(;y<r;)o[y<<1]=0,o[1+(y<<1)]=0,y++;return p},f.F.makeCodes=function(e,t){for(var l,o,p,y,r=f.F.U,i=e.length,n=r.bl_count,s=0;s<=t;s++)n[s]=0;for(s=1;s<i;s+=2)n[e[s]]++;var h=r.next_code;for(l=0,n[0]=0,o=1;o<=t;o++)l=l+n[o-1]<<1,h[o]=l;for(p=0;p<i;p+=2)(y=e[p+1])!=0&&(e[p]=h[y],h[y]++)},f.F.codes2map=function(e,t,l){for(var o=e.length,p=f.F.U.rev15,y=0;y<o;y+=2)if(e[y+1]!=0)for(var r=y>>1,i=e[y+1],n=r<<4|i,s=t-i,h=e[y]<<s,m=h+(1<<s);h!=m;)l[p[h]>>>15-t]=n,h++},f.F.revCodes=function(e,t){for(var l=f.F.U.rev15,o=15-t,p=0;p<e.length;p+=2){var y=e[p]<<t-e[p+1];e[p]=l[y]>>>o}},f.F._putsE=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8},f.F._putsF=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8,e[o+2]|=l>>>16},f.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},f.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},f.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},f.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},f.F.U=(F=Uint16Array,z=Uint32Array,{next_code:new F(16),bl_count:new F(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new F(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new z(32),flmap:new F(512),fltree:[],fdmap:new F(32),fdtree:[],lmap:new F(32768),ltree:[],ttree:[],dmap:new F(32768),dtree:[],imap:new F(512),itree:[],rev15:new F(32768),lhst:new z(286),dhst:new z(30),ihst:new z(19),lits:new z(15e3),strt:new F(65536),prev:new F(32768)}),(function(){for(var e=f.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function o(p,y,r){for(;y--!=0;)p.push(0,r)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),f.F.makeCodes(e.fltree,9),f.F.codes2map(e.fltree,9,e.flmap),f.F.revCodes(e.fltree,9),o(e.fdtree,32,5),f.F.makeCodes(e.fdtree,5),f.F.codes2map(e.fdtree,5,e.fdmap),f.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)})()})();var pt=dt({__proto__:null,default:Te},[Te]);const ge=(function(){var S={nextZero(r,i){for(;r[i]!=0;)i++;return i},readUshort:(r,i)=>r[i]<<8|r[i+1],writeUshort(r,i,n){r[i]=n>>8&255,r[i+1]=255&n},readUint:(r,i)=>16777216*r[i]+(r[i+1]<<16|r[i+2]<<8|r[i+3]),writeUint(r,i,n){r[i]=n>>24&255,r[i+1]=n>>16&255,r[i+2]=n>>8&255,r[i+3]=255&n},readASCII(r,i,n){let s="";for(let h=0;h<n;h++)s+=String.fromCharCode(r[i+h]);return s},writeASCII(r,i,n){for(let s=0;s<n.length;s++)r[i+s]=n.charCodeAt(s)},readBytes(r,i,n){const s=[];for(let h=0;h<n;h++)s.push(r[i+h]);return s},pad:r=>r.length<2?`0${r}`:r,readUTF8(r,i,n){let s,h="";for(let m=0;m<n;m++)h+=`%${S.pad(r[i+m].toString(16))}`;try{s=decodeURIComponent(h)}catch{return S.readASCII(r,i,n)}return s}};function F(r,i,n,s){const h=i*n,m=t(s),j=Math.ceil(i*m/8),x=new Uint8Array(4*h),R=new Uint32Array(x.buffer),{ctype:U}=s,{depth:C}=s,P=S.readUshort;if(U==6){const E=h<<2;if(C==8)for(var g=0;g<E;g+=4)x[g]=r[g],x[g+1]=r[g+1],x[g+2]=r[g+2],x[g+3]=r[g+3];if(C==16)for(g=0;g<E;g++)x[g]=r[g<<1]}else if(U==2){const E=s.tabs.tRNS;if(E==null){if(C==8)for(g=0;g<h;g++){var M=3*g;R[g]=255<<24|r[M+2]<<16|r[M+1]<<8|r[M]}if(C==16)for(g=0;g<h;g++)M=6*g,R[g]=255<<24|r[M+4]<<16|r[M+2]<<8|r[M]}else{var d=E[0];const L=E[1],H=E[2];if(C==8)for(g=0;g<h;g++){var c=g<<2;M=3*g,R[g]=255<<24|r[M+2]<<16|r[M+1]<<8|r[M],r[M]==d&&r[M+1]==L&&r[M+2]==H&&(x[c+3]=0)}if(C==16)for(g=0;g<h;g++)c=g<<2,M=6*g,R[g]=255<<24|r[M+4]<<16|r[M+2]<<8|r[M],P(r,M)==d&&P(r,M+2)==L&&P(r,M+4)==H&&(x[c+3]=0)}}else if(U==3){const E=s.tabs.PLTE,L=s.tabs.tRNS,H=L?L.length:0;if(C==1)for(var b=0;b<n;b++){var v=b*j,A=b*i;for(g=0;g<i;g++){c=A+g<<2;var _=3*(w=r[v+(g>>3)]>>7-((7&g)<<0)&1);x[c]=E[_],x[c+1]=E[_+1],x[c+2]=E[_+2],x[c+3]=w<H?L[w]:255}}if(C==2)for(b=0;b<n;b++)for(v=b*j,A=b*i,g=0;g<i;g++)c=A+g<<2,_=3*(w=r[v+(g>>2)]>>6-((3&g)<<1)&3),x[c]=E[_],x[c+1]=E[_+1],x[c+2]=E[_+2],x[c+3]=w<H?L[w]:255;if(C==4)for(b=0;b<n;b++)for(v=b*j,A=b*i,g=0;g<i;g++)c=A+g<<2,_=3*(w=r[v+(g>>1)]>>4-((1&g)<<2)&15),x[c]=E[_],x[c+1]=E[_+1],x[c+2]=E[_+2],x[c+3]=w<H?L[w]:255;if(C==8)for(g=0;g<h;g++){var w;c=g<<2,_=3*(w=r[g]),x[c]=E[_],x[c+1]=E[_+1],x[c+2]=E[_+2],x[c+3]=w<H?L[w]:255}}else if(U==4){if(C==8)for(g=0;g<h;g++){c=g<<2;var k=r[u=g<<1];x[c]=k,x[c+1]=k,x[c+2]=k,x[c+3]=r[u+1]}if(C==16)for(g=0;g<h;g++){var u;c=g<<2,k=r[u=g<<2],x[c]=k,x[c+1]=k,x[c+2]=k,x[c+3]=r[u+2]}}else if(U==0)for(d=s.tabs.tRNS?s.tabs.tRNS:-1,b=0;b<n;b++){const E=b*j,L=b*i;if(C==1)for(var a=0;a<i;a++){var D=(k=255*(r[E+(a>>>3)]>>>7-(7&a)&1))==255*d?0:255;R[L+a]=D<<24|k<<16|k<<8|k}else if(C==2)for(a=0;a<i;a++)D=(k=85*(r[E+(a>>>2)]>>>6-((3&a)<<1)&3))==85*d?0:255,R[L+a]=D<<24|k<<16|k<<8|k;else if(C==4)for(a=0;a<i;a++)D=(k=17*(r[E+(a>>>1)]>>>4-((1&a)<<2)&15))==17*d?0:255,R[L+a]=D<<24|k<<16|k<<8|k;else if(C==8)for(a=0;a<i;a++)D=(k=r[E+a])==d?0:255,R[L+a]=D<<24|k<<16|k<<8|k;else if(C==16)for(a=0;a<i;a++)k=r[E+(a<<1)],D=P(r,E+(a<<1))==d?0:255,R[L+a]=D<<24|k<<16|k<<8|k}return x}function z(r,i,n,s){const h=t(r),m=Math.ceil(n*h/8),j=new Uint8Array((m+1+r.interlace)*s);return i=r.tabs.CgBI?e(i,j):f(i,j),r.interlace==0?i=l(i,r,0,n,s):r.interlace==1&&(i=(function(R,U){const C=U.width,P=U.height,g=t(U),M=g>>3,d=Math.ceil(C*g/8),c=new Uint8Array(P*d);let b=0;const v=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],_=[8,8,8,4,4,2,2],w=[8,8,4,4,2,2,1];let k=0;for(;k<7;){const a=_[k],D=w[k];let E=0,L=0,H=v[k];for(;H<P;)H+=a,L++;let N=A[k];for(;N<C;)N+=D,E++;const W=Math.ceil(E*g/8);l(R,U,b,E,L);let O=0,T=v[k];for(;T<P;){let B=A[k],X=b+O*W<<3;for(;B<C;){var u;if(g==1&&(u=(u=R[X>>3])>>7-(7&X)&1,c[T*d+(B>>3)]|=u<<7-((7&B)<<0)),g==2&&(u=(u=R[X>>3])>>6-(7&X)&3,c[T*d+(B>>2)]|=u<<6-((3&B)<<1)),g==4&&(u=(u=R[X>>3])>>4-(7&X)&15,c[T*d+(B>>1)]|=u<<4-((1&B)<<2)),g>=8){const G=T*d+B*M;for(let q=0;q<M;q++)c[G+q]=R[(X>>3)+q]}X+=g,B+=D}O++,T+=a}E*L!=0&&(b+=L*(1+W)),k+=1}return c})(i,r)),i}function f(r,i){return e(new Uint8Array(r.buffer,2,r.length-6),i)}var e=(function(){const r={H:{}};return r.H.N=function(i,n){const s=Uint8Array;let h,m,j=0,x=0,R=0,U=0,C=0,P=0,g=0,M=0,d=0;if(i[0]==3&&i[1]==0)return n||new s(0);const c=r.H,b=c.b,v=c.e,A=c.R,_=c.n,w=c.A,k=c.Z,u=c.m,a=n==null;for(a&&(n=new s(i.length>>>2<<5));j==0;)if(j=b(i,d,1),x=b(i,d+1,2),d+=3,x!=0){if(a&&(n=r.H.W(n,M+(1<<17))),x==1&&(h=u.J,m=u.h,P=511,g=31),x==2){R=v(i,d,5)+257,U=v(i,d+5,5)+1,C=v(i,d+10,4)+4,d+=14;let E=1;for(var D=0;D<38;D+=2)u.Q[D]=0,u.Q[D+1]=0;for(D=0;D<C;D++){const N=v(i,d+3*D,3);u.Q[1+(u.X[D]<<1)]=N,N>E&&(E=N)}d+=3*C,_(u.Q,E),w(u.Q,E,u.u),h=u.w,m=u.d,d=A(u.u,(1<<E)-1,R+U,i,d,u.v);const L=c.V(u.v,0,R,u.C);P=(1<<L)-1;const H=c.V(u.v,R,U,u.D);g=(1<<H)-1,_(u.C,L),w(u.C,L,h),_(u.D,H),w(u.D,H,m)}for(;;){const E=h[k(i,d)&P];d+=15&E;const L=E>>>4;if(!(L>>>8))n[M++]=L;else{if(L==256)break;{let H=M+L-254;if(L>264){const B=u.q[L-257];H=M+(B>>>3)+v(i,d,7&B),d+=7&B}const N=m[k(i,d)&g];d+=15&N;const W=N>>>4,O=u.c[W],T=(O>>>4)+b(i,d,15&O);for(d+=15&O;M<H;)n[M]=n[M++-T],n[M]=n[M++-T],n[M]=n[M++-T],n[M]=n[M++-T];M=H}}}}else{(7&d)!=0&&(d+=8-(7&d));const E=4+(d>>>3),L=i[E-4]|i[E-3]<<8;a&&(n=r.H.W(n,M+L)),n.set(new s(i.buffer,i.byteOffset+E,L),M),d=E+L<<3,M+=L}return n.length==M?n:n.slice(0,M)},r.H.W=function(i,n){const s=i.length;if(n<=s)return i;const h=new Uint8Array(s<<1);return h.set(i,0),h},r.H.R=function(i,n,s,h,m,j){const x=r.H.e,R=r.H.Z;let U=0;for(;U<s;){const C=i[R(h,m)&n];m+=15&C;const P=C>>>4;if(P<=15)j[U]=P,U++;else{let g=0,M=0;P==16?(M=3+x(h,m,2),m+=2,g=j[U-1]):P==17?(M=3+x(h,m,3),m+=3):P==18&&(M=11+x(h,m,7),m+=7);const d=U+M;for(;U<d;)j[U]=g,U++}}return m},r.H.V=function(i,n,s,h){let m=0,j=0;const x=h.length>>>1;for(;j<s;){const R=i[j+n];h[j<<1]=0,h[1+(j<<1)]=R,R>m&&(m=R),j++}for(;j<x;)h[j<<1]=0,h[1+(j<<1)]=0,j++;return m},r.H.n=function(i,n){const s=r.H.m,h=i.length;let m,j,x,R;const U=s.j;for(var C=0;C<=n;C++)U[C]=0;for(C=1;C<h;C+=2)U[i[C]]++;const P=s.K;for(m=0,U[0]=0,j=1;j<=n;j++)m=m+U[j-1]<<1,P[j]=m;for(x=0;x<h;x+=2)R=i[x+1],R!=0&&(i[x]=P[R],P[R]++)},r.H.A=function(i,n,s){const h=i.length,m=r.H.m.r;for(let j=0;j<h;j+=2)if(i[j+1]!=0){const x=j>>1,R=i[j+1],U=x<<4|R,C=n-R;let P=i[j]<<C;const g=P+(1<<C);for(;P!=g;)s[m[P]>>>15-n]=U,P++}},r.H.l=function(i,n){const s=r.H.m.r,h=15-n;for(let m=0;m<i.length;m+=2){const j=i[m]<<n-i[m+1];i[m]=s[j]>>>h}},r.H.M=function(i,n,s){s<<=7&n;const h=n>>>3;i[h]|=s,i[h+1]|=s>>>8},r.H.I=function(i,n,s){s<<=7&n;const h=n>>>3;i[h]|=s,i[h+1]|=s>>>8,i[h+2]|=s>>>16},r.H.e=function(i,n,s){return(i[n>>>3]|i[1+(n>>>3)]<<8)>>>(7&n)&(1<<s)-1},r.H.b=function(i,n,s){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)&(1<<s)-1},r.H.Z=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)},r.H.i=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16|i[3+(n>>>3)]<<24)>>>(7&n)},r.H.m=(function(){const i=Uint16Array,n=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=r.H.m;for(var n=0;n<32768;n++){let h=n;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[n]=(h>>>16|h<<16)>>>17}function s(h,m,j){for(;m--!=0;)h.push(0,j)}for(n=0;n<32;n++)i.q[n]=i.S[n]<<3|i.T[n],i.c[n]=i.p[n]<<4|i.z[n];s(i._,144,8),s(i._,112,9),s(i._,24,7),s(i._,8,8),r.H.n(i._,9),r.H.A(i._,9,i.J),r.H.l(i._,9),s(i.$,32,5),r.H.n(i.$,5),r.H.A(i.$,5,i.h),r.H.l(i.$,5),s(i.Q,19,0),s(i.C,286,0),s(i.D,30,0),s(i.v,320,0)})(),r.H.N})();function t(r){return[1,null,3,1,2,null,4][r.ctype]*r.depth}function l(r,i,n,s,h){let m=t(i);const j=Math.ceil(s*m/8);let x,R;m=Math.ceil(m/8);let U=r[n],C=0;if(U>1&&(r[n]=[0,0,1][U-2]),U==3)for(C=m;C<j;C++)r[C+1]=r[C+1]+(r[C+1-m]>>>1)&255;for(let P=0;P<h;P++)if(x=n+P*j,R=x+P+1,U=r[R-1],C=0,U==0)for(;C<j;C++)r[x+C]=r[R+C];else if(U==1){for(;C<m;C++)r[x+C]=r[R+C];for(;C<j;C++)r[x+C]=r[R+C]+r[x+C-m]}else if(U==2)for(;C<j;C++)r[x+C]=r[R+C]+r[x+C-j];else if(U==3){for(;C<m;C++)r[x+C]=r[R+C]+(r[x+C-j]>>>1);for(;C<j;C++)r[x+C]=r[R+C]+(r[x+C-j]+r[x+C-m]>>>1)}else{for(;C<m;C++)r[x+C]=r[R+C]+o(0,r[x+C-j],0);for(;C<j;C++)r[x+C]=r[R+C]+o(r[x+C-m],r[x+C-j],r[x+C-m-j])}return r}function o(r,i,n){const s=r+i-n,h=s-r,m=s-i,j=s-n;return h*h<=m*m&&h*h<=j*j?r:m*m<=j*j?i:n}function p(r,i,n){n.width=S.readUint(r,i),i+=4,n.height=S.readUint(r,i),i+=4,n.depth=r[i],i++,n.ctype=r[i],i++,n.compress=r[i],i++,n.filter=r[i],i++,n.interlace=r[i],i++}function y(r,i,n,s,h,m,j,x,R){const U=Math.min(i,h),C=Math.min(n,m);let P=0,g=0;for(let k=0;k<C;k++)for(let u=0;u<U;u++)if(j>=0&&x>=0?(P=k*i+u<<2,g=(x+k)*h+j+u<<2):(P=(-x+k)*i-j+u<<2,g=k*h+u<<2),R==0)s[g]=r[P],s[g+1]=r[P+1],s[g+2]=r[P+2],s[g+3]=r[P+3];else if(R==1){var M=r[P+3]*.00392156862745098,d=r[P]*M,c=r[P+1]*M,b=r[P+2]*M,v=s[g+3]*(1/255),A=s[g]*v,_=s[g+1]*v,w=s[g+2]*v;const a=1-M,D=M+v*a,E=D==0?0:1/D;s[g+3]=255*D,s[g+0]=(d+A*a)*E,s[g+1]=(c+_*a)*E,s[g+2]=(b+w*a)*E}else if(R==2)M=r[P+3],d=r[P],c=r[P+1],b=r[P+2],v=s[g+3],A=s[g],_=s[g+1],w=s[g+2],M==v&&d==A&&c==_&&b==w?(s[g]=0,s[g+1]=0,s[g+2]=0,s[g+3]=0):(s[g]=d,s[g+1]=c,s[g+2]=b,s[g+3]=M);else if(R==3){if(M=r[P+3],d=r[P],c=r[P+1],b=r[P+2],v=s[g+3],A=s[g],_=s[g+1],w=s[g+2],M==v&&d==A&&c==_&&b==w)continue;if(M<220&&v>20)return!1}return!0}return{decode:function(i){const n=new Uint8Array(i);let s=8;const h=S,m=h.readUshort,j=h.readUint,x={tabs:{},frames:[]},R=new Uint8Array(n.length);let U,C=0,P=0;const g=[137,80,78,71,13,10,26,10];for(var M=0;M<8;M++)if(n[M]!=g[M])throw"The input is not a PNG file!";for(;s<n.length;){const k=h.readUint(n,s);s+=4;const u=h.readASCII(n,s,4);if(s+=4,u=="IHDR")p(n,s,x);else if(u=="iCCP"){for(var d=s;n[d]!=0;)d++;h.readASCII(n,s,d-s),n[d+1];const a=n.slice(d+2,s+k);let D=null;try{D=f(a)}catch{D=e(a)}x.tabs[u]=D}else if(u=="CgBI")x.tabs[u]=n.slice(s,s+4);else if(u=="IDAT"){for(M=0;M<k;M++)R[C+M]=n[s+M];C+=k}else if(u=="acTL")x.tabs[u]={num_frames:j(n,s),num_plays:j(n,s+4)},U=new Uint8Array(n.length);else if(u=="fcTL"){P!=0&&((w=x.frames[x.frames.length-1]).data=z(x,U.slice(0,P),w.rect.width,w.rect.height),P=0);const a={x:j(n,s+12),y:j(n,s+16),width:j(n,s+4),height:j(n,s+8)};let D=m(n,s+22);D=m(n,s+20)/(D==0?100:D);const E={rect:a,delay:Math.round(1e3*D),dispose:n[s+24],blend:n[s+25]};x.frames.push(E)}else if(u=="fdAT"){for(M=0;M<k-4;M++)U[P+M]=n[s+M+4];P+=k-4}else if(u=="pHYs")x.tabs[u]=[h.readUint(n,s),h.readUint(n,s+4),n[s+8]];else if(u=="cHRM")for(x.tabs[u]=[],M=0;M<8;M++)x.tabs[u].push(h.readUint(n,s+4*M));else if(u=="tEXt"||u=="zTXt"){x.tabs[u]==null&&(x.tabs[u]={});var c=h.nextZero(n,s),b=h.readASCII(n,s,c-s),v=s+k-c-1;if(u=="tEXt")_=h.readASCII(n,c+1,v);else{var A=f(n.slice(c+2,c+2+v));_=h.readUTF8(A,0,A.length)}x.tabs[u][b]=_}else if(u=="iTXt"){x.tabs[u]==null&&(x.tabs[u]={}),c=0,d=s,c=h.nextZero(n,d),b=h.readASCII(n,d,c-d);const a=n[d=c+1];var _;n[d+1],d+=2,c=h.nextZero(n,d),h.readASCII(n,d,c-d),d=c+1,c=h.nextZero(n,d),h.readUTF8(n,d,c-d),v=k-((d=c+1)-s),a==0?_=h.readUTF8(n,d,v):(A=f(n.slice(d,d+v)),_=h.readUTF8(A,0,A.length)),x.tabs[u][b]=_}else if(u=="PLTE")x.tabs[u]=h.readBytes(n,s,k);else if(u=="hIST"){const a=x.tabs.PLTE.length/3;for(x.tabs[u]=[],M=0;M<a;M++)x.tabs[u].push(m(n,s+2*M))}else if(u=="tRNS")x.ctype==3?x.tabs[u]=h.readBytes(n,s,k):x.ctype==0?x.tabs[u]=m(n,s):x.ctype==2&&(x.tabs[u]=[m(n,s),m(n,s+2),m(n,s+4)]);else if(u=="gAMA")x.tabs[u]=h.readUint(n,s)/1e5;else if(u=="sRGB")x.tabs[u]=n[s];else if(u=="bKGD")x.ctype==0||x.ctype==4?x.tabs[u]=[m(n,s)]:x.ctype==2||x.ctype==6?x.tabs[u]=[m(n,s),m(n,s+2),m(n,s+4)]:x.ctype==3&&(x.tabs[u]=n[s]);else if(u=="IEND")break;s+=k,h.readUint(n,s),s+=4}var w;return P!=0&&((w=x.frames[x.frames.length-1]).data=z(x,U.slice(0,P),w.rect.width,w.rect.height)),x.data=z(x,R,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(i){const n=i.width,s=i.height;if(i.tabs.acTL==null)return[F(i.data,n,s,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const m=n*s*4,j=new Uint8Array(m),x=new Uint8Array(m),R=new Uint8Array(m);for(let C=0;C<i.frames.length;C++){const P=i.frames[C],g=P.rect.x,M=P.rect.y,d=P.rect.width,c=P.rect.height,b=F(P.data,d,c,i);if(C!=0)for(var U=0;U<m;U++)R[U]=j[U];if(P.blend==0?y(b,d,c,j,n,s,g,M,0):P.blend==1&&y(b,d,c,j,n,s,g,M,1),h.push(j.buffer.slice(0)),P.dispose!=0){if(P.dispose==1)y(x,d,c,j,n,s,g,M,0);else if(P.dispose==2)for(U=0;U<m;U++)j[U]=R[U]}}return h},_paeth:o,_copyTile:y,_bin:S}})();(function(){const{_copyTile:S}=ge,{_bin:F}=ge,z=ge._paeth;var f={table:(function(){const d=new Uint32Array(256);for(let c=0;c<256;c++){let b=c;for(let v=0;v<8;v++)1&b?b=3988292384^b>>>1:b>>>=1;d[c]=b}return d})(),update(d,c,b,v){for(let A=0;A<v;A++)d=f.table[255&(d^c[b+A])]^d>>>8;return d},crc:(d,c,b)=>4294967295^f.update(4294967295,d,c,b)};function e(d,c,b,v){c[b]+=d[0]*v>>4,c[b+1]+=d[1]*v>>4,c[b+2]+=d[2]*v>>4,c[b+3]+=d[3]*v>>4}function t(d){return Math.max(0,Math.min(255,d))}function l(d,c){const b=d[0]-c[0],v=d[1]-c[1],A=d[2]-c[2],_=d[3]-c[3];return b*b+v*v+A*A+_*_}function o(d,c,b,v,A,_,w){w==null&&(w=1);const k=v.length,u=[];for(var a=0;a<k;a++){const T=v[a];u.push([T>>>0&255,T>>>8&255,T>>>16&255,T>>>24&255])}for(a=0;a<k;a++){let T=4294967295;for(var D=0,E=0;E<k;E++){var L=l(u[a],u[E]);E!=a&&L<T&&(T=L,D=E)}}const H=new Uint32Array(A.buffer),N=new Int16Array(c*b*4),W=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(a=0;a<W.length;a++)W[a]=255*((W[a]+.5)/16-.5);for(let T=0;T<b;T++)for(let B=0;B<c;B++){var O;a=4*(T*c+B),w!=2?O=[t(d[a]+N[a]),t(d[a+1]+N[a+1]),t(d[a+2]+N[a+2]),t(d[a+3]+N[a+3])]:(L=W[4*(3&T)+(3&B)],O=[t(d[a]+L),t(d[a+1]+L),t(d[a+2]+L),t(d[a+3]+L)]),D=0;let X=16777215;for(E=0;E<k;E++){const K=l(O,u[E]);K<X&&(X=K,D=E)}const G=u[D],q=[O[0]-G[0],O[1]-G[1],O[2]-G[2],O[3]-G[3]];w==1&&(B!=c-1&&e(q,N,a+4,7),T!=b-1&&(B!=0&&e(q,N,a+4*c-4,3),e(q,N,a+4*c,5),B!=c-1&&e(q,N,a+4*c+4,1))),_[a>>2]=D,H[a>>2]=v[D]}}function p(d,c,b,v,A){A==null&&(A={});const{crc:_}=f,w=F.writeUint,k=F.writeUshort,u=F.writeASCII;let a=8;const D=d.frames.length>1;let E,L=!1,H=33+(D?20:0);if(A.sRGB!=null&&(H+=13),A.pHYs!=null&&(H+=21),A.iCCP!=null&&(E=pako.deflate(A.iCCP),H+=21+E.length+4),d.ctype==3){for(var N=d.plte.length,W=0;W<N;W++)d.plte[W]>>>24!=255&&(L=!0);H+=8+3*N+4+(L?8+1*N+4:0)}for(var O=0;O<d.frames.length;O++)D&&(H+=38),H+=(G=d.frames[O]).cimg.length+12,O!=0&&(H+=4);H+=12;const T=new Uint8Array(H),B=[137,80,78,71,13,10,26,10];for(W=0;W<8;W++)T[W]=B[W];if(w(T,a,13),a+=4,u(T,a,"IHDR"),a+=4,w(T,a,c),a+=4,w(T,a,b),a+=4,T[a]=d.depth,a++,T[a]=d.ctype,a++,T[a]=0,a++,T[a]=0,a++,T[a]=0,a++,w(T,a,_(T,a-17,17)),a+=4,A.sRGB!=null&&(w(T,a,1),a+=4,u(T,a,"sRGB"),a+=4,T[a]=A.sRGB,a++,w(T,a,_(T,a-5,5)),a+=4),A.iCCP!=null){const q=13+E.length;w(T,a,q),a+=4,u(T,a,"iCCP"),a+=4,u(T,a,"ICC profile"),a+=11,a+=2,T.set(E,a),a+=E.length,w(T,a,_(T,a-(q+4),q+4)),a+=4}if(A.pHYs!=null&&(w(T,a,9),a+=4,u(T,a,"pHYs"),a+=4,w(T,a,A.pHYs[0]),a+=4,w(T,a,A.pHYs[1]),a+=4,T[a]=A.pHYs[2],a++,w(T,a,_(T,a-13,13)),a+=4),D&&(w(T,a,8),a+=4,u(T,a,"acTL"),a+=4,w(T,a,d.frames.length),a+=4,w(T,a,A.loop!=null?A.loop:0),a+=4,w(T,a,_(T,a-12,12)),a+=4),d.ctype==3){for(w(T,a,3*(N=d.plte.length)),a+=4,u(T,a,"PLTE"),a+=4,W=0;W<N;W++){const q=3*W,K=d.plte[W],ee=255&K,re=K>>>8&255,je=K>>>16&255;T[a+q+0]=ee,T[a+q+1]=re,T[a+q+2]=je}if(a+=3*N,w(T,a,_(T,a-3*N-4,3*N+4)),a+=4,L){for(w(T,a,N),a+=4,u(T,a,"tRNS"),a+=4,W=0;W<N;W++)T[a+W]=d.plte[W]>>>24&255;a+=N,w(T,a,_(T,a-N-4,N+4)),a+=4}}let X=0;for(O=0;O<d.frames.length;O++){var G=d.frames[O];D&&(w(T,a,26),a+=4,u(T,a,"fcTL"),a+=4,w(T,a,X++),a+=4,w(T,a,G.rect.width),a+=4,w(T,a,G.rect.height),a+=4,w(T,a,G.rect.x),a+=4,w(T,a,G.rect.y),a+=4,k(T,a,v[O]),a+=2,k(T,a,1e3),a+=2,T[a]=G.dispose,a++,T[a]=G.blend,a++,w(T,a,_(T,a-30,30)),a+=4);const q=G.cimg;w(T,a,(N=q.length)+(O==0?0:4)),a+=4;const K=a;u(T,a,O==0?"IDAT":"fdAT"),a+=4,O!=0&&(w(T,a,X++),a+=4),T.set(q,a),a+=N,w(T,a,_(T,K,a-K)),a+=4}return w(T,a,0),a+=4,u(T,a,"IEND"),a+=4,w(T,a,_(T,a-4,4)),a+=4,T.buffer}function y(d,c,b){for(let v=0;v<d.frames.length;v++){const A=d.frames[v];A.rect.width;const _=A.rect.height,w=new Uint8Array(_*A.bpl+_);A.cimg=s(A.img,_,A.bpp,A.bpl,w,c,b)}}function r(d,c,b,v,A){const _=A[0],w=A[1],k=A[2],u=A[3],a=A[4],D=A[5];let E=6,L=8,H=255;for(var N=0;N<d.length;N++){const oe=new Uint8Array(d[N]);for(var W=oe.length,O=0;O<W;O+=4)H&=oe[O+3]}const T=H!=255,B=(function(Y,V,ie,le,te,de){const ne=[];for(var Z=0;Z<Y.length;Z++){const fe=new Uint8Array(Y[Z]),pe=new Uint32Array(fe.buffer);var ue;let he=0,ye=0,xe=V,Ce=ie,Ne=le?1:0;if(Z!=0){const ft=de||le||Z==1||ne[Z-2].dispose!=0?1:2;let We=0,Qe=1e9;for(let Fe=0;Fe<ft;Fe++){var ve=new Uint8Array(Y[Z-1-Fe]);const ct=new Uint32Array(Y[Z-1-Fe]);let we=V,Ae=ie,ke=-1,Re=-1;for(let _e=0;_e<ie;_e++)for(let Ue=0;Ue<V;Ue++)pe[se=_e*V+Ue]!=ct[se]&&(Ue<we&&(we=Ue),Ue>ke&&(ke=Ue),_e<Ae&&(Ae=_e),_e>Re&&(Re=_e));ke==-1&&(we=Ae=ke=Re=0),te&&((1&we)==1&&we--,(1&Ae)==1&&Ae--);const Ge=(ke-we+1)*(Re-Ae+1);Ge<Qe&&(Qe=Ge,We=Fe,he=we,ye=Ae,xe=ke-we+1,Ce=Re-Ae+1)}ve=new Uint8Array(Y[Z-1-We]),We==1&&(ne[Z-1].dispose=2),ue=new Uint8Array(xe*Ce*4),S(ve,V,ie,ue,xe,Ce,-he,-ye,0),Ne=S(fe,V,ie,ue,xe,Ce,-he,-ye,3)?1:0,Ne==1?n(fe,V,ie,ue,{x:he,y:ye,width:xe,height:Ce}):S(fe,V,ie,ue,xe,Ce,-he,-ye,0)}else ue=fe.slice(0);ne.push({rect:{x:he,y:ye,width:xe,height:Ce},img:ue,blend:Ne,dispose:0})}if(le)for(Z=0;Z<ne.length;Z++){if((Se=ne[Z]).blend==1)continue;const fe=Se.rect,pe=ne[Z-1].rect,he=Math.min(fe.x,pe.x),ye=Math.min(fe.y,pe.y),xe={x:he,y:ye,width:Math.max(fe.x+fe.width,pe.x+pe.width)-he,height:Math.max(fe.y+fe.height,pe.y+pe.height)-ye};ne[Z-1].dispose=1,Z-1!=0&&i(Y,V,ie,ne,Z-1,xe,te),i(Y,V,ie,ne,Z,xe,te)}let Pe=0;if(Y.length!=1)for(var se=0;se<ne.length;se++){var Se;Pe+=(Se=ne[se]).rect.width*Se.rect.height}return ne})(d,c,b,_,w,k),X={},G=[],q=[];if(v!=0){const oe=[];for(O=0;O<B.length;O++)oe.push(B[O].img.buffer);const Y=(function(te){let de=0;for(var ne=0;ne<te.length;ne++)de+=te[ne].byteLength;const Z=new Uint8Array(de);let ue=0;for(ne=0;ne<te.length;ne++){const ve=new Uint8Array(te[ne]),Pe=ve.length;for(let se=0;se<Pe;se+=4){let Se=ve[se],fe=ve[se+1],pe=ve[se+2];const he=ve[se+3];he==0&&(Se=fe=pe=0),Z[ue+se]=Se,Z[ue+se+1]=fe,Z[ue+se+2]=pe,Z[ue+se+3]=he}ue+=Pe}return Z.buffer})(oe),V=m(Y,v);for(O=0;O<V.plte.length;O++)G.push(V.plte[O].est.rgba);let ie=0;for(O=0;O<B.length;O++){const le=(ee=B[O]).img.length;var K=new Uint8Array(V.inds.buffer,ie>>2,le>>2);q.push(K);const te=new Uint8Array(V.abuf,ie,le);D&&o(ee.img,ee.rect.width,ee.rect.height,G,te,K),ee.img.set(te),ie+=le}}else for(N=0;N<B.length;N++){var ee=B[N];const oe=new Uint32Array(ee.img.buffer);var re=ee.rect.width;for(W=oe.length,K=new Uint8Array(W),q.push(K),O=0;O<W;O++){const Y=oe[O];if(O!=0&&Y==oe[O-1])K[O]=K[O-1];else if(O>re&&Y==oe[O-re])K[O]=K[O-re];else{let V=X[Y];if(V==null&&(X[Y]=V=G.length,G.push(Y),G.length>=300))break;K[O]=V}}}const je=G.length;for(je<=256&&a==0&&(L=je<=2?1:je<=4?2:je<=16?4:8,L=Math.max(L,u)),N=0;N<B.length;N++){(ee=B[N]).rect.x,ee.rect.y,re=ee.rect.width;const oe=ee.rect.height;let Y=ee.img;new Uint32Array(Y.buffer);let V=4*re,ie=4;if(je<=256&&a==0){V=Math.ceil(L*re/8);var me=new Uint8Array(V*oe);const le=q[N];for(let te=0;te<oe;te++){O=te*V;const de=te*re;if(L==8)for(var J=0;J<re;J++)me[O+J]=le[de+J];else if(L==4)for(J=0;J<re;J++)me[O+(J>>1)]|=le[de+J]<<4-4*(1&J);else if(L==2)for(J=0;J<re;J++)me[O+(J>>2)]|=le[de+J]<<6-2*(3&J);else if(L==1)for(J=0;J<re;J++)me[O+(J>>3)]|=le[de+J]<<7-1*(7&J)}Y=me,E=3,ie=1}else if(T==0&&B.length==1){me=new Uint8Array(re*oe*3);const le=re*oe;for(O=0;O<le;O++){const te=3*O,de=4*O;me[te]=Y[de],me[te+1]=Y[de+1],me[te+2]=Y[de+2]}Y=me,E=2,ie=3,V=3*re}ee.img=Y,ee.bpl=V,ee.bpp=ie}return{ctype:E,depth:L,plte:G,frames:B}}function i(d,c,b,v,A,_,w){const k=Uint8Array,u=Uint32Array,a=new k(d[A-1]),D=new u(d[A-1]),E=A+1<d.length?new k(d[A+1]):null,L=new k(d[A]),H=new u(L.buffer);let N=c,W=b,O=-1,T=-1;for(let X=0;X<_.height;X++)for(let G=0;G<_.width;G++){const q=_.x+G,K=_.y+X,ee=K*c+q,re=H[ee];re==0||v[A-1].dispose==0&&D[ee]==re&&(E==null||E[4*ee+3]!=0)||(q<N&&(N=q),q>O&&(O=q),K<W&&(W=K),K>T&&(T=K))}O==-1&&(N=W=O=T=0),w&&((1&N)==1&&N--,(1&W)==1&&W--),_={x:N,y:W,width:O-N+1,height:T-W+1};const B=v[A];B.rect=_,B.blend=1,B.img=new Uint8Array(_.width*_.height*4),v[A-1].dispose==0?(S(a,c,b,B.img,_.width,_.height,-_.x,-_.y,0),n(L,c,b,B.img,_)):S(L,c,b,B.img,_.width,_.height,-_.x,-_.y,0)}function n(d,c,b,v,A){S(d,c,b,v,A.width,A.height,-A.x,-A.y,2)}function s(d,c,b,v,A,_,w){const k=[];let u,a=[0,1,2,3,4];_!=-1?a=[_]:(c*v>5e5||b==1)&&(a=[0]),w&&(u={level:0});const D=pt;for(var E=0;E<a.length;E++){for(let N=0;N<c;N++)h(A,d,N,v,b,a[E]);k.push(D.deflate(A,u))}let L,H=1e9;for(E=0;E<k.length;E++)k[E].length<H&&(L=E,H=k[E].length);return k[L]}function h(d,c,b,v,A,_){const w=b*v;let k=w+b;if(d[k]=_,k++,_==0)if(v<500)for(var u=0;u<v;u++)d[k+u]=c[w+u];else d.set(new Uint8Array(c.buffer,w,v),k);else if(_==1){for(u=0;u<A;u++)d[k+u]=c[w+u];for(u=A;u<v;u++)d[k+u]=c[w+u]-c[w+u-A]+256&255}else if(b==0){for(u=0;u<A;u++)d[k+u]=c[w+u];if(_==2)for(u=A;u<v;u++)d[k+u]=c[w+u];if(_==3)for(u=A;u<v;u++)d[k+u]=c[w+u]-(c[w+u-A]>>1)+256&255;if(_==4)for(u=A;u<v;u++)d[k+u]=c[w+u]-z(c[w+u-A],0,0)+256&255}else{if(_==2)for(u=0;u<v;u++)d[k+u]=c[w+u]+256-c[w+u-v]&255;if(_==3){for(u=0;u<A;u++)d[k+u]=c[w+u]+256-(c[w+u-v]>>1)&255;for(u=A;u<v;u++)d[k+u]=c[w+u]+256-(c[w+u-v]+c[w+u-A]>>1)&255}if(_==4){for(u=0;u<A;u++)d[k+u]=c[w+u]+256-z(0,c[w+u-v],0)&255;for(u=A;u<v;u++)d[k+u]=c[w+u]+256-z(c[w+u-A],c[w+u-v],c[w+u-A-v])&255}}}function m(d,c){const b=new Uint8Array(d),v=b.slice(0),A=new Uint32Array(v.buffer),_=j(v,c),w=_[0],k=_[1],u=b.length,a=new Uint8Array(u>>2);let D;if(b.length<2e7)for(var E=0;E<u;E+=4)D=x(w,L=b[E]*(1/255),H=b[E+1]*(1/255),N=b[E+2]*(1/255),W=b[E+3]*(1/255)),a[E>>2]=D.ind,A[E>>2]=D.est.rgba;else for(E=0;E<u;E+=4){var L=b[E]*.00392156862745098,H=b[E+1]*(1/255),N=b[E+2]*(1/255),W=b[E+3]*(1/255);for(D=w;D.left;)D=R(D.est,L,H,N,W)<=0?D.left:D.right;a[E>>2]=D.ind,A[E>>2]=D.est.rgba}return{abuf:v.buffer,inds:a,plte:k}}function j(d,c,b){b==null&&(b=1e-4);const v=new Uint32Array(d.buffer),A={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=P(d,A.i0,A.i1),A.est=g(A.bst);const _=[A];for(;_.length<c;){let k=0,u=0;for(var w=0;w<_.length;w++)_[w].est.L>k&&(k=_[w].est.L,u=w);if(k<b)break;const a=_[u],D=U(d,v,a.i0,a.i1,a.est.e,a.est.eMq255);if(a.i0>=D||a.i1<=D){a.est.L=0;continue}const E={i0:a.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};E.bst=P(d,E.i0,E.i1),E.est=g(E.bst);const L={i0:D,i1:a.i1,bst:null,est:null,tdst:0,left:null,right:null};for(L.bst={R:[],m:[],N:a.bst.N-E.bst.N},w=0;w<16;w++)L.bst.R[w]=a.bst.R[w]-E.bst.R[w];for(w=0;w<4;w++)L.bst.m[w]=a.bst.m[w]-E.bst.m[w];L.est=g(L.bst),a.left=E,a.right=L,_[u]=E,_.push(L)}for(_.sort(((k,u)=>u.bst.N-k.bst.N)),w=0;w<_.length;w++)_[w].ind=w;return[A,_]}function x(d,c,b,v,A){if(d.left==null)return d.tdst=(function(E,L,H,N,W){const O=L-E[0],T=H-E[1],B=N-E[2],X=W-E[3];return O*O+T*T+B*B+X*X})(d.est.q,c,b,v,A),d;const _=R(d.est,c,b,v,A);let w=d.left,k=d.right;_>0&&(w=d.right,k=d.left);const u=x(w,c,b,v,A);if(u.tdst<=_*_)return u;const a=x(k,c,b,v,A);return a.tdst<u.tdst?a:u}function R(d,c,b,v,A){const{e:_}=d;return _[0]*c+_[1]*b+_[2]*v+_[3]*A-d.eMq}function U(d,c,b,v,A,_){for(v-=4;b<v;){for(;C(d,b,A)<=_;)b+=4;for(;C(d,v,A)>_;)v-=4;if(b>=v)break;const w=c[b>>2];c[b>>2]=c[v>>2],c[v>>2]=w,b+=4,v-=4}for(;C(d,b,A)>_;)b-=4;return b+4}function C(d,c,b){return d[c]*b[0]+d[c+1]*b[1]+d[c+2]*b[2]+d[c+3]*b[3]}function P(d,c,b){const v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],_=b-c>>2;for(let w=c;w<b;w+=4){const k=d[w]*.00392156862745098,u=d[w+1]*(1/255),a=d[w+2]*(1/255),D=d[w+3]*(1/255);A[0]+=k,A[1]+=u,A[2]+=a,A[3]+=D,v[0]+=k*k,v[1]+=k*u,v[2]+=k*a,v[3]+=k*D,v[5]+=u*u,v[6]+=u*a,v[7]+=u*D,v[10]+=a*a,v[11]+=a*D,v[15]+=D*D}return v[4]=v[1],v[8]=v[2],v[9]=v[6],v[12]=v[3],v[13]=v[7],v[14]=v[11],{R:v,m:A,N:_}}function g(d){const{R:c}=d,{m:b}=d,{N:v}=d,A=b[0],_=b[1],w=b[2],k=b[3],u=v==0?0:1/v,a=[c[0]-A*A*u,c[1]-A*_*u,c[2]-A*w*u,c[3]-A*k*u,c[4]-_*A*u,c[5]-_*_*u,c[6]-_*w*u,c[7]-_*k*u,c[8]-w*A*u,c[9]-w*_*u,c[10]-w*w*u,c[11]-w*k*u,c[12]-k*A*u,c[13]-k*_*u,c[14]-k*w*u,c[15]-k*k*u],D=a,E=M;let L=[Math.random(),Math.random(),Math.random(),Math.random()],H=0,N=0;if(v!=0)for(let O=0;O<16&&(L=E.multVec(D,L),N=Math.sqrt(E.dot(L,L)),L=E.sml(1/N,L),!(O!=0&&Math.abs(N-H)<1e-9));O++)H=N;const W=[A*u,_*u,w*u,k*u];return{Cov:a,q:W,e:L,L:H,eMq255:E.dot(E.sml(255,W),L),eMq:E.dot(L,W),rgba:(Math.round(255*W[3])<<24|Math.round(255*W[2])<<16|Math.round(255*W[1])<<8|Math.round(255*W[0])<<0)>>>0}}var M={multVec:(d,c)=>[d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],d[4]*c[0]+d[5]*c[1]+d[6]*c[2]+d[7]*c[3],d[8]*c[0]+d[9]*c[1]+d[10]*c[2]+d[11]*c[3],d[12]*c[0]+d[13]*c[1]+d[14]*c[2]+d[15]*c[3]],dot:(d,c)=>d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],sml:(d,c)=>[d*c[0],d*c[1],d*c[2],d*c[3]]};ge.encode=function(c,b,v,A,_,w,k){A==null&&(A=0),k==null&&(k=!1);const u=r(c,b,v,A,[!1,!1,!1,0,k,!1]);return y(u,-1),p(u,b,v,_,w)},ge.encodeLL=function(c,b,v,A,_,w,k,u){const a={ctype:0+(A==1?0:2)+(_==0?0:4),depth:w,frames:[]},D=(A+_)*w,E=D*b;for(let L=0;L<c.length;L++)a.frames.push({rect:{x:0,y:0,width:b,height:v},img:new Uint8Array(c[L]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil(E/8)});return y(a,0,!0),p(a,b,v,k,u)},ge.encode.compress=r,ge.encode.dither=o,ge.quantize=m,ge.quantize.getKDtree=j,ge.quantize.getNearest=x})();const Je={toArrayBuffer(S,F){const z=S.width,f=S.height,e=z<<2,t=S.getContext("2d").getImageData(0,0,z,f),l=new Uint32Array(t.data.buffer),o=(32*z+31)/32<<2,p=o*f,y=122+p,r=new ArrayBuffer(y),i=new DataView(r),n=1<<20;let s,h,m,j,x=n,R=0,U=0,C=0;function P(d){i.setUint16(U,d,!0),U+=2}function g(d){i.setUint32(U,d,!0),U+=4}function M(d){U+=d}P(19778),g(y),M(4),g(122),g(108),g(z),g(-f>>>0),P(1),P(32),g(3),g(p),g(2835),g(2835),M(8),g(16711680),g(65280),g(255),g(4278190080),g(1466527264),(function d(){for(;R<f&&x>0;){for(j=122+R*o,s=0;s<e;)x--,h=l[C++],m=h>>>24,i.setUint32(j+s,h<<8|m),s+=4;R++}C<l.length?(x=n,setTimeout(d,Je._dly)):F(r)})()},toBlob(S,F){this.toArrayBuffer(S,(z=>{F(new Blob([z],{type:"image/bmp"}))}))},_dly:9};var ce={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gt={[ce.CHROME]:16384,[ce.FIREFOX]:11180,[ce.DESKTOP_SAFARI]:16384,[ce.IE]:8192,[ce.IOS]:4096,[ce.ETC]:8192};const $e=typeof window<"u",et=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,ze=$e&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),mt=($e||et)&&(ze&&ze.getOriginalSymbol(window,"File")||typeof File<"u"&&File),tt=($e||et)&&(ze&&ze.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function qe(S,F,z=Date.now()){return new Promise((f=>{const e=S.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let o=l.length;const p=new Uint8Array(o);for(;o--;)p[o]=l.charCodeAt(o);const y=new Blob([p],{type:t});y.name=F,y.lastModified=z,f(y)}))}function nt(S){return new Promise(((F,z)=>{const f=new tt;f.onload=()=>F(f.result),f.onerror=e=>z(e),f.readAsDataURL(S)}))}function rt(S){return new Promise(((F,z)=>{const f=new Image;f.onload=()=>F(f),f.onerror=e=>z(e),f.src=S}))}function Ee(){if(Ee.cachedResult!==void 0)return Ee.cachedResult;let S=ce.ETC;const{userAgent:F}=navigator;return/Chrom(e|ium)/i.test(F)?S=ce.CHROME:/iP(ad|od|hone)/i.test(F)&&/WebKit/i.test(F)?S=ce.IOS:/Safari/i.test(F)?S=ce.DESKTOP_SAFARI:/Firefox/i.test(F)?S=ce.FIREFOX:(/MSIE/i.test(F)||document.documentMode)&&(S=ce.IE),Ee.cachedResult=S,Ee.cachedResult}function it(S,F){const z=Ee(),f=gt[z];let e=S,t=F,l=e*t;const o=e>t?t/e:e/t;for(;l>f*f;){const p=(f+e)/2,y=(f+t)/2;p<y?(t=y,e=y*o):(t=p*o,e=p),l=e*t}return{width:e,height:t}}function Oe(S,F){let z,f;try{if(z=new OffscreenCanvas(S,F),f=z.getContext("2d"),f===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{z=document.createElement("canvas"),f=z.getContext("2d")}return z.width=S,z.height=F,[z,f]}function ot(S,F){const{width:z,height:f}=it(S.width,S.height),[e,t]=Oe(z,f);return F&&/jpe?g/.test(F)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(S,0,0,e.width,e.height),e}function Me(){return Me.cachedResult!==void 0||(Me.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Me.cachedResult}function De(S,F={}){return new Promise((function(z,f){let e,t;var l=function(){try{return t=ot(e,F.fileType||S.type),z([e,t])}catch(p){return f(p)}},o=function(p){try{var y=function(r){try{throw r}catch(i){return f(i)}};try{let r;return nt(S).then((function(i){try{return r=i,rt(r).then((function(n){try{return e=n,(function(){try{return l()}catch(s){return f(s)}})()}catch(s){return y(s)}}),y)}catch(n){return y(n)}}),y)}catch(r){y(r)}}catch(r){return f(r)}};try{if(Me()||[ce.DESKTOP_SAFARI,ce.MOBILE_SAFARI].includes(Ee()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(S).then((function(p){try{return e=p,l()}catch{return o()}}),o)}catch{o()}}))}function Le(S,F,z,f,e=1){return new Promise((function(t,l){let o;if(F==="image/png"){let y,r,i;return y=S.getContext("2d"),{data:r}=y.getImageData(0,0,S.width,S.height),i=ge.encode([r.buffer],S.width,S.height,4096*e),o=new Blob([i],{type:F}),o.name=z,o.lastModified=f,p.call(this)}{let y=function(){return p.call(this)};if(F==="image/bmp")return new Promise((r=>Je.toBlob(S,r))).then(function(r){try{return o=r,o.name=z,o.lastModified=f,y.call(this)}catch(i){return l(i)}}.bind(this),l);{let r=function(){return y.call(this)};if(typeof OffscreenCanvas=="function"&&S instanceof OffscreenCanvas)return S.convertToBlob({type:F,quality:e}).then(function(i){try{return o=i,o.name=z,o.lastModified=f,r.call(this)}catch(n){return l(n)}}.bind(this),l);{let i;return i=S.toDataURL(F,e),qe(i,z,f).then(function(n){try{return o=n,r.call(this)}catch(s){return l(s)}}.bind(this),l)}}}function p(){return t(o)}}))}function be(S){S.width=0,S.height=0}function Ie(){return new Promise((function(S,F){let z,f,e,t;return Ie.cachedResult!==void 0?S(Ie.cachedResult):qe("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(l){try{return z=l,De(z).then((function(o){try{return f=o[1],Le(f,z.type,z.name,z.lastModified).then((function(p){try{return e=p,be(f),De(e).then((function(y){try{return t=y[0],Ie.cachedResult=t.width===1&&t.height===2,S(Ie.cachedResult)}catch(r){return F(r)}}),F)}catch(y){return F(y)}}),F)}catch(p){return F(p)}}),F)}catch(o){return F(o)}}),F)}))}function st(S){return new Promise(((F,z)=>{const f=new tt;f.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return F(-2);const l=t.byteLength;let o=2;for(;o<l;){if(t.getUint16(o+2,!1)<=8)return F(-1);const p=t.getUint16(o,!1);if(o+=2,p==65505){if(t.getUint32(o+=2,!1)!=1165519206)return F(-1);const y=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,y);const r=t.getUint16(o,y);o+=2;for(let i=0;i<r;i++)if(t.getUint16(o+12*i,y)==274)return F(t.getUint16(o+12*i+8,y))}else{if((65280&p)!=65280)break;o+=t.getUint16(o,!1)}}return F(-1)},f.onerror=e=>z(e),f.readAsArrayBuffer(S)}))}function at(S,F){const{width:z}=S,{height:f}=S,{maxWidthOrHeight:e}=F;let t,l=S;return isFinite(e)&&(z>e||f>e)&&([l,t]=Oe(z,f),z>f?(l.width=e,l.height=f/z*e):(l.width=z/f*e,l.height=e),t.drawImage(S,0,0,l.width,l.height),be(S)),l}function lt(S,F){const{width:z}=S,{height:f}=S,[e,t]=Oe(z,f);switch(F>4&&F<9?(e.width=f,e.height=z):(e.width=z,e.height=f),F){case 2:t.transform(-1,0,0,1,z,0);break;case 3:t.transform(-1,0,0,-1,z,f);break;case 4:t.transform(1,0,0,-1,0,f);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,f,0);break;case 7:t.transform(0,-1,-1,0,f,z);break;case 8:t.transform(0,-1,1,0,0,z)}return t.drawImage(S,0,0,z,f),be(S),e}function Ze(S,F,z=0){return new Promise((function(f,e){let t,l,o,p,y,r,i,n,s,h,m,j,x,R,U,C,P,g,M,d;function c(v=5){if(F.signal&&F.signal.aborted)throw F.signal.reason;t+=v,F.onProgress(Math.min(t,100))}function b(v){if(F.signal&&F.signal.aborted)throw F.signal.reason;t=Math.min(Math.max(v,t),100),F.onProgress(t)}return t=z,l=F.maxIteration||10,o=1024*F.maxSizeMB*1024,c(),De(S,F).then(function(v){try{return[,p]=v,c(),y=at(p,F),c(),new Promise((function(A,_){var w;if(!(w=F.exifOrientation))return st(S).then(function(u){try{return w=u,k.call(this)}catch(a){return _(a)}}.bind(this),_);function k(){return A(w)}return k.call(this)})).then(function(A){try{return r=A,c(),Ie().then(function(_){try{return i=_?y:lt(y,r),c(),n=F.initialQuality||1,s=F.fileType||S.type,Le(i,s,S.name,S.lastModified,n).then(function(w){try{{let u=function(){if(l--&&(U>o||U>x)){let D,E;return D=d?.95*M.width:M.width,E=d?.95*M.height:M.height,[P,g]=Oe(D,E),g.drawImage(M,0,0,D,E),n*=s==="image/png"?.85:.95,Le(P,s,S.name,S.lastModified,n).then((function(L){try{return C=L,be(M),M=P,U=C.size,b(Math.min(99,Math.floor((R-U)/(R-o)*100))),u}catch(H){return e(H)}}),e)}return[1]},a=function(){return be(M),be(P),be(y),be(i),be(p),b(100),f(C)};if(h=w,c(),m=h.size>o,j=h.size>S.size,!m&&!j)return b(100),f(h);var k;return x=S.size,R=h.size,U=R,M=i,d=!F.alwaysKeepResolution&&m,(k=function(D){for(;D;){if(D.then)return void D.then(k,e);try{if(D.pop){if(D.length)return D.pop()?a.call(this):D;D=u}else D=D.call(this)}catch(E){return e(E)}}}.bind(this))(u)}}catch(u){return e(u)}}.bind(this),e)}catch(w){return e(w)}}.bind(this),e)}catch(_){return e(_)}}.bind(this),e)}catch(A){return e(A)}}.bind(this),e)}))}const xt=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let He;function bt(S,F){return new Promise(((z,f)=>{He||(He=(function(l){const o=[];return o.push(l),URL.createObjectURL(new Blob(o))})(xt));const e=new Worker(He);e.addEventListener("message",(function(l){if(F.signal&&F.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return f(new Error(l.data.error)),void e.terminate();z(l.data.file),e.terminate()}else F.onProgress(l.data.progress)})),e.addEventListener("error",f),F.signal&&F.signal.addEventListener("abort",(()=>{f(F.signal.reason),e.terminate()})),e.postMessage({file:S,imageCompressionLibUrl:F.libURL,options:{...F,onProgress:void 0,signal:void 0}})}))}function ae(S,F){return new Promise((function(z,f){let e,t,l,o,p,y;if(e={...F},l=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,p=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=s=>{l=s,typeof o=="function"&&o(l)},!(S instanceof Blob||S instanceof mt))return f(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(S.type))return f(new Error("The file given is not an image"));if(y=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!p||typeof Worker!="function"||y)return Ze(S,e).then(function(s){try{return t=s,n.call(this)}catch(h){return f(h)}}.bind(this),f);var r=function(){try{return n.call(this)}catch(s){return f(s)}}.bind(this),i=function(s){try{return Ze(S,e).then((function(h){try{return t=h,r()}catch(m){return f(m)}}),f)}catch(h){return f(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",bt(S,e).then((function(s){try{return t=s,r()}catch{return i()}}),i)}catch{i()}function n(){try{t.name=S.name,t.lastModified=S.lastModified}catch{}try{e.preserveExif&&S.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===S.type)&&(t=Ye(S,t))}catch{}return z(t)}}))}ae.getDataUrlFromFile=nt,ae.getFilefromDataUrl=qe,ae.loadImage=rt,ae.drawImageInCanvas=ot,ae.drawFileInCanvas=De,ae.canvasToFile=Le,ae.getExifOrientation=st,ae.handleMaxWidthOrHeight=at,ae.followExifOrientation=lt,ae.cleanupCanvasMemory=be,ae.isAutoOrientationInBrowser=Ie,ae.approximateBelowMaximumCanvasSizeOfBrowser=it,ae.copyExifWithoutOrientation=Ye,ae.getBrowserName=Ee,ae.version="2.0.2";function yt({userId:S,userAvatar:F}){const[z,f]=$.useState(""),[e,t]=$.useState(!1),[l,o]=$.useState(!1),[p,y]=$.useState(""),[r,i]=$.useState([]),[n,s]=$.useState([]),h=async R=>{const U=Array.from(R.target.files||[]);if(U.length===0)return;if(U.length+r.length>4){y("Maximum 4 images per post");return}i([...r,...U]);const C=U.map(P=>URL.createObjectURL(P));s([...n,...C])},m=R=>{const U=r.filter((P,g)=>g!==R),C=n.filter((P,g)=>g!==R);URL.revokeObjectURL(n[R]),i(U),s(C)},j=async R=>{try{const C=await ae(R,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),P=R.name.split(".").pop(),g=`${S}/${Date.now()}-${Math.random().toString(36).substring(7)}.${P}`,{data:M,error:d}=await Q.storage.from("media").upload(g,C);if(d)throw d;const{data:{publicUrl:c}}=Q.storage.from("media").getPublicUrl(M.path);return c}catch(U){throw console.error("Upload error:",U),new Error("Failed to upload image")}},x=async R=>{if(R.preventDefault(),!z.trim()&&r.length===0){y("Please write something or add an image");return}o(!0),y("");try{let U=[];r.length>0&&(t(!0),U=await Promise.all(r.map(j)),t(!1));const{error:C}=await Q.from("posts").insert({user_id:S,content:z.trim(),media_urls:U.length>0?U:null});if(C)throw C;f(""),i([]),n.forEach(P=>URL.revokeObjectURL(P)),s([]),window.location.reload()}catch(U){y(U.message||"Failed to create post"),t(!1),o(!1)}};return I.jsxs("form",{onSubmit:x,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[I.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"start"},children:[F?I.jsx("img",{src:F,alt:"You",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):I.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:"?"}),I.jsx("textarea",{value:z,onChange:R=>f(R.target.value),placeholder:"What's on your mind?",rows:3,style:{flex:1,resize:"vertical",minHeight:"80px",fontSize:"16px"},disabled:l})]}),p&&I.jsx("div",{style:{background:"#fee",color:"#c33",padding:"10px",borderRadius:"6px",fontSize:"14px"},children:p}),n.length>0&&I.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:n.map((R,U)=>I.jsxs("div",{style:{position:"relative"},children:[I.jsx("img",{src:R,alt:`Preview ${U+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px"}}),I.jsx("button",{type:"button",onClick:()=>m(U),style:{position:"absolute",top:"5px",right:"5px",background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"16px",lineHeight:"1"},children:""})]},U))}),I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[I.jsxs("label",{style:{cursor:"pointer"},children:[I.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h,style:{display:"none"},disabled:l||r.length>=4}),I.jsxs("span",{style:{color:"#4A90E2",fontWeight:"500",fontSize:"14px"},children:[" Add Photos ",r.length>0&&`(${r.length}/4)`]})]}),I.jsx("button",{type:"submit",className:"btn",disabled:l||e,style:{opacity:l||e?.5:1},children:e?"Uploading...":l?"Posting...":"Post"})]})]})}const Be={like:"",love:"",laugh:"",celebrate:""};function vt({postId:S,currentUserId:F}){const[z,f]=$.useState([]),[e,t]=$.useState(null),[l,o]=$.useState(!1),[p,y]=$.useState(!1);$.useEffect(()=>{r(),i()},[S]);async function r(){const{data:j}=await Q.from("post_reactions").select(`
        *,
        profile:profiles(display_name)
      `).eq("post_id",S);if(j){f(j);const x=j.find(R=>R.user_id===F);t(x?.reaction_type||null)}}function i(){const j=Q.channel(`reactions-${S}`).on("postgres_changes",{event:"*",schema:"public",table:"post_reactions",filter:`post_id=eq.${S}`},()=>{r()}).subscribe();return()=>{Q.removeChannel(j)}}async function n(j){if(!p){y(!0);try{e===j?(await Q.from("post_reactions").delete().eq("post_id",S).eq("user_id",F),t(null)):e?(await Q.from("post_reactions").update({reaction_type:j}).eq("post_id",S).eq("user_id",F),t(j)):(await Q.from("post_reactions").insert({post_id:S,user_id:F,reaction_type:j}),t(j)),o(!1)}catch(x){console.error("Reaction error:",x)}finally{y(!1)}}}const s={};z.forEach(j=>{s[j.reaction_type]=(s[j.reaction_type]||0)+1});const h=z.length,m=z.slice(0,3).map(j=>j.profile?.display_name).filter(Boolean);return I.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[h>0&&I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",fontSize:"14px",color:"#666"},children:[I.jsx("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:Object.entries(s).map(([j,x])=>I.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[Be[j]," ",x]},j))}),m.length>0&&I.jsxs("div",{style:{fontSize:"13px"},children:[m.join(", "),z.length>3&&` +${z.length-3} more`]})]}),I.jsxs("div",{style:{display:"flex",gap:"10px",position:"relative"},children:[I.jsxs("button",{onClick:()=>e?n(e):o(!l),style:{background:e?"#e3f2fd":"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:e?"#4A90E2":"#666",fontWeight:e?600:400},children:[e?Be[e]:"",e?"Liked":"Like"]}),!e&&I.jsx("button",{onClick:()=>o(!l),style:{background:"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 10px",fontSize:"16px",cursor:"pointer"},title:"React",children:"+"}),l&&I.jsx("div",{style:{position:"absolute",bottom:"100%",left:0,marginBottom:"8px",background:"white",border:"1px solid #ddd",borderRadius:"24px",padding:"8px 12px",display:"flex",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10},children:Object.entries(Be).map(([j,x])=>I.jsx("button",{onClick:()=>n(j),style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",padding:"4px",borderRadius:"50%",transition:"transform 0.2s"},onMouseEnter:R=>R.currentTarget.style.transform="scale(1.3)",onMouseLeave:R=>R.currentTarget.style.transform="scale(1)",title:j,children:x},j))})]})]})}function wt({postId:S,currentUserId:F}){const[z,f]=$.useState([]),[e,t]=$.useState(""),[l,o]=$.useState(!1),[p,y]=$.useState(!1);$.useEffect(()=>{r(),i()},[S]);async function r(){const{data:m}=await Q.from("comments").select(`
        *,
        profile:profiles(display_name, avatar_url)
      `).eq("post_id",S).order("created_at",{ascending:!0});m&&f(m)}function i(){const m=Q.channel(`comments-${S}`).on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:`post_id=eq.${S}`},()=>{r()}).subscribe();return()=>{Q.removeChannel(m)}}async function n(m){if(m.preventDefault(),!(!e.trim()||l)){o(!0);try{await Q.from("comments").insert({post_id:S,user_id:F,content:e.trim()}),t(""),y(!0)}catch(j){console.error("Comment error:",j)}finally{o(!1)}}}async function s(m){if(confirm("Delete this comment?"))try{await Q.from("comments").delete().eq("id",m)}catch(j){console.error("Delete error:",j)}}const h=m=>{const j=new Date(m),R=new Date().getTime()-j.getTime(),U=Math.floor(R/(1e3*60*60)),C=Math.floor(U/24);if(C>0)return`${C}d ago`;if(U>0)return`${U}h ago`;const P=Math.floor(R/(1e3*60));return P>0?`${P}m ago`:"Just now"};return I.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[I.jsxs("button",{onClick:()=>y(!p),style:{background:"transparent",border:"none",color:"#666",fontSize:"14px",cursor:"pointer",padding:"4px 0",fontWeight:500,display:"flex",alignItems:"center",gap:"6px"},children:[" ",z.length," ",z.length===1?"Comment":"Comments",I.jsx("span",{style:{fontSize:"12px"},children:p?"":""})]}),p&&I.jsxs("div",{style:{marginTop:"12px"},children:[z.map(m=>I.jsx("div",{style:{padding:"10px",background:"#f8f9fa",borderRadius:"8px",marginBottom:"8px"},children:I.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"start"},children:[m.profile?.avatar_url?I.jsx("img",{src:m.profile.avatar_url,alt:m.profile.display_name,style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):I.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:m.profile?.display_name?.[0]?.toUpperCase()||"?"}),I.jsxs("div",{style:{flex:1,minWidth:0},children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",gap:"8px"},children:[I.jsxs("div",{children:[I.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:m.profile?.display_name||"Unknown"}),I.jsx("div",{style:{fontSize:"13px",color:"#999"},children:h(m.created_at)})]}),m.user_id===F&&I.jsx("button",{onClick:()=>s(m.id),style:{background:"transparent",border:"none",color:"#999",fontSize:"12px",cursor:"pointer",padding:"2px 6px"},children:"Delete"})]}),I.jsx("div",{style:{fontSize:"14px",marginTop:"6px",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:m.content})]})]})},m.id)),I.jsxs("form",{onSubmit:n,style:{marginTop:"12px"},children:[I.jsx("textarea",{value:e,onChange:m=>t(m.target.value),placeholder:"Write a comment...",rows:2,style:{width:"100%",resize:"vertical",marginBottom:"8px",fontSize:"14px"},disabled:l}),I.jsx("button",{type:"submit",className:"btn",style:{fontSize:"13px",padding:"6px 12px"},disabled:l||!e.trim(),children:l?"Posting...":"Post Comment"})]})]})]})}function At({profileId:S}){const[F,z]=$.useState(null),[f,e]=$.useState(null),[t,l]=$.useState([]),[o,p]=$.useState(!0),[y,r]=$.useState(!1),[i,n]=$.useState(null),[s,h]=$.useState([]),[m,j]=$.useState(0);$.useEffect(()=>{x()},[S]);async function x(){try{const U=await Xe();z(U);const{data:C}=await Q.from("profiles").select("*").eq("id",S).single();e(C);const{data:P}=await Q.from("posts").select(`
          *,
          profile:profiles(*)
        `).eq("user_id",S).order("created_at",{ascending:!1});l(P||[]),p(!1)}catch(U){console.error("Error loading profile:",U),p(!1)}}if(o)return I.jsx("div",{style:{textAlign:"center",padding:"40px"},children:"Loading..."});if(!f)return I.jsx("div",{className:"error",children:"Profile not found"});const R=F?.id===S;return I.jsxs("div",{children:[I.jsx("div",{className:"card",style:{marginBottom:"30px"},children:I.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"start",flexWrap:"wrap"},children:[f.avatar_url?I.jsx("img",{src:f.avatar_url,alt:f.display_name,style:{width:"100px",height:"100px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):I.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"40px",fontWeight:"bold",flexShrink:0},children:f.display_name[0].toUpperCase()}),I.jsxs("div",{style:{flex:1,minWidth:0},children:[I.jsx("h1",{style:{marginBottom:"10px"},children:f.display_name}),f.bio&&I.jsx("p",{style:{color:"#666",lineHeight:1.6,marginBottom:"10px"},children:f.bio}),I.jsxs("p",{style:{color:"#999",fontSize:"14px"},children:["Member since ",new Date(f.created_at).toLocaleDateString()]}),R&&!y&&I.jsx("button",{onClick:()=>r(!0),className:"btn",style:{marginTop:"15px"},children:" Edit Profile"})]})]})}),y&&R&&I.jsx(jt,{profile:f,onSave:()=>{r(!1),x()},onCancel:()=>r(!1)}),I.jsxs("h2",{style:{marginBottom:"20px"},children:[R?"Your Posts":`${f.display_name}'s Posts`," (",t.length,")"]}),t.length===0?I.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:I.jsx("p",{style:{color:"#999"},children:"No posts yet"})}):t.map(U=>I.jsx(St,{post:U,currentUserId:F?.id||"",onImageClick:(C,P)=>{n(C),h(P||[C]),j(P?.indexOf(C)||0)}},U.id)),i&&I.jsxs("div",{onClick:()=>{n(null),h([]),j(0)},style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,cursor:"pointer",padding:"20px"},children:[s.length>1&&m>0&&I.jsx("button",{onClick:U=>{U.stopPropagation();const C=m-1;j(C),n(s[C])},style:{position:"absolute",left:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),I.jsx("img",{src:i,alt:"Full size",onClick:U=>U.stopPropagation(),style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"}}),s.length>1&&m<s.length-1&&I.jsx("button",{onClick:U=>{U.stopPropagation();const C=m+1;j(C),n(s[C])},style:{position:"absolute",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),I.jsx("button",{onClick:()=>{n(null),h([]),j(0)},style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"40px",height:"40px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),s.length>1&&I.jsxs("div",{style:{position:"absolute",bottom:"30px",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"14px",fontWeight:500,zIndex:1001},children:[m+1," / ",s.length]})]})]})}function jt({profile:S,onSave:F,onCancel:z}){const[f,e]=$.useState(S.display_name),[t,l]=$.useState(S.bio||""),[o,p]=$.useState(!1),[y,r]=$.useState(!1),[i,n]=$.useState("");async function s(m){const j=m.target.files?.[0];if(j){if(j.size>5*1024*1024){n("Avatar must be less than 5MB");return}p(!0),n("");try{const x=j.name.split(".").pop(),R=`${S.id}/avatar-${Date.now()}.${x}`,{error:U}=await Q.storage.from("media").upload(R,j,{upsert:!0});if(U)throw U;const{data:{publicUrl:C}}=Q.storage.from("media").getPublicUrl(R),{error:P}=await Q.from("profiles").update({avatar_url:C}).eq("id",S.id);if(P)throw P;p(!1),F()}catch(x){n(x.message),p(!1)}}}async function h(){r(!0),n("");try{const{error:m}=await Q.from("profiles").update({display_name:f,bio:t||null}).eq("id",S.id);if(m)throw m;r(!1),F()}catch(m){n(m.message),r(!1)}}return I.jsxs("div",{className:"card",style:{marginBottom:"30px"},children:[I.jsx("h2",{style:{marginBottom:"20px"},children:"Edit Profile"}),i&&I.jsx("div",{className:"error",children:i}),I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[I.jsxs("div",{children:[I.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Profile Picture"}),I.jsx("input",{type:"file",accept:"image/*",onChange:s,disabled:o}),o&&I.jsx("p",{style:{fontSize:"14px",color:"#4A90E2",marginTop:"5px"},children:"Uploading..."})]}),I.jsxs("div",{children:[I.jsx("label",{htmlFor:"display_name",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Display Name"}),I.jsx("input",{type:"text",id:"display_name",value:f,onChange:m=>e(m.target.value),disabled:y})]}),I.jsxs("div",{children:[I.jsx("label",{htmlFor:"bio",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Bio"}),I.jsx("textarea",{id:"bio",value:t,onChange:m=>l(m.target.value),rows:3,placeholder:"Tell your family about yourself...",disabled:y})]}),I.jsxs("div",{style:{display:"flex",gap:"10px"},children:[I.jsx("button",{onClick:h,className:"btn",disabled:y||!f,children:y?"Saving...":"Save Changes"}),I.jsx("button",{onClick:z,className:"btn btn-secondary",disabled:y,children:"Cancel"})]})]})]})}function St({post:S,currentUserId:F,onImageClick:z}){const f=e=>{const t=new Date(e),o=new Date().getTime()-t.getTime(),p=Math.floor(o/(1e3*60*60)),y=Math.floor(p/24);return y>0?`${y}d ago`:p>0?`${p}h ago`:"Just now"};return I.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[I.jsx("div",{style:{marginBottom:"15px"},children:I.jsx("div",{style:{fontSize:"13px",color:"#999"},children:f(S.created_at)})}),I.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:S.content}),S.media_urls&&S.media_urls.length>0&&I.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:S.media_urls.map((e,t)=>I.jsx("img",{src:e,alt:"Post media",onClick:()=>z?.(e,S.media_urls),style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px",cursor:"pointer"}},t))})]})}function Et(){const[S,F]=$.useState(null),[z,f]=$.useState(null),[e,t]=$.useState([]),[l,o]=$.useState(!0),[p,y]=$.useState(""),[r,i]=$.useState(0),[n,s]=$.useState([]),[h,m]=$.useState(null),[j,x]=$.useState(null),[R,U]=$.useState([]),[C,P]=$.useState(0);$.useEffect(()=>{g()},[]),$.useEffect(()=>{const b=Q.channel("posts-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},async v=>{const{data:A}=await Q.from("posts").select(`
              *,
              profile:profiles(*)
            `).eq("id",v.new.id).single();A&&(s(_=>[A,..._]),i(_=>_+1))}).subscribe();return()=>{Q.removeChannel(b)}},[]);async function g(){try{const b=await Xe();if(F(b),!b){window.location.href="/login.html";return}if(!Ke){const{data:v}=await Q.from("profiles").select("*").eq("id",b.id).single();f(v);const{data:A,error:_}=await Q.from("posts").select(`
            *,
            profile:profiles(*)
          `).order("created_at",{ascending:!1}).limit(50);if(_)throw _;t(A||[])}o(!1)}catch(b){y(b.message),o(!1)}}const M=async()=>{await Q.auth.signOut(),window.location.href="/login.html"},d=()=>{t([...n,...e]),s([]),i(0)},c=async()=>{o(!0),await g(),s([]),i(0)};return l?I.jsx("div",{style:{textAlign:"center",padding:"40px"},children:I.jsx("p",{children:"Loading..."})}):p?I.jsxs("div",{className:"error",children:[I.jsx("strong",{children:"Error:"})," ",p]}):h?I.jsxs(I.Fragment,{children:[I.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[I.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:" Back to Feed"}),I.jsx("a",{href:"/admin.html",children:"Admin"}),I.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Sign Out"})]}),I.jsx(At,{profileId:h})]}):I.jsxs(I.Fragment,{children:[I.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[I.jsx("button",{onClick:()=>m(S?.id||""),className:"btn btn-secondary",children:"My Profile"}),I.jsx("a",{href:"/admin.html",children:"Admin"}),I.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Sign Out"})]}),I.jsxs("div",{style:{marginBottom:"30px"},children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[I.jsx("h1",{style:{margin:0},children:"Family Feed"}),I.jsx("button",{onClick:c,className:"btn btn-secondary",style:{fontSize:"14px",padding:"6px 12px"},children:" Refresh"})]}),r>0&&I.jsxs("div",{onClick:d,style:{background:"#4A90E2",color:"white",padding:"12px",borderRadius:"8px",marginBottom:"15px",textAlign:"center",cursor:"pointer",fontWeight:500},children:[" ",r," new ",r===1?"post":"posts"," - Tap to view"]}),Ke,I.jsx("div",{className:"card",children:I.jsx(yt,{userId:S?.id||Ve,userAvatar:z?.avatar_url})})]}),I.jsxs("div",{children:[e.length===0&&I.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:I.jsx("p",{style:{color:"#999"},children:"No posts yet. Be the first to share something!"})}),e.map(b=>I.jsx(Ct,{post:b,currentUserId:S?.id||Ve,onProfileClick:v=>m(v),onImageClick:(v,A)=>{x(v),U(A||[v]),P(A?.indexOf(v)||0)}},b.id))]}),j&&I.jsxs("div",{onClick:()=>{x(null),U([]),P(0)},style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,cursor:"pointer",padding:"20px"},children:[R.length>1&&C>0&&I.jsx("button",{onClick:b=>{b.stopPropagation();const v=C-1;P(v),x(R[v])},style:{position:"absolute",left:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),I.jsx("img",{src:j,alt:"Full size",onClick:b=>b.stopPropagation(),style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"}}),R.length>1&&C<R.length-1&&I.jsx("button",{onClick:b=>{b.stopPropagation();const v=C+1;P(v),x(R[v])},style:{position:"absolute",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),I.jsx("button",{onClick:()=>{x(null),U([]),P(0)},style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"40px",height:"40px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",zIndex:1001},children:""}),R.length>1&&I.jsxs("div",{style:{position:"absolute",bottom:"30px",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"14px",fontWeight:500,zIndex:1001},children:[C+1," / ",R.length]})]})]})}function Ct({post:S,currentUserId:F,onProfileClick:z,onImageClick:f}){const e=o=>{const p=new Date(o),r=new Date().getTime()-p.getTime(),i=Math.floor(r/(1e3*60*60)),n=Math.floor(i/24);return n>0?`${n}d ago`:i>0?`${i}h ago`:"Just now"},t=async()=>{if(confirm("Delete this post?"))try{if(S.media_urls&&S.media_urls.length>0)for(const o of S.media_urls){const p=o.split("/media/")[1];p&&await Q.storage.from("media").remove([p])}await Q.from("posts").delete().eq("id",S.id),window.location.reload()}catch{alert("Failed to delete post")}},l=S.user_id===F;return I.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"15px",gap:"10px"},children:[I.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flex:1,minWidth:0,cursor:"pointer"},onClick:()=>z?.(S.user_id),children:[S.profile?.avatar_url?I.jsx("img",{src:S.profile.avatar_url,alt:S.profile.display_name,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):I.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:S.profile?.display_name?.[0]?.toUpperCase()||"?"}),I.jsxs("div",{style:{minWidth:0,flex:1},children:[I.jsx("div",{style:{fontWeight:600,color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:S.profile?.display_name||"Unknown"}),I.jsx("div",{style:{fontSize:"13px",color:"#999"},children:e(S.created_at)})]})]}),l&&I.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"28px",color:"#999",cursor:"pointer",lineHeight:1,padding:0,width:"28px",height:"28px",flexShrink:0},title:"Delete post",children:""})]}),I.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:S.content}),S.media_urls&&S.media_urls.length>0&&I.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:S.media_urls.map((o,p)=>I.jsx("img",{src:o,alt:"Post media",onClick:()=>f?.(o,S.media_urls),style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px",cursor:"pointer"}},p))}),I.jsx(vt,{postId:S.id,currentUserId:F}),I.jsx(wt,{postId:S.id,currentUserId:F})]})}export{Et as default};
