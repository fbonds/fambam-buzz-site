import{j as R,a as Q,g as Ye}from"./client-auth.DKJLJEpy.js";import{r as $}from"./index.D55ewHcJ.js";const Ke=!1,Ve="fletcher-dev-id";function dt(_,k){return k.forEach((function(D){D&&typeof D!="string"&&!Array.isArray(D)&&Object.keys(D).forEach((function(f){if(f!=="default"&&!(f in _)){var e=Object.getOwnPropertyDescriptor(D,f);Object.defineProperty(_,f,e.get?e:{enumerable:!0,get:function(){return D[f]}})}}))})),Object.freeze(_)}function Xe(_,k){return new Promise((function(D,f){let e;return ut(_).then((function(t){try{return e=t,D(new Blob([k.slice(0,2),e,k.slice(2)],{type:"image/jpeg"}))}catch(l){return f(l)}}),f)}))}const ut=_=>new Promise(((k,D)=>{const f=new FileReader;f.addEventListener("load",(({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return D("not a valid JPEG");for(l+=2;;){const o=t.getUint16(l);if(o===65498)break;const p=t.getUint16(l+2);if(o===65505&&t.getUint32(l+4)===1165519206){const b=l+10;let r;switch(t.getUint16(b)){case 18761:r=!0;break;case 19789:r=!1;break;default:return D("TIFF header contains invalid endian")}if(t.getUint16(b+2,r)!==42)return D("TIFF header contains invalid version");const i=t.getUint32(b+4,r),n=b+i+2+12*t.getUint16(b+i,r);for(let s=b+i+2;s<n;s+=12)if(t.getUint16(s,r)==274){if(t.getUint16(s+2,r)!==3)return D("Orientation data type is invalid");if(t.getUint32(s+4,r)!==1)return D("Orientation data count is invalid");t.setUint16(s+8,1,r);break}return k(e.slice(l,l+2+p))}l+=2+p}return k(new Blob)})),f.readAsArrayBuffer(_)}));var Te={},ht={get exports(){return Te},set exports(_){Te=_}};(function(_){var k,D,f={};ht.exports=f,f.parse=function(e,t){for(var l=f.bin.readUshort,o=f.bin.readUint,p=0,b={},r=new Uint8Array(e),i=r.length-4;o(r,i)!=101010256;)i--;p=i,p+=4;var n=l(r,p+=4);l(r,p+=2);var s=o(r,p+=2),h=o(r,p+=4);p+=4,p=h;for(var m=0;m<n;m++){o(r,p),p+=4,p+=4,p+=4,o(r,p+=4),s=o(r,p+=4);var w=o(r,p+=4),x=l(r,p+=4),I=l(r,p+2),F=l(r,p+4);p+=6;var S=o(r,p+=8);p+=4,p+=x+I+F,f._readLocal(r,S,b,s,w,t)}return b},f._readLocal=function(e,t,l,o,p,b){var r=f.bin.readUshort,i=f.bin.readUint;i(e,t),r(e,t+=4),r(e,t+=2);var n=r(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var s=r(e,t+=8),h=r(e,t+=2);t+=2;var m=f.bin.readUTF8(e,t,s);if(t+=s,t+=h,b)l[m]={size:p,csize:o};else{var w=new Uint8Array(e.buffer,t);if(n==0)l[m]=new Uint8Array(w.buffer.slice(t,t+o));else{if(n!=8)throw"unknown compression method: "+n;var x=new Uint8Array(p);f.inflateRaw(w,x),l[m]=x}}},f.inflateRaw=function(e,t){return f.F.inflate(e,t)},f.inflate=function(e,t){return e[0],e[1],f.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},f.deflate=function(e,t){t==null&&(t={level:6});var l=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[l]=120,o[l+1]=156,l+=2,l=f.F.deflateRaw(e,o,l,t.level);var p=f.adler(e,0,e.length);return o[l+0]=p>>>24&255,o[l+1]=p>>>16&255,o[l+2]=p>>>8&255,o[l+3]=p>>>0&255,new Uint8Array(o.buffer,0,l+4)},f.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),o=f.F.deflateRaw(e,l,o,t.level);return new Uint8Array(l.buffer,0,o)},f.encode=function(e,t){t==null&&(t=!1);var l=0,o=f.bin.writeUint,p=f.bin.writeUshort,b={};for(var r in e){var i=!f._noNeed(r)&&!t,n=e[r],s=f.crc.crc(n,0,n.length);b[r]={cpr:i,usize:n.length,crc:s,file:i?f.deflateRaw(n):n}}for(var r in b)l+=b[r].file.length+30+46+2*f.bin.sizeUTF8(r);l+=22;var h=new Uint8Array(l),m=0,w=[];for(var r in b){var x=b[r];w.push(m),m=f._writeHeader(h,m,r,x,0)}var I=0,F=m;for(var r in b)x=b[r],w.push(m),m=f._writeHeader(h,m,r,x,1,w[I++]);var S=m-F;return o(h,m,101010256),m+=4,p(h,m+=4,I),p(h,m+=2,I),o(h,m+=2,S),o(h,m+=4,F),m+=4,m+=2,h.buffer},f._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},f._writeHeader=function(e,t,l,o,p,b){var r=f.bin.writeUint,i=f.bin.writeUshort,n=o.file;return r(e,t,p==0?67324752:33639248),t+=4,p==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,o.cpr?8:0),r(e,t+=2,0),r(e,t+=4,o.crc),r(e,t+=4,n.length),r(e,t+=4,o.usize),i(e,t+=4,f.bin.sizeUTF8(l)),i(e,t+=2,0),t+=2,p==1&&(t+=2,t+=2,r(e,t+=6,b),t+=4),t+=f.bin.writeUTF8(e,t,l),p==0&&(e.set(n,t),t+=n.length),t},f.crc={table:(function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,o=0;o<8;o++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e})(),update:function(e,t,l,o){for(var p=0;p<o;p++)e=f.crc.table[255&(e^t[l+p])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^f.crc.update(4294967295,e,t,l)}},f.adler=function(e,t,l){for(var o=1,p=0,b=t,r=t+l;b<r;){for(var i=Math.min(b+5552,r);b<i;)p+=o+=e[b++];o%=65521,p%=65521}return p<<16|o},f.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var o="",p=0;p<l;p++)o+=String.fromCharCode(e[t+p]);return o},writeASCII:function(e,t,l){for(var o=0;o<l.length;o++)e[t+o]=l.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var o,p="",b=0;b<l;b++)p+="%"+f.bin.pad(e[t+b].toString(16));try{o=decodeURIComponent(p)}catch{return f.bin.readASCII(e,t,l)}return o},writeUTF8:function(e,t,l){for(var o=l.length,p=0,b=0;b<o;b++){var r=l.charCodeAt(b);if((4294967168&r)==0)e[t+p]=r,p++;else if((4294965248&r)==0)e[t+p]=192|r>>6,e[t+p+1]=128|r>>0&63,p+=2;else if((4294901760&r)==0)e[t+p]=224|r>>12,e[t+p+1]=128|r>>6&63,e[t+p+2]=128|r>>0&63,p+=3;else{if((4292870144&r)!=0)throw"e";e[t+p]=240|r>>18,e[t+p+1]=128|r>>12&63,e[t+p+2]=128|r>>6&63,e[t+p+3]=128|r>>0&63,p+=4}}return p},sizeUTF8:function(e){for(var t=e.length,l=0,o=0;o<t;o++){var p=e.charCodeAt(o);if((4294967168&p)==0)l++;else if((4294965248&p)==0)l+=2;else if((4294901760&p)==0)l+=3;else{if((4292870144&p)!=0)throw"e";l+=4}}return l}},f.F={},f.F.deflateRaw=function(e,t,l,o){var p=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],b=f.F.U,r=f.F._goodIndex;f.F._hash;var i=f.F._putsE,n=0,s=l<<3,h=0,m=e.length;if(o==0){for(;n<m;)i(t,s,n+(j=Math.min(65535,m-n))==m?1:0),s=f.F._copyExact(e,n,j,t,s+8),n+=j;return s>>>3}var w=b.lits,x=b.strt,I=b.prev,F=0,S=0,T=0,g=0,P=0,d=0;for(m>2&&(x[d=f.F._hash(e,0)]=0),n=0;n<m;n++){if(P=d,n+1<m-2){d=f.F._hash(e,n+1);var c=n+1&32767;I[c]=x[d],x[d]=c}if(h<=n){(F>14e3||S>26697)&&m-n>100&&(h<n&&(w[F]=n-h,F+=2,h=n),s=f.F._writeBlock(n==m-1||h==m?1:0,w,F,g,e,T,n-T,t,s),F=S=g=0,T=n);var v=0;n<m-2&&(v=f.F._bestMatch(e,n,I,P,Math.min(p[2],m-n),p[3]));var j=v>>>16,A=65535&v;if(v!=0){A=65535&v;var C=r(j=v>>>16,b.of0);b.lhst[257+C]++;var y=r(A,b.df0);b.dhst[y]++,g+=b.exb[C]+b.dxb[y],w[F]=j<<23|n-h,w[F+1]=A<<16|C<<8|y,F+=2,h=n+j}else b.lhst[e[n]]++;S++}}for(T==n&&e.length!=0||(h<n&&(w[F]=n-h,F+=2,h=n),s=f.F._writeBlock(1,w,F,g,e,T,n-T,t,s),F=0,S=0,F=S=g=0,T=n);(7&s)!=0;)s++;return s>>>3},f.F._bestMatch=function(e,t,l,o,p,b){var r=32767&t,i=l[r],n=r-i+32768&32767;if(i==r||o!=f.F._hash(e,t-n))return 0;for(var s=0,h=0,m=Math.min(32767,t);n<=m&&--b!=0&&i!=r;){if(s==0||e[t+s]==e[t+s-n]){var w=f.F._howLong(e,t,n);if(w>s){if(h=n,(s=w)>=p)break;n+2<w&&(w=n+2);for(var x=0,I=0;I<w-2;I++){var F=t-n+I+32768&32767,S=F-l[F]+32768&32767;S>x&&(x=S,i=F)}}}n+=(r=i)-(i=l[r])+32768&32767}return s<<16|h},f.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var o=t,p=Math.min(e.length,t+258);for(t+=3;t<p&&e[t]==e[t-l];)t++;return t-o},f.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},f.saved=0,f.F._writeBlock=function(e,t,l,o,p,b,r,i,n){var s,h,m,w,x,I,F,S,T,g=f.F.U,P=f.F._putsF,d=f.F._putsE;g.lhst[256]++,h=(s=f.F.getTrees())[0],m=s[1],w=s[2],x=s[3],I=s[4],F=s[5],S=s[6],T=s[7];var c=32+((n+3&7)==0?0:8-(n+3&7))+(r<<3),v=o+f.F.contSize(g.fltree,g.lhst)+f.F.contSize(g.fdtree,g.dhst),j=o+f.F.contSize(g.ltree,g.lhst)+f.F.contSize(g.dtree,g.dhst);j+=14+3*F+f.F.contSize(g.itree,g.ihst)+(2*g.ihst[16]+3*g.ihst[17]+7*g.ihst[18]);for(var A=0;A<286;A++)g.lhst[A]=0;for(A=0;A<30;A++)g.dhst[A]=0;for(A=0;A<19;A++)g.ihst[A]=0;var C=c<v&&c<j?0:v<j?1:2;if(P(i,n,e),P(i,n+1,C),n+=3,C==0){for(;(7&n)!=0;)n++;n=f.F._copyExact(p,b,r,i,n)}else{var y,E;if(C==1&&(y=g.fltree,E=g.fdtree),C==2){f.F.makeCodes(g.ltree,h),f.F.revCodes(g.ltree,h),f.F.makeCodes(g.dtree,m),f.F.revCodes(g.dtree,m),f.F.makeCodes(g.itree,w),f.F.revCodes(g.itree,w),y=g.ltree,E=g.dtree,d(i,n,x-257),d(i,n+=5,I-1),d(i,n+=5,F-4),n+=4;for(var u=0;u<F;u++)d(i,n+3*u,g.itree[1+(g.ordr[u]<<1)]);n+=3*F,n=f.F._codeTiny(S,g.itree,i,n),n=f.F._codeTiny(T,g.itree,i,n)}for(var a=b,z=0;z<l;z+=2){for(var U=t[z],O=U>>>23,B=a+(8388607&U);a<B;)n=f.F._writeLit(p[a++],y,i,n);if(O!=0){var N=t[z+1],H=N>>16,L=N>>8&255,M=255&N;d(i,n=f.F._writeLit(257+L,y,i,n),O-g.of0[L]),n+=g.exb[L],P(i,n=f.F._writeLit(M,E,i,n),H-g.df0[M]),n+=g.dxb[M],a+=O}}n=f.F._writeLit(256,y,i,n)}return n},f.F._copyExact=function(e,t,l,o,p){var b=p>>>3;return o[b]=l,o[b+1]=l>>>8,o[b+2]=255-o[b],o[b+3]=255-o[b+1],b+=4,o.set(new Uint8Array(e.buffer,t,l),b),p+(l+4<<3)},f.F.getTrees=function(){for(var e=f.F.U,t=f.F._hufTree(e.lhst,e.ltree,15),l=f.F._hufTree(e.dhst,e.dtree,15),o=[],p=f.F._lenCodes(e.ltree,o),b=[],r=f.F._lenCodes(e.dtree,b),i=0;i<o.length;i+=2)e.ihst[o[i]]++;for(i=0;i<b.length;i+=2)e.ihst[b[i]]++;for(var n=f.F._hufTree(e.ihst,e.itree,7),s=19;s>4&&e.itree[1+(e.ordr[s-1]<<1)]==0;)s--;return[t,l,n,p,r,s,o,b]},f.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},f.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},f.F.contSize=function(e,t){for(var l=0,o=0;o<t.length;o++)l+=t[o]*e[1+(o<<1)];return l},f.F._codeTiny=function(e,t,l,o){for(var p=0;p<e.length;p+=2){var b=e[p],r=e[p+1];o=f.F._writeLit(b,t,l,o);var i=b==16?2:b==17?3:7;b>15&&(f.F._putsE(l,o,r,i),o+=i)}return o},f.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var o=0;o<l;o+=2){var p=e[o+1],b=o+3<l?e[o+3]:-1,r=o+5<l?e[o+5]:-1,i=o==0?-1:e[o-1];if(p==0&&b==p&&r==p){for(var n=o+5;n+2<l&&e[n+2]==p;)n+=2;(s=Math.min(n+1-o>>>1,138))<11?t.push(17,s-3):t.push(18,s-11),o+=2*s-2}else if(p==i&&b==p&&r==p){for(n=o+5;n+2<l&&e[n+2]==p;)n+=2;var s=Math.min(n+1-o>>>1,6);t.push(16,s-3),o+=2*s-2}else t.push(p,0)}return l>>>1},f.F._hufTree=function(e,t,l){var o=[],p=e.length,b=t.length,r=0;for(r=0;r<b;r+=2)t[r]=0,t[r+1]=0;for(r=0;r<p;r++)e[r]!=0&&o.push({lit:r,f:e[r]});var i=o.length,n=o.slice(0);if(i==0)return 0;if(i==1){var s=o[0].lit;return n=s==0?1:0,t[1+(s<<1)]=1,t[1+(n<<1)]=1,1}o.sort((function(S,T){return S.f-T.f}));var h=o[0],m=o[1],w=0,x=1,I=2;for(o[0]={lit:-1,f:h.f+m.f,l:h,r:m,d:0};x!=i-1;)h=w!=x&&(I==i||o[w].f<o[I].f)?o[w++]:o[I++],m=w!=x&&(I==i||o[w].f<o[I].f)?o[w++]:o[I++],o[x++]={lit:-1,f:h.f+m.f,l:h,r:m};var F=f.F.setDepth(o[x-1],0);for(F>l&&(f.F.restrictDepth(n,l,F),F=l),r=0;r<i;r++)t[1+(n[r].lit<<1)]=n[r].d;return F},f.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(f.F.setDepth(e.l,t+1),f.F.setDepth(e.r,t+1))},f.F.restrictDepth=function(e,t,l){var o=0,p=1<<l-t,b=0;for(e.sort((function(i,n){return n.d==i.d?i.f-n.f:n.d-i.d})),o=0;o<e.length&&e[o].d>t;o++){var r=e[o].d;e[o].d=t,b+=p-(1<<l-r)}for(b>>>=l-t;b>0;)(r=e[o].d)<t?(e[o].d++,b-=1<<t-r-1):o++;for(;o>=0;o--)e[o].d==t&&b<0&&(e[o].d--,b++);b!=0&&console.log("debt left")},f.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},f.F._writeLit=function(e,t,l,o){return f.F._putsF(l,o,t[e<<1]),o+t[1+(e<<1)]},f.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var o=f.F,p=o._bitsF,b=o._bitsE,r=o._decodeTiny,i=o.makeCodes,n=o.codes2map,s=o._get17,h=o.U,m=t==null;m&&(t=new l(e.length>>>2<<3));for(var w,x,I=0,F=0,S=0,T=0,g=0,P=0,d=0,c=0,v=0;I==0;)if(I=p(e,v,1),F=p(e,v+1,2),v+=3,F!=0){if(m&&(t=f.F._check(t,c+(1<<17))),F==1&&(w=h.flmap,x=h.fdmap,P=511,d=31),F==2){S=b(e,v,5)+257,T=b(e,v+5,5)+1,g=b(e,v+10,4)+4,v+=14;for(var j=0;j<38;j+=2)h.itree[j]=0,h.itree[j+1]=0;var A=1;for(j=0;j<g;j++){var C=b(e,v+3*j,3);h.itree[1+(h.ordr[j]<<1)]=C,C>A&&(A=C)}v+=3*g,i(h.itree,A),n(h.itree,A,h.imap),w=h.lmap,x=h.dmap,v=r(h.imap,(1<<A)-1,S+T,e,v,h.ttree);var y=o._copyOut(h.ttree,0,S,h.ltree);P=(1<<y)-1;var E=o._copyOut(h.ttree,S,T,h.dtree);d=(1<<E)-1,i(h.ltree,y),n(h.ltree,y,w),i(h.dtree,E),n(h.dtree,E,x)}for(;;){var u=w[s(e,v)&P];v+=15&u;var a=u>>>4;if(!(a>>>8))t[c++]=a;else{if(a==256)break;var z=c+a-254;if(a>264){var U=h.ldef[a-257];z=c+(U>>>3)+b(e,v,7&U),v+=7&U}var O=x[s(e,v)&d];v+=15&O;var B=O>>>4,N=h.ddef[B],H=(N>>>4)+p(e,v,15&N);for(v+=15&N,m&&(t=f.F._check(t,c+(1<<17)));c<z;)t[c]=t[c++-H],t[c]=t[c++-H],t[c]=t[c++-H],t[c]=t[c++-H];c=z}}}else{(7&v)!=0&&(v+=8-(7&v));var L=4+(v>>>3),M=e[L-4]|e[L-3]<<8;m&&(t=f.F._check(t,c+M)),t.set(new l(e.buffer,e.byteOffset+L,M),c),v=L+M<<3,c+=M}return t.length==c?t:t.slice(0,c)},f.F._check=function(e,t){var l=e.length;if(t<=l)return e;var o=new Uint8Array(Math.max(l<<1,t));return o.set(e,0),o},f.F._decodeTiny=function(e,t,l,o,p,b){for(var r=f.F._bitsE,i=f.F._get17,n=0;n<l;){var s=e[i(o,p)&t];p+=15&s;var h=s>>>4;if(h<=15)b[n]=h,n++;else{var m=0,w=0;h==16?(w=3+r(o,p,2),p+=2,m=b[n-1]):h==17?(w=3+r(o,p,3),p+=3):h==18&&(w=11+r(o,p,7),p+=7);for(var x=n+w;n<x;)b[n]=m,n++}}return p},f.F._copyOut=function(e,t,l,o){for(var p=0,b=0,r=o.length>>>1;b<l;){var i=e[b+t];o[b<<1]=0,o[1+(b<<1)]=i,i>p&&(p=i),b++}for(;b<r;)o[b<<1]=0,o[1+(b<<1)]=0,b++;return p},f.F.makeCodes=function(e,t){for(var l,o,p,b,r=f.F.U,i=e.length,n=r.bl_count,s=0;s<=t;s++)n[s]=0;for(s=1;s<i;s+=2)n[e[s]]++;var h=r.next_code;for(l=0,n[0]=0,o=1;o<=t;o++)l=l+n[o-1]<<1,h[o]=l;for(p=0;p<i;p+=2)(b=e[p+1])!=0&&(e[p]=h[b],h[b]++)},f.F.codes2map=function(e,t,l){for(var o=e.length,p=f.F.U.rev15,b=0;b<o;b+=2)if(e[b+1]!=0)for(var r=b>>1,i=e[b+1],n=r<<4|i,s=t-i,h=e[b]<<s,m=h+(1<<s);h!=m;)l[p[h]>>>15-t]=n,h++},f.F.revCodes=function(e,t){for(var l=f.F.U.rev15,o=15-t,p=0;p<e.length;p+=2){var b=e[p]<<t-e[p+1];e[p]=l[b]>>>o}},f.F._putsE=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8},f.F._putsF=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8,e[o+2]|=l>>>16},f.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},f.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},f.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},f.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},f.F.U=(k=Uint16Array,D=Uint32Array,{next_code:new k(16),bl_count:new k(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new k(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new D(32),flmap:new k(512),fltree:[],fdmap:new k(32),fdtree:[],lmap:new k(32768),ltree:[],ttree:[],dmap:new k(32768),dtree:[],imap:new k(512),itree:[],rev15:new k(32768),lhst:new D(286),dhst:new D(30),ihst:new D(19),lits:new D(15e3),strt:new k(65536),prev:new k(32768)}),(function(){for(var e=f.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function o(p,b,r){for(;b--!=0;)p.push(0,r)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),f.F.makeCodes(e.fltree,9),f.F.codes2map(e.fltree,9,e.flmap),f.F.revCodes(e.fltree,9),o(e.fdtree,32,5),f.F.makeCodes(e.fdtree,5),f.F.codes2map(e.fdtree,5,e.fdmap),f.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)})()})();var pt=dt({__proto__:null,default:Te},[Te]);const ge=(function(){var _={nextZero(r,i){for(;r[i]!=0;)i++;return i},readUshort:(r,i)=>r[i]<<8|r[i+1],writeUshort(r,i,n){r[i]=n>>8&255,r[i+1]=255&n},readUint:(r,i)=>16777216*r[i]+(r[i+1]<<16|r[i+2]<<8|r[i+3]),writeUint(r,i,n){r[i]=n>>24&255,r[i+1]=n>>16&255,r[i+2]=n>>8&255,r[i+3]=255&n},readASCII(r,i,n){let s="";for(let h=0;h<n;h++)s+=String.fromCharCode(r[i+h]);return s},writeASCII(r,i,n){for(let s=0;s<n.length;s++)r[i+s]=n.charCodeAt(s)},readBytes(r,i,n){const s=[];for(let h=0;h<n;h++)s.push(r[i+h]);return s},pad:r=>r.length<2?`0${r}`:r,readUTF8(r,i,n){let s,h="";for(let m=0;m<n;m++)h+=`%${_.pad(r[i+m].toString(16))}`;try{s=decodeURIComponent(h)}catch{return _.readASCII(r,i,n)}return s}};function k(r,i,n,s){const h=i*n,m=t(s),w=Math.ceil(i*m/8),x=new Uint8Array(4*h),I=new Uint32Array(x.buffer),{ctype:F}=s,{depth:S}=s,T=_.readUshort;if(F==6){const U=h<<2;if(S==8)for(var g=0;g<U;g+=4)x[g]=r[g],x[g+1]=r[g+1],x[g+2]=r[g+2],x[g+3]=r[g+3];if(S==16)for(g=0;g<U;g++)x[g]=r[g<<1]}else if(F==2){const U=s.tabs.tRNS;if(U==null){if(S==8)for(g=0;g<h;g++){var P=3*g;I[g]=255<<24|r[P+2]<<16|r[P+1]<<8|r[P]}if(S==16)for(g=0;g<h;g++)P=6*g,I[g]=255<<24|r[P+4]<<16|r[P+2]<<8|r[P]}else{var d=U[0];const O=U[1],B=U[2];if(S==8)for(g=0;g<h;g++){var c=g<<2;P=3*g,I[g]=255<<24|r[P+2]<<16|r[P+1]<<8|r[P],r[P]==d&&r[P+1]==O&&r[P+2]==B&&(x[c+3]=0)}if(S==16)for(g=0;g<h;g++)c=g<<2,P=6*g,I[g]=255<<24|r[P+4]<<16|r[P+2]<<8|r[P],T(r,P)==d&&T(r,P+2)==O&&T(r,P+4)==B&&(x[c+3]=0)}}else if(F==3){const U=s.tabs.PLTE,O=s.tabs.tRNS,B=O?O.length:0;if(S==1)for(var v=0;v<n;v++){var j=v*w,A=v*i;for(g=0;g<i;g++){c=A+g<<2;var C=3*(y=r[j+(g>>3)]>>7-((7&g)<<0)&1);x[c]=U[C],x[c+1]=U[C+1],x[c+2]=U[C+2],x[c+3]=y<B?O[y]:255}}if(S==2)for(v=0;v<n;v++)for(j=v*w,A=v*i,g=0;g<i;g++)c=A+g<<2,C=3*(y=r[j+(g>>2)]>>6-((3&g)<<1)&3),x[c]=U[C],x[c+1]=U[C+1],x[c+2]=U[C+2],x[c+3]=y<B?O[y]:255;if(S==4)for(v=0;v<n;v++)for(j=v*w,A=v*i,g=0;g<i;g++)c=A+g<<2,C=3*(y=r[j+(g>>1)]>>4-((1&g)<<2)&15),x[c]=U[C],x[c+1]=U[C+1],x[c+2]=U[C+2],x[c+3]=y<B?O[y]:255;if(S==8)for(g=0;g<h;g++){var y;c=g<<2,C=3*(y=r[g]),x[c]=U[C],x[c+1]=U[C+1],x[c+2]=U[C+2],x[c+3]=y<B?O[y]:255}}else if(F==4){if(S==8)for(g=0;g<h;g++){c=g<<2;var E=r[u=g<<1];x[c]=E,x[c+1]=E,x[c+2]=E,x[c+3]=r[u+1]}if(S==16)for(g=0;g<h;g++){var u;c=g<<2,E=r[u=g<<2],x[c]=E,x[c+1]=E,x[c+2]=E,x[c+3]=r[u+2]}}else if(F==0)for(d=s.tabs.tRNS?s.tabs.tRNS:-1,v=0;v<n;v++){const U=v*w,O=v*i;if(S==1)for(var a=0;a<i;a++){var z=(E=255*(r[U+(a>>>3)]>>>7-(7&a)&1))==255*d?0:255;I[O+a]=z<<24|E<<16|E<<8|E}else if(S==2)for(a=0;a<i;a++)z=(E=85*(r[U+(a>>>2)]>>>6-((3&a)<<1)&3))==85*d?0:255,I[O+a]=z<<24|E<<16|E<<8|E;else if(S==4)for(a=0;a<i;a++)z=(E=17*(r[U+(a>>>1)]>>>4-((1&a)<<2)&15))==17*d?0:255,I[O+a]=z<<24|E<<16|E<<8|E;else if(S==8)for(a=0;a<i;a++)z=(E=r[U+a])==d?0:255,I[O+a]=z<<24|E<<16|E<<8|E;else if(S==16)for(a=0;a<i;a++)E=r[U+(a<<1)],z=T(r,U+(a<<1))==d?0:255,I[O+a]=z<<24|E<<16|E<<8|E}return x}function D(r,i,n,s){const h=t(r),m=Math.ceil(n*h/8),w=new Uint8Array((m+1+r.interlace)*s);return i=r.tabs.CgBI?e(i,w):f(i,w),r.interlace==0?i=l(i,r,0,n,s):r.interlace==1&&(i=(function(I,F){const S=F.width,T=F.height,g=t(F),P=g>>3,d=Math.ceil(S*g/8),c=new Uint8Array(T*d);let v=0;const j=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],C=[8,8,8,4,4,2,2],y=[8,8,4,4,2,2,1];let E=0;for(;E<7;){const a=C[E],z=y[E];let U=0,O=0,B=j[E];for(;B<T;)B+=a,O++;let N=A[E];for(;N<S;)N+=z,U++;const H=Math.ceil(U*g/8);l(I,F,v,U,O);let L=0,M=j[E];for(;M<T;){let W=A[E],Y=v+L*H<<3;for(;W<S;){var u;if(g==1&&(u=(u=I[Y>>3])>>7-(7&Y)&1,c[M*d+(W>>3)]|=u<<7-((7&W)<<0)),g==2&&(u=(u=I[Y>>3])>>6-(7&Y)&3,c[M*d+(W>>2)]|=u<<6-((3&W)<<1)),g==4&&(u=(u=I[Y>>3])>>4-(7&Y)&15,c[M*d+(W>>1)]|=u<<4-((1&W)<<2)),g>=8){const G=M*d+W*P;for(let q=0;q<P;q++)c[G+q]=I[(Y>>3)+q]}Y+=g,W+=z}L++,M+=a}U*O!=0&&(v+=O*(1+H)),E+=1}return c})(i,r)),i}function f(r,i){return e(new Uint8Array(r.buffer,2,r.length-6),i)}var e=(function(){const r={H:{}};return r.H.N=function(i,n){const s=Uint8Array;let h,m,w=0,x=0,I=0,F=0,S=0,T=0,g=0,P=0,d=0;if(i[0]==3&&i[1]==0)return n||new s(0);const c=r.H,v=c.b,j=c.e,A=c.R,C=c.n,y=c.A,E=c.Z,u=c.m,a=n==null;for(a&&(n=new s(i.length>>>2<<5));w==0;)if(w=v(i,d,1),x=v(i,d+1,2),d+=3,x!=0){if(a&&(n=r.H.W(n,P+(1<<17))),x==1&&(h=u.J,m=u.h,T=511,g=31),x==2){I=j(i,d,5)+257,F=j(i,d+5,5)+1,S=j(i,d+10,4)+4,d+=14;let U=1;for(var z=0;z<38;z+=2)u.Q[z]=0,u.Q[z+1]=0;for(z=0;z<S;z++){const N=j(i,d+3*z,3);u.Q[1+(u.X[z]<<1)]=N,N>U&&(U=N)}d+=3*S,C(u.Q,U),y(u.Q,U,u.u),h=u.w,m=u.d,d=A(u.u,(1<<U)-1,I+F,i,d,u.v);const O=c.V(u.v,0,I,u.C);T=(1<<O)-1;const B=c.V(u.v,I,F,u.D);g=(1<<B)-1,C(u.C,O),y(u.C,O,h),C(u.D,B),y(u.D,B,m)}for(;;){const U=h[E(i,d)&T];d+=15&U;const O=U>>>4;if(!(O>>>8))n[P++]=O;else{if(O==256)break;{let B=P+O-254;if(O>264){const W=u.q[O-257];B=P+(W>>>3)+j(i,d,7&W),d+=7&W}const N=m[E(i,d)&g];d+=15&N;const H=N>>>4,L=u.c[H],M=(L>>>4)+v(i,d,15&L);for(d+=15&L;P<B;)n[P]=n[P++-M],n[P]=n[P++-M],n[P]=n[P++-M],n[P]=n[P++-M];P=B}}}}else{(7&d)!=0&&(d+=8-(7&d));const U=4+(d>>>3),O=i[U-4]|i[U-3]<<8;a&&(n=r.H.W(n,P+O)),n.set(new s(i.buffer,i.byteOffset+U,O),P),d=U+O<<3,P+=O}return n.length==P?n:n.slice(0,P)},r.H.W=function(i,n){const s=i.length;if(n<=s)return i;const h=new Uint8Array(s<<1);return h.set(i,0),h},r.H.R=function(i,n,s,h,m,w){const x=r.H.e,I=r.H.Z;let F=0;for(;F<s;){const S=i[I(h,m)&n];m+=15&S;const T=S>>>4;if(T<=15)w[F]=T,F++;else{let g=0,P=0;T==16?(P=3+x(h,m,2),m+=2,g=w[F-1]):T==17?(P=3+x(h,m,3),m+=3):T==18&&(P=11+x(h,m,7),m+=7);const d=F+P;for(;F<d;)w[F]=g,F++}}return m},r.H.V=function(i,n,s,h){let m=0,w=0;const x=h.length>>>1;for(;w<s;){const I=i[w+n];h[w<<1]=0,h[1+(w<<1)]=I,I>m&&(m=I),w++}for(;w<x;)h[w<<1]=0,h[1+(w<<1)]=0,w++;return m},r.H.n=function(i,n){const s=r.H.m,h=i.length;let m,w,x,I;const F=s.j;for(var S=0;S<=n;S++)F[S]=0;for(S=1;S<h;S+=2)F[i[S]]++;const T=s.K;for(m=0,F[0]=0,w=1;w<=n;w++)m=m+F[w-1]<<1,T[w]=m;for(x=0;x<h;x+=2)I=i[x+1],I!=0&&(i[x]=T[I],T[I]++)},r.H.A=function(i,n,s){const h=i.length,m=r.H.m.r;for(let w=0;w<h;w+=2)if(i[w+1]!=0){const x=w>>1,I=i[w+1],F=x<<4|I,S=n-I;let T=i[w]<<S;const g=T+(1<<S);for(;T!=g;)s[m[T]>>>15-n]=F,T++}},r.H.l=function(i,n){const s=r.H.m.r,h=15-n;for(let m=0;m<i.length;m+=2){const w=i[m]<<n-i[m+1];i[m]=s[w]>>>h}},r.H.M=function(i,n,s){s<<=7&n;const h=n>>>3;i[h]|=s,i[h+1]|=s>>>8},r.H.I=function(i,n,s){s<<=7&n;const h=n>>>3;i[h]|=s,i[h+1]|=s>>>8,i[h+2]|=s>>>16},r.H.e=function(i,n,s){return(i[n>>>3]|i[1+(n>>>3)]<<8)>>>(7&n)&(1<<s)-1},r.H.b=function(i,n,s){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)&(1<<s)-1},r.H.Z=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)},r.H.i=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16|i[3+(n>>>3)]<<24)>>>(7&n)},r.H.m=(function(){const i=Uint16Array,n=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=r.H.m;for(var n=0;n<32768;n++){let h=n;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[n]=(h>>>16|h<<16)>>>17}function s(h,m,w){for(;m--!=0;)h.push(0,w)}for(n=0;n<32;n++)i.q[n]=i.S[n]<<3|i.T[n],i.c[n]=i.p[n]<<4|i.z[n];s(i._,144,8),s(i._,112,9),s(i._,24,7),s(i._,8,8),r.H.n(i._,9),r.H.A(i._,9,i.J),r.H.l(i._,9),s(i.$,32,5),r.H.n(i.$,5),r.H.A(i.$,5,i.h),r.H.l(i.$,5),s(i.Q,19,0),s(i.C,286,0),s(i.D,30,0),s(i.v,320,0)})(),r.H.N})();function t(r){return[1,null,3,1,2,null,4][r.ctype]*r.depth}function l(r,i,n,s,h){let m=t(i);const w=Math.ceil(s*m/8);let x,I;m=Math.ceil(m/8);let F=r[n],S=0;if(F>1&&(r[n]=[0,0,1][F-2]),F==3)for(S=m;S<w;S++)r[S+1]=r[S+1]+(r[S+1-m]>>>1)&255;for(let T=0;T<h;T++)if(x=n+T*w,I=x+T+1,F=r[I-1],S=0,F==0)for(;S<w;S++)r[x+S]=r[I+S];else if(F==1){for(;S<m;S++)r[x+S]=r[I+S];for(;S<w;S++)r[x+S]=r[I+S]+r[x+S-m]}else if(F==2)for(;S<w;S++)r[x+S]=r[I+S]+r[x+S-w];else if(F==3){for(;S<m;S++)r[x+S]=r[I+S]+(r[x+S-w]>>>1);for(;S<w;S++)r[x+S]=r[I+S]+(r[x+S-w]+r[x+S-m]>>>1)}else{for(;S<m;S++)r[x+S]=r[I+S]+o(0,r[x+S-w],0);for(;S<w;S++)r[x+S]=r[I+S]+o(r[x+S-m],r[x+S-w],r[x+S-m-w])}return r}function o(r,i,n){const s=r+i-n,h=s-r,m=s-i,w=s-n;return h*h<=m*m&&h*h<=w*w?r:m*m<=w*w?i:n}function p(r,i,n){n.width=_.readUint(r,i),i+=4,n.height=_.readUint(r,i),i+=4,n.depth=r[i],i++,n.ctype=r[i],i++,n.compress=r[i],i++,n.filter=r[i],i++,n.interlace=r[i],i++}function b(r,i,n,s,h,m,w,x,I){const F=Math.min(i,h),S=Math.min(n,m);let T=0,g=0;for(let E=0;E<S;E++)for(let u=0;u<F;u++)if(w>=0&&x>=0?(T=E*i+u<<2,g=(x+E)*h+w+u<<2):(T=(-x+E)*i-w+u<<2,g=E*h+u<<2),I==0)s[g]=r[T],s[g+1]=r[T+1],s[g+2]=r[T+2],s[g+3]=r[T+3];else if(I==1){var P=r[T+3]*.00392156862745098,d=r[T]*P,c=r[T+1]*P,v=r[T+2]*P,j=s[g+3]*(1/255),A=s[g]*j,C=s[g+1]*j,y=s[g+2]*j;const a=1-P,z=P+j*a,U=z==0?0:1/z;s[g+3]=255*z,s[g+0]=(d+A*a)*U,s[g+1]=(c+C*a)*U,s[g+2]=(v+y*a)*U}else if(I==2)P=r[T+3],d=r[T],c=r[T+1],v=r[T+2],j=s[g+3],A=s[g],C=s[g+1],y=s[g+2],P==j&&d==A&&c==C&&v==y?(s[g]=0,s[g+1]=0,s[g+2]=0,s[g+3]=0):(s[g]=d,s[g+1]=c,s[g+2]=v,s[g+3]=P);else if(I==3){if(P=r[T+3],d=r[T],c=r[T+1],v=r[T+2],j=s[g+3],A=s[g],C=s[g+1],y=s[g+2],P==j&&d==A&&c==C&&v==y)continue;if(P<220&&j>20)return!1}return!0}return{decode:function(i){const n=new Uint8Array(i);let s=8;const h=_,m=h.readUshort,w=h.readUint,x={tabs:{},frames:[]},I=new Uint8Array(n.length);let F,S=0,T=0;const g=[137,80,78,71,13,10,26,10];for(var P=0;P<8;P++)if(n[P]!=g[P])throw"The input is not a PNG file!";for(;s<n.length;){const E=h.readUint(n,s);s+=4;const u=h.readASCII(n,s,4);if(s+=4,u=="IHDR")p(n,s,x);else if(u=="iCCP"){for(var d=s;n[d]!=0;)d++;h.readASCII(n,s,d-s),n[d+1];const a=n.slice(d+2,s+E);let z=null;try{z=f(a)}catch{z=e(a)}x.tabs[u]=z}else if(u=="CgBI")x.tabs[u]=n.slice(s,s+4);else if(u=="IDAT"){for(P=0;P<E;P++)I[S+P]=n[s+P];S+=E}else if(u=="acTL")x.tabs[u]={num_frames:w(n,s),num_plays:w(n,s+4)},F=new Uint8Array(n.length);else if(u=="fcTL"){T!=0&&((y=x.frames[x.frames.length-1]).data=D(x,F.slice(0,T),y.rect.width,y.rect.height),T=0);const a={x:w(n,s+12),y:w(n,s+16),width:w(n,s+4),height:w(n,s+8)};let z=m(n,s+22);z=m(n,s+20)/(z==0?100:z);const U={rect:a,delay:Math.round(1e3*z),dispose:n[s+24],blend:n[s+25]};x.frames.push(U)}else if(u=="fdAT"){for(P=0;P<E-4;P++)F[T+P]=n[s+P+4];T+=E-4}else if(u=="pHYs")x.tabs[u]=[h.readUint(n,s),h.readUint(n,s+4),n[s+8]];else if(u=="cHRM")for(x.tabs[u]=[],P=0;P<8;P++)x.tabs[u].push(h.readUint(n,s+4*P));else if(u=="tEXt"||u=="zTXt"){x.tabs[u]==null&&(x.tabs[u]={});var c=h.nextZero(n,s),v=h.readASCII(n,s,c-s),j=s+E-c-1;if(u=="tEXt")C=h.readASCII(n,c+1,j);else{var A=f(n.slice(c+2,c+2+j));C=h.readUTF8(A,0,A.length)}x.tabs[u][v]=C}else if(u=="iTXt"){x.tabs[u]==null&&(x.tabs[u]={}),c=0,d=s,c=h.nextZero(n,d),v=h.readASCII(n,d,c-d);const a=n[d=c+1];var C;n[d+1],d+=2,c=h.nextZero(n,d),h.readASCII(n,d,c-d),d=c+1,c=h.nextZero(n,d),h.readUTF8(n,d,c-d),j=E-((d=c+1)-s),a==0?C=h.readUTF8(n,d,j):(A=f(n.slice(d,d+j)),C=h.readUTF8(A,0,A.length)),x.tabs[u][v]=C}else if(u=="PLTE")x.tabs[u]=h.readBytes(n,s,E);else if(u=="hIST"){const a=x.tabs.PLTE.length/3;for(x.tabs[u]=[],P=0;P<a;P++)x.tabs[u].push(m(n,s+2*P))}else if(u=="tRNS")x.ctype==3?x.tabs[u]=h.readBytes(n,s,E):x.ctype==0?x.tabs[u]=m(n,s):x.ctype==2&&(x.tabs[u]=[m(n,s),m(n,s+2),m(n,s+4)]);else if(u=="gAMA")x.tabs[u]=h.readUint(n,s)/1e5;else if(u=="sRGB")x.tabs[u]=n[s];else if(u=="bKGD")x.ctype==0||x.ctype==4?x.tabs[u]=[m(n,s)]:x.ctype==2||x.ctype==6?x.tabs[u]=[m(n,s),m(n,s+2),m(n,s+4)]:x.ctype==3&&(x.tabs[u]=n[s]);else if(u=="IEND")break;s+=E,h.readUint(n,s),s+=4}var y;return T!=0&&((y=x.frames[x.frames.length-1]).data=D(x,F.slice(0,T),y.rect.width,y.rect.height)),x.data=D(x,I,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(i){const n=i.width,s=i.height;if(i.tabs.acTL==null)return[k(i.data,n,s,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const m=n*s*4,w=new Uint8Array(m),x=new Uint8Array(m),I=new Uint8Array(m);for(let S=0;S<i.frames.length;S++){const T=i.frames[S],g=T.rect.x,P=T.rect.y,d=T.rect.width,c=T.rect.height,v=k(T.data,d,c,i);if(S!=0)for(var F=0;F<m;F++)I[F]=w[F];if(T.blend==0?b(v,d,c,w,n,s,g,P,0):T.blend==1&&b(v,d,c,w,n,s,g,P,1),h.push(w.buffer.slice(0)),T.dispose!=0){if(T.dispose==1)b(x,d,c,w,n,s,g,P,0);else if(T.dispose==2)for(F=0;F<m;F++)w[F]=I[F]}}return h},_paeth:o,_copyTile:b,_bin:_}})();(function(){const{_copyTile:_}=ge,{_bin:k}=ge,D=ge._paeth;var f={table:(function(){const d=new Uint32Array(256);for(let c=0;c<256;c++){let v=c;for(let j=0;j<8;j++)1&v?v=3988292384^v>>>1:v>>>=1;d[c]=v}return d})(),update(d,c,v,j){for(let A=0;A<j;A++)d=f.table[255&(d^c[v+A])]^d>>>8;return d},crc:(d,c,v)=>4294967295^f.update(4294967295,d,c,v)};function e(d,c,v,j){c[v]+=d[0]*j>>4,c[v+1]+=d[1]*j>>4,c[v+2]+=d[2]*j>>4,c[v+3]+=d[3]*j>>4}function t(d){return Math.max(0,Math.min(255,d))}function l(d,c){const v=d[0]-c[0],j=d[1]-c[1],A=d[2]-c[2],C=d[3]-c[3];return v*v+j*j+A*A+C*C}function o(d,c,v,j,A,C,y){y==null&&(y=1);const E=j.length,u=[];for(var a=0;a<E;a++){const M=j[a];u.push([M>>>0&255,M>>>8&255,M>>>16&255,M>>>24&255])}for(a=0;a<E;a++){let M=4294967295;for(var z=0,U=0;U<E;U++){var O=l(u[a],u[U]);U!=a&&O<M&&(M=O,z=U)}}const B=new Uint32Array(A.buffer),N=new Int16Array(c*v*4),H=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(a=0;a<H.length;a++)H[a]=255*((H[a]+.5)/16-.5);for(let M=0;M<v;M++)for(let W=0;W<c;W++){var L;a=4*(M*c+W),y!=2?L=[t(d[a]+N[a]),t(d[a+1]+N[a+1]),t(d[a+2]+N[a+2]),t(d[a+3]+N[a+3])]:(O=H[4*(3&M)+(3&W)],L=[t(d[a]+O),t(d[a+1]+O),t(d[a+2]+O),t(d[a+3]+O)]),z=0;let Y=16777215;for(U=0;U<E;U++){const K=l(L,u[U]);K<Y&&(Y=K,z=U)}const G=u[z],q=[L[0]-G[0],L[1]-G[1],L[2]-G[2],L[3]-G[3]];y==1&&(W!=c-1&&e(q,N,a+4,7),M!=v-1&&(W!=0&&e(q,N,a+4*c-4,3),e(q,N,a+4*c,5),W!=c-1&&e(q,N,a+4*c+4,1))),C[a>>2]=z,B[a>>2]=j[z]}}function p(d,c,v,j,A){A==null&&(A={});const{crc:C}=f,y=k.writeUint,E=k.writeUshort,u=k.writeASCII;let a=8;const z=d.frames.length>1;let U,O=!1,B=33+(z?20:0);if(A.sRGB!=null&&(B+=13),A.pHYs!=null&&(B+=21),A.iCCP!=null&&(U=pako.deflate(A.iCCP),B+=21+U.length+4),d.ctype==3){for(var N=d.plte.length,H=0;H<N;H++)d.plte[H]>>>24!=255&&(O=!0);B+=8+3*N+4+(O?8+1*N+4:0)}for(var L=0;L<d.frames.length;L++)z&&(B+=38),B+=(G=d.frames[L]).cimg.length+12,L!=0&&(B+=4);B+=12;const M=new Uint8Array(B),W=[137,80,78,71,13,10,26,10];for(H=0;H<8;H++)M[H]=W[H];if(y(M,a,13),a+=4,u(M,a,"IHDR"),a+=4,y(M,a,c),a+=4,y(M,a,v),a+=4,M[a]=d.depth,a++,M[a]=d.ctype,a++,M[a]=0,a++,M[a]=0,a++,M[a]=0,a++,y(M,a,C(M,a-17,17)),a+=4,A.sRGB!=null&&(y(M,a,1),a+=4,u(M,a,"sRGB"),a+=4,M[a]=A.sRGB,a++,y(M,a,C(M,a-5,5)),a+=4),A.iCCP!=null){const q=13+U.length;y(M,a,q),a+=4,u(M,a,"iCCP"),a+=4,u(M,a,"ICC profile"),a+=11,a+=2,M.set(U,a),a+=U.length,y(M,a,C(M,a-(q+4),q+4)),a+=4}if(A.pHYs!=null&&(y(M,a,9),a+=4,u(M,a,"pHYs"),a+=4,y(M,a,A.pHYs[0]),a+=4,y(M,a,A.pHYs[1]),a+=4,M[a]=A.pHYs[2],a++,y(M,a,C(M,a-13,13)),a+=4),z&&(y(M,a,8),a+=4,u(M,a,"acTL"),a+=4,y(M,a,d.frames.length),a+=4,y(M,a,A.loop!=null?A.loop:0),a+=4,y(M,a,C(M,a-12,12)),a+=4),d.ctype==3){for(y(M,a,3*(N=d.plte.length)),a+=4,u(M,a,"PLTE"),a+=4,H=0;H<N;H++){const q=3*H,K=d.plte[H],ee=255&K,re=K>>>8&255,_e=K>>>16&255;M[a+q+0]=ee,M[a+q+1]=re,M[a+q+2]=_e}if(a+=3*N,y(M,a,C(M,a-3*N-4,3*N+4)),a+=4,O){for(y(M,a,N),a+=4,u(M,a,"tRNS"),a+=4,H=0;H<N;H++)M[a+H]=d.plte[H]>>>24&255;a+=N,y(M,a,C(M,a-N-4,N+4)),a+=4}}let Y=0;for(L=0;L<d.frames.length;L++){var G=d.frames[L];z&&(y(M,a,26),a+=4,u(M,a,"fcTL"),a+=4,y(M,a,Y++),a+=4,y(M,a,G.rect.width),a+=4,y(M,a,G.rect.height),a+=4,y(M,a,G.rect.x),a+=4,y(M,a,G.rect.y),a+=4,E(M,a,j[L]),a+=2,E(M,a,1e3),a+=2,M[a]=G.dispose,a++,M[a]=G.blend,a++,y(M,a,C(M,a-30,30)),a+=4);const q=G.cimg;y(M,a,(N=q.length)+(L==0?0:4)),a+=4;const K=a;u(M,a,L==0?"IDAT":"fdAT"),a+=4,L!=0&&(y(M,a,Y++),a+=4),M.set(q,a),a+=N,y(M,a,C(M,K,a-K)),a+=4}return y(M,a,0),a+=4,u(M,a,"IEND"),a+=4,y(M,a,C(M,a-4,4)),a+=4,M.buffer}function b(d,c,v){for(let j=0;j<d.frames.length;j++){const A=d.frames[j];A.rect.width;const C=A.rect.height,y=new Uint8Array(C*A.bpl+C);A.cimg=s(A.img,C,A.bpp,A.bpl,y,c,v)}}function r(d,c,v,j,A){const C=A[0],y=A[1],E=A[2],u=A[3],a=A[4],z=A[5];let U=6,O=8,B=255;for(var N=0;N<d.length;N++){const oe=new Uint8Array(d[N]);for(var H=oe.length,L=0;L<H;L+=4)B&=oe[L+3]}const M=B!=255,W=(function(X,V,ie,le,te,de){const ne=[];for(var Z=0;Z<X.length;Z++){const fe=new Uint8Array(X[Z]),pe=new Uint32Array(fe.buffer);var ue;let he=0,ye=0,xe=V,Ce=ie,Ne=le?1:0;if(Z!=0){const ft=de||le||Z==1||ne[Z-2].dispose!=0?1:2;let He=0,Qe=1e9;for(let Re=0;Re<ft;Re++){var ve=new Uint8Array(X[Z-1-Re]);const ct=new Uint32Array(X[Z-1-Re]);let we=V,Ae=ie,Fe=-1,Ie=-1;for(let Se=0;Se<ie;Se++)for(let Ue=0;Ue<V;Ue++)pe[se=Se*V+Ue]!=ct[se]&&(Ue<we&&(we=Ue),Ue>Fe&&(Fe=Ue),Se<Ae&&(Ae=Se),Se>Ie&&(Ie=Se));Fe==-1&&(we=Ae=Fe=Ie=0),te&&((1&we)==1&&we--,(1&Ae)==1&&Ae--);const Ge=(Fe-we+1)*(Ie-Ae+1);Ge<Qe&&(Qe=Ge,He=Re,he=we,ye=Ae,xe=Fe-we+1,Ce=Ie-Ae+1)}ve=new Uint8Array(X[Z-1-He]),He==1&&(ne[Z-1].dispose=2),ue=new Uint8Array(xe*Ce*4),_(ve,V,ie,ue,xe,Ce,-he,-ye,0),Ne=_(fe,V,ie,ue,xe,Ce,-he,-ye,3)?1:0,Ne==1?n(fe,V,ie,ue,{x:he,y:ye,width:xe,height:Ce}):_(fe,V,ie,ue,xe,Ce,-he,-ye,0)}else ue=fe.slice(0);ne.push({rect:{x:he,y:ye,width:xe,height:Ce},img:ue,blend:Ne,dispose:0})}if(le)for(Z=0;Z<ne.length;Z++){if((je=ne[Z]).blend==1)continue;const fe=je.rect,pe=ne[Z-1].rect,he=Math.min(fe.x,pe.x),ye=Math.min(fe.y,pe.y),xe={x:he,y:ye,width:Math.max(fe.x+fe.width,pe.x+pe.width)-he,height:Math.max(fe.y+fe.height,pe.y+pe.height)-ye};ne[Z-1].dispose=1,Z-1!=0&&i(X,V,ie,ne,Z-1,xe,te),i(X,V,ie,ne,Z,xe,te)}let Pe=0;if(X.length!=1)for(var se=0;se<ne.length;se++){var je;Pe+=(je=ne[se]).rect.width*je.rect.height}return ne})(d,c,v,C,y,E),Y={},G=[],q=[];if(j!=0){const oe=[];for(L=0;L<W.length;L++)oe.push(W[L].img.buffer);const X=(function(te){let de=0;for(var ne=0;ne<te.length;ne++)de+=te[ne].byteLength;const Z=new Uint8Array(de);let ue=0;for(ne=0;ne<te.length;ne++){const ve=new Uint8Array(te[ne]),Pe=ve.length;for(let se=0;se<Pe;se+=4){let je=ve[se],fe=ve[se+1],pe=ve[se+2];const he=ve[se+3];he==0&&(je=fe=pe=0),Z[ue+se]=je,Z[ue+se+1]=fe,Z[ue+se+2]=pe,Z[ue+se+3]=he}ue+=Pe}return Z.buffer})(oe),V=m(X,j);for(L=0;L<V.plte.length;L++)G.push(V.plte[L].est.rgba);let ie=0;for(L=0;L<W.length;L++){const le=(ee=W[L]).img.length;var K=new Uint8Array(V.inds.buffer,ie>>2,le>>2);q.push(K);const te=new Uint8Array(V.abuf,ie,le);z&&o(ee.img,ee.rect.width,ee.rect.height,G,te,K),ee.img.set(te),ie+=le}}else for(N=0;N<W.length;N++){var ee=W[N];const oe=new Uint32Array(ee.img.buffer);var re=ee.rect.width;for(H=oe.length,K=new Uint8Array(H),q.push(K),L=0;L<H;L++){const X=oe[L];if(L!=0&&X==oe[L-1])K[L]=K[L-1];else if(L>re&&X==oe[L-re])K[L]=K[L-re];else{let V=Y[X];if(V==null&&(Y[X]=V=G.length,G.push(X),G.length>=300))break;K[L]=V}}}const _e=G.length;for(_e<=256&&a==0&&(O=_e<=2?1:_e<=4?2:_e<=16?4:8,O=Math.max(O,u)),N=0;N<W.length;N++){(ee=W[N]).rect.x,ee.rect.y,re=ee.rect.width;const oe=ee.rect.height;let X=ee.img;new Uint32Array(X.buffer);let V=4*re,ie=4;if(_e<=256&&a==0){V=Math.ceil(O*re/8);var me=new Uint8Array(V*oe);const le=q[N];for(let te=0;te<oe;te++){L=te*V;const de=te*re;if(O==8)for(var J=0;J<re;J++)me[L+J]=le[de+J];else if(O==4)for(J=0;J<re;J++)me[L+(J>>1)]|=le[de+J]<<4-4*(1&J);else if(O==2)for(J=0;J<re;J++)me[L+(J>>2)]|=le[de+J]<<6-2*(3&J);else if(O==1)for(J=0;J<re;J++)me[L+(J>>3)]|=le[de+J]<<7-1*(7&J)}X=me,U=3,ie=1}else if(M==0&&W.length==1){me=new Uint8Array(re*oe*3);const le=re*oe;for(L=0;L<le;L++){const te=3*L,de=4*L;me[te]=X[de],me[te+1]=X[de+1],me[te+2]=X[de+2]}X=me,U=2,ie=3,V=3*re}ee.img=X,ee.bpl=V,ee.bpp=ie}return{ctype:U,depth:O,plte:G,frames:W}}function i(d,c,v,j,A,C,y){const E=Uint8Array,u=Uint32Array,a=new E(d[A-1]),z=new u(d[A-1]),U=A+1<d.length?new E(d[A+1]):null,O=new E(d[A]),B=new u(O.buffer);let N=c,H=v,L=-1,M=-1;for(let Y=0;Y<C.height;Y++)for(let G=0;G<C.width;G++){const q=C.x+G,K=C.y+Y,ee=K*c+q,re=B[ee];re==0||j[A-1].dispose==0&&z[ee]==re&&(U==null||U[4*ee+3]!=0)||(q<N&&(N=q),q>L&&(L=q),K<H&&(H=K),K>M&&(M=K))}L==-1&&(N=H=L=M=0),y&&((1&N)==1&&N--,(1&H)==1&&H--),C={x:N,y:H,width:L-N+1,height:M-H+1};const W=j[A];W.rect=C,W.blend=1,W.img=new Uint8Array(C.width*C.height*4),j[A-1].dispose==0?(_(a,c,v,W.img,C.width,C.height,-C.x,-C.y,0),n(O,c,v,W.img,C)):_(O,c,v,W.img,C.width,C.height,-C.x,-C.y,0)}function n(d,c,v,j,A){_(d,c,v,j,A.width,A.height,-A.x,-A.y,2)}function s(d,c,v,j,A,C,y){const E=[];let u,a=[0,1,2,3,4];C!=-1?a=[C]:(c*j>5e5||v==1)&&(a=[0]),y&&(u={level:0});const z=pt;for(var U=0;U<a.length;U++){for(let N=0;N<c;N++)h(A,d,N,j,v,a[U]);E.push(z.deflate(A,u))}let O,B=1e9;for(U=0;U<E.length;U++)E[U].length<B&&(O=U,B=E[U].length);return E[O]}function h(d,c,v,j,A,C){const y=v*j;let E=y+v;if(d[E]=C,E++,C==0)if(j<500)for(var u=0;u<j;u++)d[E+u]=c[y+u];else d.set(new Uint8Array(c.buffer,y,j),E);else if(C==1){for(u=0;u<A;u++)d[E+u]=c[y+u];for(u=A;u<j;u++)d[E+u]=c[y+u]-c[y+u-A]+256&255}else if(v==0){for(u=0;u<A;u++)d[E+u]=c[y+u];if(C==2)for(u=A;u<j;u++)d[E+u]=c[y+u];if(C==3)for(u=A;u<j;u++)d[E+u]=c[y+u]-(c[y+u-A]>>1)+256&255;if(C==4)for(u=A;u<j;u++)d[E+u]=c[y+u]-D(c[y+u-A],0,0)+256&255}else{if(C==2)for(u=0;u<j;u++)d[E+u]=c[y+u]+256-c[y+u-j]&255;if(C==3){for(u=0;u<A;u++)d[E+u]=c[y+u]+256-(c[y+u-j]>>1)&255;for(u=A;u<j;u++)d[E+u]=c[y+u]+256-(c[y+u-j]+c[y+u-A]>>1)&255}if(C==4){for(u=0;u<A;u++)d[E+u]=c[y+u]+256-D(0,c[y+u-j],0)&255;for(u=A;u<j;u++)d[E+u]=c[y+u]+256-D(c[y+u-A],c[y+u-j],c[y+u-A-j])&255}}}function m(d,c){const v=new Uint8Array(d),j=v.slice(0),A=new Uint32Array(j.buffer),C=w(j,c),y=C[0],E=C[1],u=v.length,a=new Uint8Array(u>>2);let z;if(v.length<2e7)for(var U=0;U<u;U+=4)z=x(y,O=v[U]*(1/255),B=v[U+1]*(1/255),N=v[U+2]*(1/255),H=v[U+3]*(1/255)),a[U>>2]=z.ind,A[U>>2]=z.est.rgba;else for(U=0;U<u;U+=4){var O=v[U]*.00392156862745098,B=v[U+1]*(1/255),N=v[U+2]*(1/255),H=v[U+3]*(1/255);for(z=y;z.left;)z=I(z.est,O,B,N,H)<=0?z.left:z.right;a[U>>2]=z.ind,A[U>>2]=z.est.rgba}return{abuf:j.buffer,inds:a,plte:E}}function w(d,c,v){v==null&&(v=1e-4);const j=new Uint32Array(d.buffer),A={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=T(d,A.i0,A.i1),A.est=g(A.bst);const C=[A];for(;C.length<c;){let E=0,u=0;for(var y=0;y<C.length;y++)C[y].est.L>E&&(E=C[y].est.L,u=y);if(E<v)break;const a=C[u],z=F(d,j,a.i0,a.i1,a.est.e,a.est.eMq255);if(a.i0>=z||a.i1<=z){a.est.L=0;continue}const U={i0:a.i0,i1:z,bst:null,est:null,tdst:0,left:null,right:null};U.bst=T(d,U.i0,U.i1),U.est=g(U.bst);const O={i0:z,i1:a.i1,bst:null,est:null,tdst:0,left:null,right:null};for(O.bst={R:[],m:[],N:a.bst.N-U.bst.N},y=0;y<16;y++)O.bst.R[y]=a.bst.R[y]-U.bst.R[y];for(y=0;y<4;y++)O.bst.m[y]=a.bst.m[y]-U.bst.m[y];O.est=g(O.bst),a.left=U,a.right=O,C[u]=U,C.push(O)}for(C.sort(((E,u)=>u.bst.N-E.bst.N)),y=0;y<C.length;y++)C[y].ind=y;return[A,C]}function x(d,c,v,j,A){if(d.left==null)return d.tdst=(function(U,O,B,N,H){const L=O-U[0],M=B-U[1],W=N-U[2],Y=H-U[3];return L*L+M*M+W*W+Y*Y})(d.est.q,c,v,j,A),d;const C=I(d.est,c,v,j,A);let y=d.left,E=d.right;C>0&&(y=d.right,E=d.left);const u=x(y,c,v,j,A);if(u.tdst<=C*C)return u;const a=x(E,c,v,j,A);return a.tdst<u.tdst?a:u}function I(d,c,v,j,A){const{e:C}=d;return C[0]*c+C[1]*v+C[2]*j+C[3]*A-d.eMq}function F(d,c,v,j,A,C){for(j-=4;v<j;){for(;S(d,v,A)<=C;)v+=4;for(;S(d,j,A)>C;)j-=4;if(v>=j)break;const y=c[v>>2];c[v>>2]=c[j>>2],c[j>>2]=y,v+=4,j-=4}for(;S(d,v,A)>C;)v-=4;return v+4}function S(d,c,v){return d[c]*v[0]+d[c+1]*v[1]+d[c+2]*v[2]+d[c+3]*v[3]}function T(d,c,v){const j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],C=v-c>>2;for(let y=c;y<v;y+=4){const E=d[y]*.00392156862745098,u=d[y+1]*(1/255),a=d[y+2]*(1/255),z=d[y+3]*(1/255);A[0]+=E,A[1]+=u,A[2]+=a,A[3]+=z,j[0]+=E*E,j[1]+=E*u,j[2]+=E*a,j[3]+=E*z,j[5]+=u*u,j[6]+=u*a,j[7]+=u*z,j[10]+=a*a,j[11]+=a*z,j[15]+=z*z}return j[4]=j[1],j[8]=j[2],j[9]=j[6],j[12]=j[3],j[13]=j[7],j[14]=j[11],{R:j,m:A,N:C}}function g(d){const{R:c}=d,{m:v}=d,{N:j}=d,A=v[0],C=v[1],y=v[2],E=v[3],u=j==0?0:1/j,a=[c[0]-A*A*u,c[1]-A*C*u,c[2]-A*y*u,c[3]-A*E*u,c[4]-C*A*u,c[5]-C*C*u,c[6]-C*y*u,c[7]-C*E*u,c[8]-y*A*u,c[9]-y*C*u,c[10]-y*y*u,c[11]-y*E*u,c[12]-E*A*u,c[13]-E*C*u,c[14]-E*y*u,c[15]-E*E*u],z=a,U=P;let O=[Math.random(),Math.random(),Math.random(),Math.random()],B=0,N=0;if(j!=0)for(let L=0;L<16&&(O=U.multVec(z,O),N=Math.sqrt(U.dot(O,O)),O=U.sml(1/N,O),!(L!=0&&Math.abs(N-B)<1e-9));L++)B=N;const H=[A*u,C*u,y*u,E*u];return{Cov:a,q:H,e:O,L:B,eMq255:U.dot(U.sml(255,H),O),eMq:U.dot(O,H),rgba:(Math.round(255*H[3])<<24|Math.round(255*H[2])<<16|Math.round(255*H[1])<<8|Math.round(255*H[0])<<0)>>>0}}var P={multVec:(d,c)=>[d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],d[4]*c[0]+d[5]*c[1]+d[6]*c[2]+d[7]*c[3],d[8]*c[0]+d[9]*c[1]+d[10]*c[2]+d[11]*c[3],d[12]*c[0]+d[13]*c[1]+d[14]*c[2]+d[15]*c[3]],dot:(d,c)=>d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]*c[3],sml:(d,c)=>[d*c[0],d*c[1],d*c[2],d*c[3]]};ge.encode=function(c,v,j,A,C,y,E){A==null&&(A=0),E==null&&(E=!1);const u=r(c,v,j,A,[!1,!1,!1,0,E,!1]);return b(u,-1),p(u,v,j,C,y)},ge.encodeLL=function(c,v,j,A,C,y,E,u){const a={ctype:0+(A==1?0:2)+(C==0?0:4),depth:y,frames:[]},z=(A+C)*y,U=z*v;for(let O=0;O<c.length;O++)a.frames.push({rect:{x:0,y:0,width:v,height:j},img:new Uint8Array(c[O]),blend:0,dispose:1,bpp:Math.ceil(z/8),bpl:Math.ceil(U/8)});return b(a,0,!0),p(a,v,j,E,u)},ge.encode.compress=r,ge.encode.dither=o,ge.quantize=m,ge.quantize.getKDtree=w,ge.quantize.getNearest=x})();const Je={toArrayBuffer(_,k){const D=_.width,f=_.height,e=D<<2,t=_.getContext("2d").getImageData(0,0,D,f),l=new Uint32Array(t.data.buffer),o=(32*D+31)/32<<2,p=o*f,b=122+p,r=new ArrayBuffer(b),i=new DataView(r),n=1<<20;let s,h,m,w,x=n,I=0,F=0,S=0;function T(d){i.setUint16(F,d,!0),F+=2}function g(d){i.setUint32(F,d,!0),F+=4}function P(d){F+=d}T(19778),g(b),P(4),g(122),g(108),g(D),g(-f>>>0),T(1),T(32),g(3),g(p),g(2835),g(2835),P(8),g(16711680),g(65280),g(255),g(4278190080),g(1466527264),(function d(){for(;I<f&&x>0;){for(w=122+I*o,s=0;s<e;)x--,h=l[S++],m=h>>>24,i.setUint32(w+s,h<<8|m),s+=4;I++}S<l.length?(x=n,setTimeout(d,Je._dly)):k(r)})()},toBlob(_,k){this.toArrayBuffer(_,(D=>{k(new Blob([D],{type:"image/bmp"}))}))},_dly:9};var ce={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gt={[ce.CHROME]:16384,[ce.FIREFOX]:11180,[ce.DESKTOP_SAFARI]:16384,[ce.IE]:8192,[ce.IOS]:4096,[ce.ETC]:8192};const $e=typeof window<"u",et=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,De=$e&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),mt=($e||et)&&(De&&De.getOriginalSymbol(window,"File")||typeof File<"u"&&File),tt=($e||et)&&(De&&De.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function qe(_,k,D=Date.now()){return new Promise((f=>{const e=_.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let o=l.length;const p=new Uint8Array(o);for(;o--;)p[o]=l.charCodeAt(o);const b=new Blob([p],{type:t});b.name=k,b.lastModified=D,f(b)}))}function nt(_){return new Promise(((k,D)=>{const f=new tt;f.onload=()=>k(f.result),f.onerror=e=>D(e),f.readAsDataURL(_)}))}function rt(_){return new Promise(((k,D)=>{const f=new Image;f.onload=()=>k(f),f.onerror=e=>D(e),f.src=_}))}function Ee(){if(Ee.cachedResult!==void 0)return Ee.cachedResult;let _=ce.ETC;const{userAgent:k}=navigator;return/Chrom(e|ium)/i.test(k)?_=ce.CHROME:/iP(ad|od|hone)/i.test(k)&&/WebKit/i.test(k)?_=ce.IOS:/Safari/i.test(k)?_=ce.DESKTOP_SAFARI:/Firefox/i.test(k)?_=ce.FIREFOX:(/MSIE/i.test(k)||document.documentMode)&&(_=ce.IE),Ee.cachedResult=_,Ee.cachedResult}function it(_,k){const D=Ee(),f=gt[D];let e=_,t=k,l=e*t;const o=e>t?t/e:e/t;for(;l>f*f;){const p=(f+e)/2,b=(f+t)/2;p<b?(t=b,e=b*o):(t=p*o,e=p),l=e*t}return{width:e,height:t}}function Le(_,k){let D,f;try{if(D=new OffscreenCanvas(_,k),f=D.getContext("2d"),f===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{D=document.createElement("canvas"),f=D.getContext("2d")}return D.width=_,D.height=k,[D,f]}function ot(_,k){const{width:D,height:f}=it(_.width,_.height),[e,t]=Le(D,f);return k&&/jpe?g/.test(k)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(_,0,0,e.width,e.height),e}function Me(){return Me.cachedResult!==void 0||(Me.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Me.cachedResult}function ze(_,k={}){return new Promise((function(D,f){let e,t;var l=function(){try{return t=ot(e,k.fileType||_.type),D([e,t])}catch(p){return f(p)}},o=function(p){try{var b=function(r){try{throw r}catch(i){return f(i)}};try{let r;return nt(_).then((function(i){try{return r=i,rt(r).then((function(n){try{return e=n,(function(){try{return l()}catch(s){return f(s)}})()}catch(s){return b(s)}}),b)}catch(n){return b(n)}}),b)}catch(r){b(r)}}catch(r){return f(r)}};try{if(Me()||[ce.DESKTOP_SAFARI,ce.MOBILE_SAFARI].includes(Ee()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(_).then((function(p){try{return e=p,l()}catch{return o()}}),o)}catch{o()}}))}function Oe(_,k,D,f,e=1){return new Promise((function(t,l){let o;if(k==="image/png"){let b,r,i;return b=_.getContext("2d"),{data:r}=b.getImageData(0,0,_.width,_.height),i=ge.encode([r.buffer],_.width,_.height,4096*e),o=new Blob([i],{type:k}),o.name=D,o.lastModified=f,p.call(this)}{let b=function(){return p.call(this)};if(k==="image/bmp")return new Promise((r=>Je.toBlob(_,r))).then(function(r){try{return o=r,o.name=D,o.lastModified=f,b.call(this)}catch(i){return l(i)}}.bind(this),l);{let r=function(){return b.call(this)};if(typeof OffscreenCanvas=="function"&&_ instanceof OffscreenCanvas)return _.convertToBlob({type:k,quality:e}).then(function(i){try{return o=i,o.name=D,o.lastModified=f,r.call(this)}catch(n){return l(n)}}.bind(this),l);{let i;return i=_.toDataURL(k,e),qe(i,D,f).then(function(n){try{return o=n,r.call(this)}catch(s){return l(s)}}.bind(this),l)}}}function p(){return t(o)}}))}function be(_){_.width=0,_.height=0}function ke(){return new Promise((function(_,k){let D,f,e,t;return ke.cachedResult!==void 0?_(ke.cachedResult):qe("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(l){try{return D=l,ze(D).then((function(o){try{return f=o[1],Oe(f,D.type,D.name,D.lastModified).then((function(p){try{return e=p,be(f),ze(e).then((function(b){try{return t=b[0],ke.cachedResult=t.width===1&&t.height===2,_(ke.cachedResult)}catch(r){return k(r)}}),k)}catch(b){return k(b)}}),k)}catch(p){return k(p)}}),k)}catch(o){return k(o)}}),k)}))}function st(_){return new Promise(((k,D)=>{const f=new tt;f.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return k(-2);const l=t.byteLength;let o=2;for(;o<l;){if(t.getUint16(o+2,!1)<=8)return k(-1);const p=t.getUint16(o,!1);if(o+=2,p==65505){if(t.getUint32(o+=2,!1)!=1165519206)return k(-1);const b=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,b);const r=t.getUint16(o,b);o+=2;for(let i=0;i<r;i++)if(t.getUint16(o+12*i,b)==274)return k(t.getUint16(o+12*i+8,b))}else{if((65280&p)!=65280)break;o+=t.getUint16(o,!1)}}return k(-1)},f.onerror=e=>D(e),f.readAsArrayBuffer(_)}))}function at(_,k){const{width:D}=_,{height:f}=_,{maxWidthOrHeight:e}=k;let t,l=_;return isFinite(e)&&(D>e||f>e)&&([l,t]=Le(D,f),D>f?(l.width=e,l.height=f/D*e):(l.width=D/f*e,l.height=e),t.drawImage(_,0,0,l.width,l.height),be(_)),l}function lt(_,k){const{width:D}=_,{height:f}=_,[e,t]=Le(D,f);switch(k>4&&k<9?(e.width=f,e.height=D):(e.width=D,e.height=f),k){case 2:t.transform(-1,0,0,1,D,0);break;case 3:t.transform(-1,0,0,-1,D,f);break;case 4:t.transform(1,0,0,-1,0,f);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,f,0);break;case 7:t.transform(0,-1,-1,0,f,D);break;case 8:t.transform(0,-1,1,0,0,D)}return t.drawImage(_,0,0,D,f),be(_),e}function Ze(_,k,D=0){return new Promise((function(f,e){let t,l,o,p,b,r,i,n,s,h,m,w,x,I,F,S,T,g,P,d;function c(j=5){if(k.signal&&k.signal.aborted)throw k.signal.reason;t+=j,k.onProgress(Math.min(t,100))}function v(j){if(k.signal&&k.signal.aborted)throw k.signal.reason;t=Math.min(Math.max(j,t),100),k.onProgress(t)}return t=D,l=k.maxIteration||10,o=1024*k.maxSizeMB*1024,c(),ze(_,k).then(function(j){try{return[,p]=j,c(),b=at(p,k),c(),new Promise((function(A,C){var y;if(!(y=k.exifOrientation))return st(_).then(function(u){try{return y=u,E.call(this)}catch(a){return C(a)}}.bind(this),C);function E(){return A(y)}return E.call(this)})).then(function(A){try{return r=A,c(),ke().then(function(C){try{return i=C?b:lt(b,r),c(),n=k.initialQuality||1,s=k.fileType||_.type,Oe(i,s,_.name,_.lastModified,n).then(function(y){try{{let u=function(){if(l--&&(F>o||F>x)){let z,U;return z=d?.95*P.width:P.width,U=d?.95*P.height:P.height,[T,g]=Le(z,U),g.drawImage(P,0,0,z,U),n*=s==="image/png"?.85:.95,Oe(T,s,_.name,_.lastModified,n).then((function(O){try{return S=O,be(P),P=T,F=S.size,v(Math.min(99,Math.floor((I-F)/(I-o)*100))),u}catch(B){return e(B)}}),e)}return[1]},a=function(){return be(P),be(T),be(b),be(i),be(p),v(100),f(S)};if(h=y,c(),m=h.size>o,w=h.size>_.size,!m&&!w)return v(100),f(h);var E;return x=_.size,I=h.size,F=I,P=i,d=!k.alwaysKeepResolution&&m,(E=function(z){for(;z;){if(z.then)return void z.then(E,e);try{if(z.pop){if(z.length)return z.pop()?a.call(this):z;z=u}else z=z.call(this)}catch(U){return e(U)}}}.bind(this))(u)}}catch(u){return e(u)}}.bind(this),e)}catch(y){return e(y)}}.bind(this),e)}catch(C){return e(C)}}.bind(this),e)}catch(A){return e(A)}}.bind(this),e)}))}const xt=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Be;function bt(_,k){return new Promise(((D,f)=>{Be||(Be=(function(l){const o=[];return o.push(l),URL.createObjectURL(new Blob(o))})(xt));const e=new Worker(Be);e.addEventListener("message",(function(l){if(k.signal&&k.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return f(new Error(l.data.error)),void e.terminate();D(l.data.file),e.terminate()}else k.onProgress(l.data.progress)})),e.addEventListener("error",f),k.signal&&k.signal.addEventListener("abort",(()=>{f(k.signal.reason),e.terminate()})),e.postMessage({file:_,imageCompressionLibUrl:k.libURL,options:{...k,onProgress:void 0,signal:void 0}})}))}function ae(_,k){return new Promise((function(D,f){let e,t,l,o,p,b;if(e={...k},l=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,p=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=s=>{l=s,typeof o=="function"&&o(l)},!(_ instanceof Blob||_ instanceof mt))return f(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(_.type))return f(new Error("The file given is not an image"));if(b=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!p||typeof Worker!="function"||b)return Ze(_,e).then(function(s){try{return t=s,n.call(this)}catch(h){return f(h)}}.bind(this),f);var r=function(){try{return n.call(this)}catch(s){return f(s)}}.bind(this),i=function(s){try{return Ze(_,e).then((function(h){try{return t=h,r()}catch(m){return f(m)}}),f)}catch(h){return f(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",bt(_,e).then((function(s){try{return t=s,r()}catch{return i()}}),i)}catch{i()}function n(){try{t.name=_.name,t.lastModified=_.lastModified}catch{}try{e.preserveExif&&_.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===_.type)&&(t=Xe(_,t))}catch{}return D(t)}}))}ae.getDataUrlFromFile=nt,ae.getFilefromDataUrl=qe,ae.loadImage=rt,ae.drawImageInCanvas=ot,ae.drawFileInCanvas=ze,ae.canvasToFile=Oe,ae.getExifOrientation=st,ae.handleMaxWidthOrHeight=at,ae.followExifOrientation=lt,ae.cleanupCanvasMemory=be,ae.isAutoOrientationInBrowser=ke,ae.approximateBelowMaximumCanvasSizeOfBrowser=it,ae.copyExifWithoutOrientation=Xe,ae.getBrowserName=Ee,ae.version="2.0.2";function yt({userId:_,userAvatar:k}){const[D,f]=$.useState(""),[e,t]=$.useState(!1),[l,o]=$.useState(!1),[p,b]=$.useState(""),[r,i]=$.useState([]),[n,s]=$.useState([]),h=async I=>{const F=Array.from(I.target.files||[]);if(F.length===0)return;if(F.length+r.length>4){b("Maximum 4 images per post");return}i([...r,...F]);const S=F.map(T=>URL.createObjectURL(T));s([...n,...S])},m=I=>{const F=r.filter((T,g)=>g!==I),S=n.filter((T,g)=>g!==I);URL.revokeObjectURL(n[I]),i(F),s(S)},w=async I=>{try{const S=await ae(I,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),T=I.name.split(".").pop(),g=`${_}/${Date.now()}-${Math.random().toString(36).substring(7)}.${T}`,{data:P,error:d}=await Q.storage.from("media").upload(g,S);if(d)throw d;const{data:{publicUrl:c}}=Q.storage.from("media").getPublicUrl(P.path);return c}catch(F){throw console.error("Upload error:",F),new Error("Failed to upload image")}},x=async I=>{if(I.preventDefault(),!D.trim()&&r.length===0){b("Please write something or add an image");return}o(!0),b("");try{let F=[];r.length>0&&(t(!0),F=await Promise.all(r.map(w)),t(!1));const{error:S}=await Q.from("posts").insert({user_id:_,content:D.trim(),media_urls:F.length>0?F:null});if(S)throw S;f(""),i([]),n.forEach(T=>URL.revokeObjectURL(T)),s([]),window.location.reload()}catch(F){b(F.message||"Failed to create post"),t(!1),o(!1)}};return R.jsxs("form",{onSubmit:x,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[R.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"start"},children:[k?R.jsx("img",{src:k,alt:"You",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):R.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:"?"}),R.jsx("textarea",{value:D,onChange:I=>f(I.target.value),placeholder:"What's on your mind?",rows:3,style:{flex:1,resize:"vertical",minHeight:"80px",fontSize:"16px"},disabled:l})]}),p&&R.jsx("div",{style:{background:"#fee",color:"#c33",padding:"10px",borderRadius:"6px",fontSize:"14px"},children:p}),n.length>0&&R.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:n.map((I,F)=>R.jsxs("div",{style:{position:"relative"},children:[R.jsx("img",{src:I,alt:`Preview ${F+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px"}}),R.jsx("button",{type:"button",onClick:()=>m(F),style:{position:"absolute",top:"5px",right:"5px",background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"16px",lineHeight:"1"},children:""})]},F))}),R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[R.jsxs("label",{style:{cursor:"pointer"},children:[R.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h,style:{display:"none"},disabled:l||r.length>=4}),R.jsxs("span",{style:{color:"#4A90E2",fontWeight:"500",fontSize:"14px"},children:[" Add Photos ",r.length>0&&`(${r.length}/4)`]})]}),R.jsx("button",{type:"submit",className:"btn",disabled:l||e,style:{opacity:l||e?.5:1},children:e?"Uploading...":l?"Posting...":"Post"})]})]})}const We={like:"",love:"",laugh:"",celebrate:""};function vt({postId:_,currentUserId:k}){const[D,f]=$.useState([]),[e,t]=$.useState(null),[l,o]=$.useState(!1),[p,b]=$.useState(!1);$.useEffect(()=>{r(),i()},[_]);async function r(){const{data:w}=await Q.from("post_reactions").select(`
        *,
        profile:profiles(display_name)
      `).eq("post_id",_);if(w){f(w);const x=w.find(I=>I.user_id===k);t(x?.reaction_type||null)}}function i(){const w=Q.channel(`reactions-${_}`).on("postgres_changes",{event:"*",schema:"public",table:"post_reactions",filter:`post_id=eq.${_}`},()=>{r()}).subscribe();return()=>{Q.removeChannel(w)}}async function n(w){if(!p){b(!0);try{e===w?(await Q.from("post_reactions").delete().eq("post_id",_).eq("user_id",k),t(null)):e?(await Q.from("post_reactions").update({reaction_type:w}).eq("post_id",_).eq("user_id",k),t(w)):(await Q.from("post_reactions").insert({post_id:_,user_id:k,reaction_type:w}),t(w)),o(!1)}catch(x){console.error("Reaction error:",x)}finally{b(!1)}}}const s={};D.forEach(w=>{s[w.reaction_type]=(s[w.reaction_type]||0)+1});const h=D.length,m=D.slice(0,3).map(w=>w.profile?.display_name).filter(Boolean);return R.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[h>0&&R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",fontSize:"14px",color:"#666"},children:[R.jsx("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:Object.entries(s).map(([w,x])=>R.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[We[w]," ",x]},w))}),m.length>0&&R.jsxs("div",{style:{fontSize:"13px"},children:[m.join(", "),D.length>3&&` +${D.length-3} more`]})]}),R.jsxs("div",{style:{display:"flex",gap:"10px",position:"relative"},children:[R.jsxs("button",{onClick:()=>e?n(e):o(!l),style:{background:e?"#e3f2fd":"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:e?"#4A90E2":"#666",fontWeight:e?600:400},children:[e?We[e]:"",e?"Liked":"Like"]}),!e&&R.jsx("button",{onClick:()=>o(!l),style:{background:"transparent",border:"1px solid #ddd",borderRadius:"20px",padding:"6px 10px",fontSize:"16px",cursor:"pointer"},title:"React",children:"+"}),l&&R.jsx("div",{style:{position:"absolute",bottom:"100%",left:0,marginBottom:"8px",background:"white",border:"1px solid #ddd",borderRadius:"24px",padding:"8px 12px",display:"flex",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10},children:Object.entries(We).map(([w,x])=>R.jsx("button",{onClick:()=>n(w),style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",padding:"4px",borderRadius:"50%",transition:"transform 0.2s"},onMouseEnter:I=>I.currentTarget.style.transform="scale(1.3)",onMouseLeave:I=>I.currentTarget.style.transform="scale(1)",title:w,children:x},w))})]})]})}function wt({postId:_,currentUserId:k}){const[D,f]=$.useState([]),[e,t]=$.useState(""),[l,o]=$.useState(!1),[p,b]=$.useState(!1);$.useEffect(()=>{r(),i()},[_]);async function r(){const{data:m}=await Q.from("comments").select(`
        *,
        profile:profiles(display_name, avatar_url)
      `).eq("post_id",_).order("created_at",{ascending:!0});m&&f(m)}function i(){const m=Q.channel(`comments-${_}`).on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:`post_id=eq.${_}`},()=>{r()}).subscribe();return()=>{Q.removeChannel(m)}}async function n(m){if(m.preventDefault(),!(!e.trim()||l)){o(!0);try{await Q.from("comments").insert({post_id:_,user_id:k,content:e.trim()}),t(""),b(!0)}catch(w){console.error("Comment error:",w)}finally{o(!1)}}}async function s(m){if(confirm("Delete this comment?"))try{await Q.from("comments").delete().eq("id",m)}catch(w){console.error("Delete error:",w)}}const h=m=>{const w=new Date(m),I=new Date().getTime()-w.getTime(),F=Math.floor(I/(1e3*60*60)),S=Math.floor(F/24);if(S>0)return`${S}d ago`;if(F>0)return`${F}h ago`;const T=Math.floor(I/(1e3*60));return T>0?`${T}m ago`:"Just now"};return R.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:"12px",marginTop:"12px"},children:[R.jsxs("button",{onClick:()=>b(!p),style:{background:"transparent",border:"none",color:"#666",fontSize:"14px",cursor:"pointer",padding:"4px 0",fontWeight:500,display:"flex",alignItems:"center",gap:"6px"},children:[" ",D.length," ",D.length===1?"Comment":"Comments",R.jsx("span",{style:{fontSize:"12px"},children:p?"":""})]}),p&&R.jsxs("div",{style:{marginTop:"12px"},children:[D.map(m=>R.jsx("div",{style:{padding:"10px",background:"#f8f9fa",borderRadius:"8px",marginBottom:"8px"},children:R.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"start"},children:[m.profile?.avatar_url?R.jsx("img",{src:m.profile.avatar_url,alt:m.profile.display_name,style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):R.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",flexShrink:0},children:m.profile?.display_name?.[0]?.toUpperCase()||"?"}),R.jsxs("div",{style:{flex:1,minWidth:0},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",gap:"8px"},children:[R.jsxs("div",{children:[R.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:m.profile?.display_name||"Unknown"}),R.jsx("div",{style:{fontSize:"13px",color:"#999"},children:h(m.created_at)})]}),m.user_id===k&&R.jsx("button",{onClick:()=>s(m.id),style:{background:"transparent",border:"none",color:"#999",fontSize:"12px",cursor:"pointer",padding:"2px 6px"},children:"Delete"})]}),R.jsx("div",{style:{fontSize:"14px",marginTop:"6px",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:m.content})]})]})},m.id)),R.jsxs("form",{onSubmit:n,style:{marginTop:"12px"},children:[R.jsx("textarea",{value:e,onChange:m=>t(m.target.value),placeholder:"Write a comment...",rows:2,style:{width:"100%",resize:"vertical",marginBottom:"8px",fontSize:"14px"},disabled:l}),R.jsx("button",{type:"submit",className:"btn",style:{fontSize:"13px",padding:"6px 12px"},disabled:l||!e.trim(),children:l?"Posting...":"Post Comment"})]})]})]})}function At({profileId:_}){const[k,D]=$.useState(null),[f,e]=$.useState(null),[t,l]=$.useState([]),[o,p]=$.useState(!0),[b,r]=$.useState(!1),[i,n]=$.useState(null);$.useEffect(()=>{s()},[_]);async function s(){try{const m=await Ye();D(m);const{data:w}=await Q.from("profiles").select("*").eq("id",_).single();e(w);const{data:x}=await Q.from("posts").select(`
          *,
          profile:profiles(*)
        `).eq("user_id",_).order("created_at",{ascending:!1});l(x||[]),p(!1)}catch(m){console.error("Error loading profile:",m),p(!1)}}if(o)return R.jsx("div",{style:{textAlign:"center",padding:"40px"},children:"Loading..."});if(!f)return R.jsx("div",{className:"error",children:"Profile not found"});const h=k?.id===_;return R.jsxs("div",{children:[R.jsx("div",{className:"card",style:{marginBottom:"30px"},children:R.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"start",flexWrap:"wrap"},children:[f.avatar_url?R.jsx("img",{src:f.avatar_url,alt:f.display_name,style:{width:"100px",height:"100px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):R.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"40px",fontWeight:"bold",flexShrink:0},children:f.display_name[0].toUpperCase()}),R.jsxs("div",{style:{flex:1,minWidth:0},children:[R.jsx("h1",{style:{marginBottom:"10px"},children:f.display_name}),f.bio&&R.jsx("p",{style:{color:"#666",lineHeight:1.6,marginBottom:"10px"},children:f.bio}),R.jsxs("p",{style:{color:"#999",fontSize:"14px"},children:["Member since ",new Date(f.created_at).toLocaleDateString()]}),h&&!b&&R.jsx("button",{onClick:()=>r(!0),className:"btn",style:{marginTop:"15px"},children:" Edit Profile"})]})]})}),b&&h&&R.jsx(_t,{profile:f,onSave:()=>{r(!1),s()},onCancel:()=>r(!1)}),R.jsxs("h2",{style:{marginBottom:"20px"},children:[h?"Your Posts":`${f.display_name}'s Posts`," (",t.length,")"]}),t.length===0?R.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:R.jsx("p",{style:{color:"#999"},children:"No posts yet"})}):t.map(m=>R.jsx(jt,{post:m,currentUserId:k?.id||"",onImageClick:w=>n(w)},m.id)),i&&R.jsxs("div",{onClick:()=>n(null),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,cursor:"pointer",padding:"20px"},children:[R.jsx("img",{src:i,alt:"Full size",onClick:m=>m.stopPropagation(),style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"}}),R.jsx("button",{onClick:()=>n(null),style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"40px",height:"40px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333"},children:""})]})]})}function _t({profile:_,onSave:k,onCancel:D}){const[f,e]=$.useState(_.display_name),[t,l]=$.useState(_.bio||""),[o,p]=$.useState(!1),[b,r]=$.useState(!1),[i,n]=$.useState("");async function s(m){const w=m.target.files?.[0];if(w){if(w.size>5*1024*1024){n("Avatar must be less than 5MB");return}p(!0),n("");try{const x=w.name.split(".").pop(),I=`${_.id}/avatar-${Date.now()}.${x}`,{error:F}=await Q.storage.from("media").upload(I,w,{upsert:!0});if(F)throw F;const{data:{publicUrl:S}}=Q.storage.from("media").getPublicUrl(I),{error:T}=await Q.from("profiles").update({avatar_url:S}).eq("id",_.id);if(T)throw T;p(!1),k()}catch(x){n(x.message),p(!1)}}}async function h(){r(!0),n("");try{const{error:m}=await Q.from("profiles").update({display_name:f,bio:t||null}).eq("id",_.id);if(m)throw m;r(!1),k()}catch(m){n(m.message),r(!1)}}return R.jsxs("div",{className:"card",style:{marginBottom:"30px"},children:[R.jsx("h2",{style:{marginBottom:"20px"},children:"Edit Profile"}),i&&R.jsx("div",{className:"error",children:i}),R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[R.jsxs("div",{children:[R.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Profile Picture"}),R.jsx("input",{type:"file",accept:"image/*",onChange:s,disabled:o}),o&&R.jsx("p",{style:{fontSize:"14px",color:"#4A90E2",marginTop:"5px"},children:"Uploading..."})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"display_name",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Display Name"}),R.jsx("input",{type:"text",id:"display_name",value:f,onChange:m=>e(m.target.value),disabled:b})]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"bio",style:{display:"block",marginBottom:"5px",fontWeight:500},children:"Bio"}),R.jsx("textarea",{id:"bio",value:t,onChange:m=>l(m.target.value),rows:3,placeholder:"Tell your family about yourself...",disabled:b})]}),R.jsxs("div",{style:{display:"flex",gap:"10px"},children:[R.jsx("button",{onClick:h,className:"btn",disabled:b||!f,children:b?"Saving...":"Save Changes"}),R.jsx("button",{onClick:D,className:"btn btn-secondary",disabled:b,children:"Cancel"})]})]})]})}function jt({post:_,currentUserId:k,onImageClick:D}){const f=e=>{const t=new Date(e),o=new Date().getTime()-t.getTime(),p=Math.floor(o/(1e3*60*60)),b=Math.floor(p/24);return b>0?`${b}d ago`:p>0?`${p}h ago`:"Just now"};return R.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[R.jsx("div",{style:{marginBottom:"15px"},children:R.jsx("div",{style:{fontSize:"13px",color:"#999"},children:f(_.created_at)})}),R.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:_.content}),_.media_urls&&_.media_urls.length>0&&R.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:_.media_urls.map((e,t)=>R.jsx("img",{src:e,alt:"Post media",onClick:()=>D?.(e),style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px",cursor:"pointer"}},t))})]})}function Et(){const[_,k]=$.useState(null),[D,f]=$.useState(null),[e,t]=$.useState([]),[l,o]=$.useState(!0),[p,b]=$.useState(""),[r,i]=$.useState(0),[n,s]=$.useState([]),[h,m]=$.useState(null),[w,x]=$.useState(null);$.useEffect(()=>{I()},[]),$.useEffect(()=>{const g=Q.channel("posts-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},async P=>{const{data:d}=await Q.from("posts").select(`
              *,
              profile:profiles(*)
            `).eq("id",P.new.id).single();d&&(s(c=>[d,...c]),i(c=>c+1))}).subscribe();return()=>{Q.removeChannel(g)}},[]);async function I(){try{const g=await Ye();if(k(g),!g){window.location.href="/login.html";return}if(!Ke){const{data:P}=await Q.from("profiles").select("*").eq("id",g.id).single();f(P);const{data:d,error:c}=await Q.from("posts").select(`
            *,
            profile:profiles(*)
          `).order("created_at",{ascending:!1}).limit(50);if(c)throw c;t(d||[])}o(!1)}catch(g){b(g.message),o(!1)}}const F=async()=>{await Q.auth.signOut(),window.location.href="/login.html"},S=()=>{t([...n,...e]),s([]),i(0)},T=async()=>{o(!0),await I(),s([]),i(0)};return l?R.jsx("div",{style:{textAlign:"center",padding:"40px"},children:R.jsx("p",{children:"Loading..."})}):p?R.jsxs("div",{className:"error",children:[R.jsx("strong",{children:"Error:"})," ",p]}):h?R.jsxs(R.Fragment,{children:[R.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[R.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:" Back to Feed"}),R.jsx("a",{href:"/admin.html",children:"Admin"}),R.jsx("button",{onClick:F,className:"btn btn-secondary",children:"Sign Out"})]}),R.jsx(At,{profileId:h})]}):R.jsxs(R.Fragment,{children:[R.jsxs("nav",{slot:"nav",style:{display:"flex",gap:"20px",alignItems:"center"},children:[R.jsx("button",{onClick:()=>m(_?.id||""),className:"btn btn-secondary",children:"My Profile"}),R.jsx("a",{href:"/admin.html",children:"Admin"}),R.jsx("button",{onClick:F,className:"btn btn-secondary",children:"Sign Out"})]}),R.jsxs("div",{style:{marginBottom:"30px"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[R.jsx("h1",{style:{margin:0},children:"Family Feed"}),R.jsx("button",{onClick:T,className:"btn btn-secondary",style:{fontSize:"14px",padding:"6px 12px"},children:" Refresh"})]}),r>0&&R.jsxs("div",{onClick:S,style:{background:"#4A90E2",color:"white",padding:"12px",borderRadius:"8px",marginBottom:"15px",textAlign:"center",cursor:"pointer",fontWeight:500},children:[" ",r," new ",r===1?"post":"posts"," - Tap to view"]}),Ke,R.jsx("div",{className:"card",children:R.jsx(yt,{userId:_?.id||Ve,userAvatar:D?.avatar_url})})]}),R.jsxs("div",{children:[e.length===0&&R.jsx("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:R.jsx("p",{style:{color:"#999"},children:"No posts yet. Be the first to share something!"})}),e.map(g=>R.jsx(Ct,{post:g,currentUserId:_?.id||Ve,onProfileClick:P=>m(P),onImageClick:P=>x(P)},g.id))]}),w&&R.jsxs("div",{onClick:()=>x(null),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,cursor:"pointer",padding:"20px"},children:[R.jsx("img",{src:w,alt:"Full size",onClick:g=>g.stopPropagation(),style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"}}),R.jsx("button",{onClick:()=>x(null),style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:"40px",height:"40px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333"},children:""})]})]})}function Ct({post:_,currentUserId:k,onProfileClick:D,onImageClick:f}){const e=o=>{const p=new Date(o),r=new Date().getTime()-p.getTime(),i=Math.floor(r/(1e3*60*60)),n=Math.floor(i/24);return n>0?`${n}d ago`:i>0?`${i}h ago`:"Just now"},t=async()=>{if(confirm("Delete this post?"))try{if(_.media_urls&&_.media_urls.length>0)for(const o of _.media_urls){const p=o.split("/media/")[1];p&&await Q.storage.from("media").remove([p])}await Q.from("posts").delete().eq("id",_.id),window.location.reload()}catch{alert("Failed to delete post")}},l=_.user_id===k;return R.jsxs("div",{className:"card",style:{marginBottom:"15px"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"15px",gap:"10px"},children:[R.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flex:1,minWidth:0,cursor:"pointer"},onClick:()=>D?.(_.user_id),children:[_.profile?.avatar_url?R.jsx("img",{src:_.profile.avatar_url,alt:_.profile.display_name,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover",flexShrink:0}}):R.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#4A90E2",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0},children:_.profile?.display_name?.[0]?.toUpperCase()||"?"}),R.jsxs("div",{style:{minWidth:0,flex:1},children:[R.jsx("div",{style:{fontWeight:600,color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:_.profile?.display_name||"Unknown"}),R.jsx("div",{style:{fontSize:"13px",color:"#999"},children:e(_.created_at)})]})]}),l&&R.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"28px",color:"#999",cursor:"pointer",lineHeight:1,padding:0,width:"28px",height:"28px",flexShrink:0},title:"Delete post",children:""})]}),R.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},children:_.content}),_.media_urls&&_.media_urls.length>0&&R.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px"},children:_.media_urls.map((o,p)=>R.jsx("img",{src:o,alt:"Post media",onClick:()=>f?.(o),style:{width:"100%",borderRadius:"8px",objectFit:"cover",maxHeight:"300px",minHeight:"150px",cursor:"pointer"}},p))}),R.jsx(vt,{postId:_.id,currentUserId:k}),R.jsx(wt,{postId:_.id,currentUserId:k})]})}export{Et as default};
